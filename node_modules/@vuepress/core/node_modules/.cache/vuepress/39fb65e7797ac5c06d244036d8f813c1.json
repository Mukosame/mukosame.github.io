{"remainingRequest":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/babel-loader/lib/index.js??ref--3-1!/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/@vssue/api-bitbucket-v2/lib/index.js","dependencies":[{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/@vssue/api-bitbucket-v2/lib/index.js","mtime":1604064595813},{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/cache-loader/dist/cjs.js","mtime":1603041438982},{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/babel-loader/lib/index.js","mtime":1603041438713}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS5ub3ciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL29wdC9teWJsb2cvdnVlcHJlc3MtdGhlbWUtcmVjby1tYXN0ZXIvemRibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvb3B0L215YmxvZy92dWVwcmVzcy10aGVtZS1yZWNvLW1hc3Rlci96ZGJsb2cvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvb3B0L215YmxvZy92dWVwcmVzcy10aGVtZS1yZWNvLW1hc3Rlci96ZGJsb2cvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHsgYnVpbGRRdWVyeSwgYnVpbGRVUkwsIGNvbmNhdFVSTCwgZ2V0Q2xlYW5VUkwsIHBhcnNlUXVlcnkgfSBmcm9tICdAdnNzdWUvdXRpbHMnOwppbXBvcnQgeyBub3JtYWxpemVVc2VyLCBub3JtYWxpemVJc3N1ZSwgbm9ybWFsaXplQ29tbWVudCB9IGZyb20gJy4vdXRpbHMnOwovKioKICogQml0YnVja2V0IEFQSSBWMgogKgogKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmF0bGFzc2lhbi5jb20vYml0YnVja2V0L2FwaS8yL3JlZmVyZW5jZS8KICogQHNlZSBodHRwczovL2NvbmZsdWVuY2UuYXRsYXNzaWFuLmNvbS9iaXRidWNrZXQvb2F1dGgtb24tYml0YnVja2V0LWNsb3VkLTIzODAyNzQzMS5odG1sCiAqLwoKdmFyIEJpdGJ1Y2tldFYyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBCaXRidWNrZXRWMihfcmVmKSB7CiAgICB2YXIgX3JlZiRiYXNlVVJMID0gX3JlZi5iYXNlVVJMLAogICAgICAgIGJhc2VVUkwgPSBfcmVmJGJhc2VVUkwgPT09IHZvaWQgMCA/ICdodHRwczovL2JpdGJ1Y2tldC5vcmcnIDogX3JlZiRiYXNlVVJMLAogICAgICAgIG93bmVyID0gX3JlZi5vd25lciwKICAgICAgICByZXBvID0gX3JlZi5yZXBvLAogICAgICAgIGNsaWVudElkID0gX3JlZi5jbGllbnRJZCwKICAgICAgICBzdGF0ZSA9IF9yZWYuc3RhdGU7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJpdGJ1Y2tldFYyKTsKCiAgICB0aGlzLmJhc2VVUkwgPSBiYXNlVVJMOwogICAgdGhpcy5vd25lciA9IG93bmVyOwogICAgdGhpcy5yZXBvID0gcmVwbzsKICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDsKICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTsKICAgIHRoaXMuJGh0dHAgPSBheGlvcy5jcmVhdGUoewogICAgICBiYXNlVVJMOiAnaHR0cHM6Ly9hcGkuYml0YnVja2V0Lm9yZy8yLjAnLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicKICAgICAgfQogICAgfSk7CiAgfQogIC8qKgogICAqIFRoZSBwbGF0Zm9ybSBhcGkgaW5mbwogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKEJpdGJ1Y2tldFYyLCBbewogICAga2V5OiAicmVkaXJlY3RBdXRoIiwKCiAgICAvKioKICAgICAqIFJlZGlyZWN0IHRvIHRoZSBhdXRob3JpemF0aW9uIHBhZ2Ugb2YgcGxhdGZvcm0uCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5hdGxhc3NpYW4uY29tL2JpdGJ1Y2tldC9hcGkvMi9yZWZlcmVuY2UvbWV0YS9hdXRoZW50aWNhdGlvbiNvYXV0aC0yCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiByZWRpcmVjdEF1dGgoKSB7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYnVpbGRVUkwoY29uY2F0VVJMKHRoaXMuYmFzZVVSTCwgJ3NpdGUvb2F1dGgyL2F1dGhvcml6ZScpLCB7CiAgICAgICAgY2xpZW50X2lkOiB0aGlzLmNsaWVudElkLAogICAgICAgIHJlZGlyZWN0X3VyaTogd2luZG93LmxvY2F0aW9uLmhyZWYsCiAgICAgICAgcmVzcG9uc2VfdHlwZTogJ3Rva2VuJywKICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogSGFuZGxlIGF1dGhvcml6YXRpb24uCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5hdGxhc3NpYW4uY29tL2JpdGJ1Y2tldC9hcGkvMi9yZWZlcmVuY2UvbWV0YS9hdXRoZW50aWNhdGlvbiNvYXV0aC0yCiAgICAgKgogICAgICogQHJlbWFya3MKICAgICAqIElmIHRoZSBgYWNjZXNzX3Rva2VuYCBhbmQgYHN0YXRlYCBleGlzdCBpbiB0aGUgcXVlcnksIGFuZCB0aGUgYHN0YXRlYCBtYXRjaGVzLCByZW1vdmUgdGhlbSBmcm9tIHF1ZXJ5LCBhbmQgcmV0dXJuIHRoZSBhY2Nlc3MgdG9rZW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFuZGxlQXV0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2hhbmRsZUF1dGggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGhhc2gsIGFjY2Vzc1Rva2VuLCBoYXNoU3RyaW5nLCBuZXdIYXNoLCByZXBsYWNlVVJMOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGhhc2ggPSBwYXJzZVF1ZXJ5KHdpbmRvdy5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpKTsKCiAgICAgICAgICAgICAgICBpZiAoISghaGFzaC5hY2Nlc3NfdG9rZW4gfHwgaGFzaC5zdGF0ZSAhPT0gdGhpcy5zdGF0ZSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IGhhc2guYWNjZXNzX3Rva2VuOwogICAgICAgICAgICAgICAgZGVsZXRlIGhhc2guYWNjZXNzX3Rva2VuOwogICAgICAgICAgICAgICAgZGVsZXRlIGhhc2gudG9rZW5fdHlwZTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBoYXNoLmV4cGlyZXNfaW47CiAgICAgICAgICAgICAgICBkZWxldGUgaGFzaC5zdGF0ZTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBoYXNoLnNjb3BlczsKICAgICAgICAgICAgICAgIGhhc2hTdHJpbmcgPSBidWlsZFF1ZXJ5KGhhc2gpOwogICAgICAgICAgICAgICAgbmV3SGFzaCA9IGhhc2hTdHJpbmcgPyAiIyIuY29uY2F0KGhhc2hTdHJpbmcpIDogJyc7CiAgICAgICAgICAgICAgICByZXBsYWNlVVJMID0gIiIuY29uY2F0KGdldENsZWFuVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKSkuY29uY2F0KHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpLmNvbmNhdChuZXdIYXNoKTsKICAgICAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCAnJywgcmVwbGFjZVVSTCk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBhY2Nlc3NUb2tlbik7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlQXV0aCgpIHsKICAgICAgICByZXR1cm4gX2hhbmRsZUF1dGguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGhhbmRsZUF1dGg7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IHRoZSBsb2dnZWQtaW4gdXNlciB3aXRoIGFjY2VzcyB0b2tlbi4KICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmF0bGFzc2lhbi5jb20vYml0YnVja2V0L2FwaS8yL3JlZmVyZW5jZS9yZXNvdXJjZS91c2VyCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0VXNlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldFVzZXIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKF9yZWYyKSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBfeWllbGQkdGhpcyQkaHR0cCRnZXQsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYyLmFjY2Vzc1Rva2VuOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCd1c2VyJywgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJGdldCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJGdldC5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZVVzZXIoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRVc2VyKF94KSB7CiAgICAgICAgcmV0dXJuIF9nZXRVc2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRVc2VyOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCBpc3N1ZSBvZiB0aGlzIHBhZ2UgYWNjb3JkaW5nIHRvIHRoZSBpc3N1ZSBpZCBvciB0aGUgaXNzdWUgdGl0bGUKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmF0bGFzc2lhbi5jb20vYml0YnVja2V0L2FwaS8yL3JlZmVyZW5jZS9yZXNvdXJjZS9yZXBvc2l0b3JpZXMvJTdCdXNlcm5hbWUlN0QvJTdCcmVwb19zbHVnJTdEL2lzc3Vlcy8lN0Jpc3N1ZV9pZCU3RCNnZXQKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuYXRsYXNzaWFuLmNvbS9iaXRidWNrZXQvYXBpLzIvcmVmZXJlbmNlL3Jlc291cmNlL3JlcG9zaXRvcmllcy8lN0J1c2VybmFtZSU3RC8lN0JyZXBvX3NsdWclN0QvaXNzdWVzI2dldAogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5hdGxhc3NpYW4uY29tL2JpdGJ1Y2tldC9hcGkvMi9yZWZlcmVuY2UvbWV0YS9wYWdpbmF0aW9uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0SXNzdWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRJc3N1ZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoX3JlZjMpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIGlzc3VlVGl0bGUsIG9wdGlvbnMsIF95aWVsZCR0aGlzJCRodHRwJGdldDIsIGRhdGEsIF95aWVsZCR0aGlzJCRodHRwJGdldDMsIF9kYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmMy5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWYzLmlzc3VlSWQsIGlzc3VlVGl0bGUgPSBfcmVmMy5pc3N1ZVRpdGxlOwogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHt9OwoKICAgICAgICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbikgewogICAgICAgICAgICAgICAgICBvcHRpb25zLmhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIWlzc3VlSWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSA0OwogICAgICAgICAgICAgICAgb3B0aW9ucy5wYXJhbXMgPSB7CiAgICAgICAgICAgICAgICAgIC8vIHRvIGF2b2lkIGNhY2hpbmcKICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA4OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCJyZXBvc2l0b3JpZXMvIi5jb25jYXQodGhpcy5vd25lciwgIi8iKS5jb25jYXQodGhpcy5yZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCksIG9wdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRnZXQyID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkZ2V0Mi5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUlzc3VlKGRhdGEpKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gMTM7CiAgICAgICAgICAgICAgICBfY29udGV4dDMudDAgPSBfY29udGV4dDNbImNhdGNoIl0oNCk7CgogICAgICAgICAgICAgICAgaWYgKCEoX2NvbnRleHQzLnQwLnJlc3BvbnNlICYmIF9jb250ZXh0My50MC5yZXNwb25zZS5zdGF0dXMgPT09IDQwNCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgdGhyb3cgX2NvbnRleHQzLnQwOwoKICAgICAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyODsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgICAgb3B0aW9ucy5wYXJhbXMgPSB7CiAgICAgICAgICAgICAgICAgIHNvcnQ6ICdjcmVhdGVkX29uJywKICAgICAgICAgICAgICAgICAgcTogInRpdGxlPVwiIi5jb25jYXQoaXNzdWVUaXRsZSwgIlwiIiksCiAgICAgICAgICAgICAgICAgIC8vIHRvIGF2b2lkIGNhY2hpbmcKICAgICAgICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldCgicmVwb3NpdG9yaWVzLyIuY29uY2F0KHRoaXMub3duZXIsICIvIikuY29uY2F0KHRoaXMucmVwbywgIi9pc3N1ZXMiKSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRnZXQzID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBfZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJGdldDMuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCBfZGF0YS5zaXplID4gMCA/IG5vcm1hbGl6ZUlzc3VlKF9kYXRhLnZhbHVlc1swXSkgOiBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcywgW1s0LCAxM11dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0SXNzdWUoX3gyKSB7CiAgICAgICAgcmV0dXJuIF9nZXRJc3N1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0SXNzdWU7CiAgICB9KCkKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGlzc3VlCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5hdGxhc3NpYW4uY29tL2JpdGJ1Y2tldC9hcGkvMi9yZWZlcmVuY2UvcmVzb3VyY2UvcmVwb3NpdG9yaWVzLyU3QnVzZXJuYW1lJTdELyU3QnJlcG9fc2x1ZyU3RC9pc3N1ZXMjcG9zdAogICAgICovCgogIH0sIHsKICAgIGtleTogInBvc3RJc3N1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RJc3N1ZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoX3JlZjQpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIHRpdGxlLCBjb250ZW50LCBfeWllbGQkdGhpcyQkaHR0cCRwb3MsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY0LmFjY2Vzc1Rva2VuLCB0aXRsZSA9IF9yZWY0LnRpdGxlLCBjb250ZW50ID0gX3JlZjQuY29udGVudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoInJlcG9zaXRvcmllcy8iLmNvbmNhdCh0aGlzLm93bmVyLCAiLyIpLmNvbmNhdCh0aGlzLnJlcG8sICIvaXNzdWVzIiksIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgcmF3OiBjb250ZW50CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHByaW9yaXR5OiAndHJpdmlhbCcsCiAgICAgICAgICAgICAgICAgIGtpbmQ6ICd0YXNrJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvcyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvcy5kYXRhOwogICAgICAgICAgICAgICAgZGF0YS5saW5rcy5odG1sID0gewogICAgICAgICAgICAgICAgICBocmVmOiBjb25jYXRVUkwodGhpcy5iYXNlVVJMLCAiIi5jb25jYXQodGhpcy5vd25lciwgIi8iKS5jb25jYXQodGhpcy5yZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoZGF0YS5pZCkpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUlzc3VlKGRhdGEpKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcG9zdElzc3VlKF94MykgewogICAgICAgIHJldHVybiBfcG9zdElzc3VlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3N0SXNzdWU7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IGNvbW1lbnRzIG9mIHRoaXMgcGFnZSBhY2NvcmRpbmcgdG8gdGhlIGlzc3VlIGlkCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5hdGxhc3NpYW4uY29tL2JpdGJ1Y2tldC9hcGkvMi9yZWZlcmVuY2UvcmVzb3VyY2UvcmVwb3NpdG9yaWVzLyU3QnVzZXJuYW1lJTdELyU3QnJlcG9fc2x1ZyU3RC9pc3N1ZXMvJTdCaXNzdWVfaWQlN0QvY29tbWVudHMjZ2V0CiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmF0bGFzc2lhbi5jb20vYml0YnVja2V0L2FwaS8yL3JlZmVyZW5jZS9tZXRhL3BhZ2luYXRpb24KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDb21tZW50cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldENvbW1lbnRzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShfcmVmNSkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgX3JlZjUkcXVlcnksIF9yZWY1JHF1ZXJ5JHBhZ2UsIHBhZ2UsIF9yZWY1JHF1ZXJ5JHBlclBhZ2UsIHBlclBhZ2UsIF9yZWY1JHF1ZXJ5JHNvcnQsIHNvcnQsIG9wdGlvbnMsIF95aWVsZCR0aGlzJCRodHRwJGdldDQsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY1LmFjY2Vzc1Rva2VuLCBpc3N1ZUlkID0gX3JlZjUuaXNzdWVJZCwgX3JlZjUkcXVlcnkgPSBfcmVmNS5xdWVyeTsKICAgICAgICAgICAgICAgIF9yZWY1JHF1ZXJ5ID0gX3JlZjUkcXVlcnkgPT09IHZvaWQgMCA/IHt9IDogX3JlZjUkcXVlcnk7CiAgICAgICAgICAgICAgICBfcmVmNSRxdWVyeSRwYWdlID0gX3JlZjUkcXVlcnkucGFnZSwgcGFnZSA9IF9yZWY1JHF1ZXJ5JHBhZ2UgPT09IHZvaWQgMCA/IDEgOiBfcmVmNSRxdWVyeSRwYWdlLCBfcmVmNSRxdWVyeSRwZXJQYWdlID0gX3JlZjUkcXVlcnkucGVyUGFnZSwgcGVyUGFnZSA9IF9yZWY1JHF1ZXJ5JHBlclBhZ2UgPT09IHZvaWQgMCA/IDEwIDogX3JlZjUkcXVlcnkkcGVyUGFnZSwgX3JlZjUkcXVlcnkkc29ydCA9IF9yZWY1JHF1ZXJ5LnNvcnQsIHNvcnQgPSBfcmVmNSRxdWVyeSRzb3J0ID09PSB2b2lkIDAgPyAnZGVzYycgOiBfcmVmNSRxdWVyeSRzb3J0OwogICAgICAgICAgICAgICAgb3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgLy8gcGFnaW5hdGlvbgogICAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsCiAgICAgICAgICAgICAgICAgICAgcGFnZWxlbjogcGVyUGFnZSwKICAgICAgICAgICAgICAgICAgICBzb3J0OiBzb3J0ID09PSAnZGVzYycgPyAnLWNyZWF0ZWRfb24nIDogJ2NyZWF0ZWRfb24nLAogICAgICAgICAgICAgICAgICAgIC8vIHRvIGF2b2lkIGNhY2hpbmcKICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBpZiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCJyZXBvc2l0b3JpZXMvIi5jb25jYXQodGhpcy5vd25lciwgIi8iKS5jb25jYXQodGhpcy5yZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCwgIi9jb21tZW50cyIpLCBvcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0NCA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJGdldDQuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICAgIGNvdW50OiBkYXRhLnNpemUsCiAgICAgICAgICAgICAgICAgIHBhZ2U6IGRhdGEucGFnZSwKICAgICAgICAgICAgICAgICAgcGVyUGFnZTogZGF0YS5wYWdlbGVuLAogICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLnZhbHVlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5jb250ZW50LnJhdyAhPT0gbnVsbDsKICAgICAgICAgICAgICAgICAgfSkubWFwKG5vcm1hbGl6ZUNvbW1lbnQpCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldENvbW1lbnRzKF94NCkgewogICAgICAgIHJldHVybiBfZ2V0Q29tbWVudHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldENvbW1lbnRzOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5hdGxhc3NpYW4uY29tL2JpdGJ1Y2tldC9hcGkvMi9yZWZlcmVuY2UvcmVzb3VyY2UvcmVwb3NpdG9yaWVzLyU3QnVzZXJuYW1lJTdELyU3QnJlcG9fc2x1ZyU3RC9pc3N1ZXMvJTdCaXNzdWVfaWQlN0QvY29tbWVudHMjcG9zdAogICAgICovCgogIH0sIHsKICAgIGtleTogInBvc3RDb21tZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdENvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KF9yZWY2KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBjb250ZW50LCBfeWllbGQkdGhpcyQkaHR0cCRwb3MyLCBkYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmNi5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWY2Lmlzc3VlSWQsIGNvbnRlbnQgPSBfcmVmNi5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgicmVwb3NpdG9yaWVzLyIuY29uY2F0KHRoaXMub3duZXIsICIvIikuY29uY2F0KHRoaXMucmVwbywgIi9pc3N1ZXMvIikuY29uY2F0KGlzc3VlSWQsICIvY29tbWVudHMiKSwgewogICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgcmF3OiBjb250ZW50CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3MyID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zMi5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUNvbW1lbnQoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwb3N0Q29tbWVudChfeDUpIHsKICAgICAgICByZXR1cm4gX3Bvc3RDb21tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3N0Q29tbWVudDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBFZGl0IGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuYXRsYXNzaWFuLmNvbS9iaXRidWNrZXQvYXBpLzIvcmVmZXJlbmNlL3Jlc291cmNlL3JlcG9zaXRvcmllcy8lN0J1c2VybmFtZSU3RC8lN0JyZXBvX3NsdWclN0QvaXNzdWVzLyU3Qmlzc3VlX2lkJTdEL2NvbW1lbnRzLyU3QmNvbW1lbnRfaWQlN0QjcHV0CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicHV0Q29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3B1dENvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KF9yZWY3KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBjb21tZW50SWQsIGNvbnRlbnQsIF95aWVsZCR0aGlzJCRodHRwJHB1dCwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjcuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmNy5pc3N1ZUlkLCBjb21tZW50SWQgPSBfcmVmNy5jb21tZW50SWQsIGNvbnRlbnQgPSBfcmVmNy5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucHV0KCJyZXBvc2l0b3JpZXMvIi5jb25jYXQodGhpcy5vd25lciwgIi8iKS5jb25jYXQodGhpcy5yZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCwgIi9jb21tZW50cy8iKS5jb25jYXQoY29tbWVudElkKSwgewogICAgICAgICAgICAgICAgICBjb250ZW50OiB7CiAgICAgICAgICAgICAgICAgICAgcmF3OiBjb250ZW50CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwdXQgPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwdXQuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVDb21tZW50KGRhdGEpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcHV0Q29tbWVudChfeDYpIHsKICAgICAgICByZXR1cm4gX3B1dENvbW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHB1dENvbW1lbnQ7CiAgICB9KCkKICAgIC8qKgogICAgICogRGVsZXRlIGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuYXRsYXNzaWFuLmNvbS9iaXRidWNrZXQvYXBpLzIvcmVmZXJlbmNlL3Jlc291cmNlL3JlcG9zaXRvcmllcy8lN0J1c2VybmFtZSU3RC8lN0JyZXBvX3NsdWclN0QvaXNzdWVzLyU3Qmlzc3VlX2lkJTdEL2NvbW1lbnRzLyU3QmNvbW1lbnRfaWQlN0QjZGVsZXRlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGVsZXRlQ29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2RlbGV0ZUNvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KF9yZWY4KSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBjb21tZW50SWQsIF95aWVsZCR0aGlzJCRodHRwJGRlbCwgc3RhdHVzOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmOC5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWY4Lmlzc3VlSWQsIGNvbW1lbnRJZCA9IF9yZWY4LmNvbW1lbnRJZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwWyJkZWxldGUiXSgicmVwb3NpdG9yaWVzLyIuY29uY2F0KHRoaXMub3duZXIsICIvIikuY29uY2F0KHRoaXMucmVwbywgIi9pc3N1ZXMvIikuY29uY2F0KGlzc3VlSWQsICIvY29tbWVudHMvIikuY29uY2F0KGNvbW1lbnRJZCksIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRkZWwgPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgIHN0YXR1cyA9IF95aWVsZCR0aGlzJCRodHRwJGRlbC5zdGF0dXM7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgc3RhdHVzID09PSAyMDQpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBkZWxldGVDb21tZW50KF94NykgewogICAgICAgIHJldHVybiBfZGVsZXRlQ29tbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZGVsZXRlQ29tbWVudDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBCaXRidWNrZXQgZG9lcyBub3Qgc3VwcG9ydCByZWFjdGlvbnMgbm93CiAgICAgKi8KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMKCiAgfSwgewogICAga2V5OiAiZ2V0Q29tbWVudFJlYWN0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldENvbW1lbnRSZWFjdGlvbnMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KG9wdGlvbnMpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCc1MDEgTm90IEltcGxlbWVudGVkJyk7CgogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldENvbW1lbnRSZWFjdGlvbnMoX3g4KSB7CiAgICAgICAgcmV0dXJuIF9nZXRDb21tZW50UmVhY3Rpb25zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRDb21tZW50UmVhY3Rpb25zOwogICAgfSgpCiAgICAvKioKICAgICAqIEJpdGJ1Y2tldCBkb2VzIG5vdCBzdXBwb3J0IHJlYWN0aW9ucyBub3cKICAgICAqLwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFycwoKICB9LCB7CiAgICBrZXk6ICJwb3N0Q29tbWVudFJlYWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdENvbW1lbnRSZWFjdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEwKG9wdGlvbnMpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTEwJChfY29udGV4dDEwKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTAucHJldiA9IF9jb250ZXh0MTAubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignNTAxIE5vdCBJbXBsZW1lbnRlZCcpOwoKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHBvc3RDb21tZW50UmVhY3Rpb24oX3g5KSB7CiAgICAgICAgcmV0dXJuIF9wb3N0Q29tbWVudFJlYWN0aW9uLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3N0Q29tbWVudFJlYWN0aW9uOwogICAgfSgpCiAgfSwgewogICAga2V5OiAicGxhdGZvcm0iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogJ0JpdGJ1Y2tldCcsCiAgICAgICAgbGluazogdGhpcy5iYXNlVVJMLAogICAgICAgIHZlcnNpb246ICd2MicsCiAgICAgICAgbWV0YTogewogICAgICAgICAgcmVhY3RhYmxlOiBmYWxzZSwKICAgICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgICAgfQogICAgICB9OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJpdGJ1Y2tldFYyOwp9KCk7CgpleHBvcnQgeyBCaXRidWNrZXRWMiBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import axios from 'axios';\nimport { buildQuery, buildURL, concatURL, getCleanURL, parseQuery, } from '@vssue/utils';\nimport { normalizeUser, normalizeIssue, normalizeComment } from './utils';\n/**\n * Bitbucket API V2\n *\n * @see https://developer.atlassian.com/bitbucket/api/2/reference/\n * @see https://confluence.atlassian.com/bitbucket/oauth-on-bitbucket-cloud-238027431.html\n */\nexport default class BitbucketV2 {\n    constructor({ baseURL = 'https://bitbucket.org', owner, repo, clientId, state, }) {\n        this.baseURL = baseURL;\n        this.owner = owner;\n        this.repo = repo;\n        this.clientId = clientId;\n        this.state = state;\n        this.$http = axios.create({\n            baseURL: 'https://api.bitbucket.org/2.0',\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n    /**\n     * The platform api info\n     */\n    get platform() {\n        return {\n            name: 'Bitbucket',\n            link: this.baseURL,\n            version: 'v2',\n            meta: {\n                reactable: false,\n                sortable: true,\n            },\n        };\n    }\n    /**\n     * Redirect to the authorization page of platform.\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/meta/authentication#oauth-2\n     */\n    redirectAuth() {\n        window.location.href = buildURL(concatURL(this.baseURL, 'site/oauth2/authorize'), {\n            client_id: this.clientId,\n            redirect_uri: window.location.href,\n            response_type: 'token',\n            state: this.state,\n        });\n    }\n    /**\n     * Handle authorization.\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/meta/authentication#oauth-2\n     *\n     * @remarks\n     * If the `access_token` and `state` exist in the query, and the `state` matches, remove them from query, and return the access token.\n     */\n    async handleAuth() {\n        const hash = parseQuery(window.location.hash.slice(1));\n        if (!hash.access_token || hash.state !== this.state) {\n            return null;\n        }\n        const accessToken = hash.access_token;\n        delete hash.access_token;\n        delete hash.token_type;\n        delete hash.expires_in;\n        delete hash.state;\n        delete hash.scopes;\n        const hashString = buildQuery(hash);\n        const newHash = hashString ? `#${hashString}` : '';\n        const replaceURL = `${getCleanURL(window.location.href)}${window.location.search}${newHash}`;\n        window.history.replaceState(null, '', replaceURL);\n        return accessToken;\n    }\n    /**\n     * Get the logged-in user with access token.\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/user\n     */\n    async getUser({ accessToken, }) {\n        const { data } = await this.$http.get('user', {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeUser(data);\n    }\n    /**\n     * Get issue of this page according to the issue id or the issue title\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues/%7Bissue_id%7D#get\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues#get\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/meta/pagination\n     */\n    async getIssue({ accessToken, issueId, issueTitle, }) {\n        const options = {};\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        if (issueId) {\n            try {\n                options.params = {\n                    // to avoid caching\n                    timestamp: Date.now(),\n                };\n                const { data } = await this.$http.get(`repositories/${this.owner}/${this.repo}/issues/${issueId}`, options);\n                return normalizeIssue(data);\n            }\n            catch (e) {\n                if (e.response && e.response.status === 404) {\n                    return null;\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        else {\n            options.params = {\n                sort: 'created_on',\n                q: `title=\"${issueTitle}\"`,\n                // to avoid caching\n                timestamp: Date.now(),\n            };\n            const { data } = await this.$http.get(`repositories/${this.owner}/${this.repo}/issues`, options);\n            return data.size > 0 ? normalizeIssue(data.values[0]) : null;\n        }\n    }\n    /**\n     * Create a new issue\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues#post\n     */\n    async postIssue({ accessToken, title, content, }) {\n        const { data } = await this.$http.post(`repositories/${this.owner}/${this.repo}/issues`, {\n            title,\n            content: {\n                raw: content,\n            },\n            priority: 'trivial',\n            kind: 'task',\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        data.links.html = {\n            href: concatURL(this.baseURL, `${this.owner}/${this.repo}/issues/${data.id}`),\n        };\n        return normalizeIssue(data);\n    }\n    /**\n     * Get comments of this page according to the issue id\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues/%7Bissue_id%7D/comments#get\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/meta/pagination\n     */\n    async getComments({ accessToken, issueId, query: { page = 1, perPage = 10, sort = 'desc' } = {}, }) {\n        const options = {\n            params: {\n                // pagination\n                page: page,\n                pagelen: perPage,\n                sort: sort === 'desc' ? '-created_on' : 'created_on',\n                // to avoid caching\n                timestamp: Date.now(),\n            },\n        };\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        const { data } = await this.$http.get(`repositories/${this.owner}/${this.repo}/issues/${issueId}/comments`, options);\n        return {\n            count: data.size,\n            page: data.page,\n            perPage: data.pagelen,\n            data: data.values\n                .filter(item => item.content.raw !== null)\n                .map(normalizeComment),\n        };\n    }\n    /**\n     * Create a new comment\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues/%7Bissue_id%7D/comments#post\n     */\n    async postComment({ accessToken, issueId, content, }) {\n        const { data } = await this.$http.post(`repositories/${this.owner}/${this.repo}/issues/${issueId}/comments`, {\n            content: {\n                raw: content,\n            },\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeComment(data);\n    }\n    /**\n     * Edit a comment\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues/%7Bissue_id%7D/comments/%7Bcomment_id%7D#put\n     */\n    async putComment({ accessToken, issueId, commentId, content, }) {\n        const { data } = await this.$http.put(`repositories/${this.owner}/${this.repo}/issues/${issueId}/comments/${commentId}`, {\n            content: {\n                raw: content,\n            },\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeComment(data);\n    }\n    /**\n     * Delete a comment\n     *\n     * @see https://developer.atlassian.com/bitbucket/api/2/reference/resource/repositories/%7Busername%7D/%7Brepo_slug%7D/issues/%7Bissue_id%7D/comments/%7Bcomment_id%7D#delete\n     */\n    async deleteComment({ accessToken, issueId, commentId, }) {\n        const { status } = await this.$http.delete(`repositories/${this.owner}/${this.repo}/issues/${issueId}/comments/${commentId}`, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return status === 204;\n    }\n    /**\n     * Bitbucket does not support reactions now\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async getCommentReactions(options) {\n        throw new Error('501 Not Implemented');\n    }\n    /**\n     * Bitbucket does not support reactions now\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    async postCommentReaction(options) {\n        throw new Error('501 Not Implemented');\n    }\n}\n//# sourceMappingURL=index.js.map"]}]}