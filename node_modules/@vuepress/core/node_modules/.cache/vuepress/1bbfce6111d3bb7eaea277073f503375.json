{"remainingRequest":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/babel-loader/lib/index.js??ref--3-1!/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/@vssue/api-github-v4/lib/index.js","dependencies":[{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/@vssue/api-github-v4/lib/index.js","mtime":1604064595705},{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/cache-loader/dist/cjs.js","mtime":1603041438982},{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/babel-loader/lib/index.js","mtime":1603041438713}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZXZlcnNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zZWFyY2giOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIi9vcHQvbXlibG9nL3Z1ZXByZXNzLXRoZW1lLXJlY28tbWFzdGVyL3pkYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvb3B0L215YmxvZy92dWVwcmVzcy10aGVtZS1yZWNvLW1hc3Rlci96ZGJsb2cvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9vcHQvbXlibG9nL3Z1ZXByZXNzLXRoZW1lLXJlY28tbWFzdGVyL3pkYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9vcHQvbXlibG9nL3Z1ZXByZXNzLXRoZW1lLXJlY28tbWFzdGVyL3pkYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyBidWlsZFVSTCwgY29uY2F0VVJMLCBnZXRDbGVhblVSTCwgcGFyc2VRdWVyeSB9IGZyb20gJ0B2c3N1ZS91dGlscyc7CmltcG9ydCB7IG5vcm1hbGl6ZVVzZXIsIG5vcm1hbGl6ZUlzc3VlLCBub3JtYWxpemVDb21tZW50LCBub3JtYWxpemVSZWFjdGlvbnMsIG1hcFJlYWN0aW9uTmFtZSB9IGZyb20gJy4vdXRpbHMnOwovKioKICogR2l0aHViIEdyYXBoUUwgQVBJIHY0CiAqCiAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC8KICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L2V4cGxvcmVyLwogKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vYXBwcy9idWlsZGluZy1vYXV0aC1hcHBzLwogKi8KCnZhciBHaXRodWJWNCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gR2l0aHViVjQoX3JlZikgewogICAgdmFyIF9yZWYkYmFzZVVSTCA9IF9yZWYuYmFzZVVSTCwKICAgICAgICBiYXNlVVJMID0gX3JlZiRiYXNlVVJMID09PSB2b2lkIDAgPyAnaHR0cHM6Ly9naXRodWIuY29tJyA6IF9yZWYkYmFzZVVSTCwKICAgICAgICBvd25lciA9IF9yZWYub3duZXIsCiAgICAgICAgcmVwbyA9IF9yZWYucmVwbywKICAgICAgICBsYWJlbHMgPSBfcmVmLmxhYmVscywKICAgICAgICBjbGllbnRJZCA9IF9yZWYuY2xpZW50SWQsCiAgICAgICAgY2xpZW50U2VjcmV0ID0gX3JlZi5jbGllbnRTZWNyZXQsCiAgICAgICAgc3RhdGUgPSBfcmVmLnN0YXRlLAogICAgICAgIHByb3h5ID0gX3JlZi5wcm94eTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2l0aHViVjQpOwoKICAgIGlmICh0eXBlb2YgY2xpZW50U2VjcmV0ID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgcHJveHkgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY2xpZW50U2VjcmV0IGFuZCBwcm94eSBpcyByZXF1aXJlZCBmb3IgR2l0SHViIFY0Jyk7CiAgICB9CgogICAgdGhpcy5iYXNlVVJMID0gYmFzZVVSTDsKICAgIHRoaXMub3duZXIgPSBvd25lcjsKICAgIHRoaXMucmVwbyA9IHJlcG87CiAgICB0aGlzLmxhYmVscyA9IGxhYmVsczsKICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDsKICAgIHRoaXMuY2xpZW50U2VjcmV0ID0gY2xpZW50U2VjcmV0OwogICAgdGhpcy5zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5wcm94eSA9IHByb3h5OwogICAgdGhpcy5fcGFnZUluZm8gPSB7CiAgICAgIHBhZ2U6IDEsCiAgICAgIHN0YXJ0Q3Vyc29yOiBudWxsLAogICAgICBlbmRDdXJzb3I6IG51bGwsCiAgICAgIHNvcnQ6IG51bGwsCiAgICAgIHBlclBhZ2U6IG51bGwKICAgIH07CiAgICB0aGlzLl9pc3N1ZU5vZGVJZCA9IG51bGw7CiAgICB0aGlzLiRodHRwID0gYXhpb3MuY3JlYXRlKHsKICAgICAgYmFzZVVSTDogYmFzZVVSTCA9PT0gJ2h0dHBzOi8vZ2l0aHViLmNvbScgPyAnaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbScgOiBjb25jYXRVUkwoYmFzZVVSTCwgJ2FwaScpLAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vdm5kLmdpdGh1Yi52Mytqc29uJwogICAgICB9CiAgICB9KTsKICAgIHRoaXMuJGh0dHAuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZXJyb3IpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcG9uc2UuZGF0YS5lcnJvcl9kZXNjcmlwdGlvbik7CiAgICAgIH0KCiAgICAgIGlmIChyZXNwb25zZS5kYXRhLmVycm9ycykgewogICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZS5kYXRhLmVycm9yc1swXS5tZXNzYWdlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgfSk7CiAgfQogIC8qKgogICAqIFRoZSBwbGF0Zm9ybSBhcGkgaW5mbwogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKEdpdGh1YlY0LCBbewogICAga2V5OiAicmVkaXJlY3RBdXRoIiwKCiAgICAvKioKICAgICAqIFJlZGlyZWN0IHRvIHRoZSBhdXRob3JpemF0aW9uIHBhZ2Ugb2YgcGxhdGZvcm0uCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL2FwcHMvYnVpbGRpbmctb2F1dGgtYXBwcy9hdXRob3JpemluZy1vYXV0aC1hcHBzLyMxLXJlcXVlc3QtYS11c2Vycy1naXRodWItaWRlbnRpdHkKICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZGlyZWN0QXV0aCgpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBidWlsZFVSTChjb25jYXRVUkwodGhpcy5iYXNlVVJMLCAnbG9naW4vb2F1dGgvYXV0aG9yaXplJyksIHsKICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY2xpZW50SWQsCiAgICAgICAgcmVkaXJlY3RfdXJpOiB3aW5kb3cubG9jYXRpb24uaHJlZiwKICAgICAgICBzY29wZTogJ3B1YmxpY19yZXBvJywKICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogSGFuZGxlIGF1dGhvcml6YXRpb24uCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL2FwcHMvYnVpbGRpbmctb2F1dGgtYXBwcy9hdXRob3JpemluZy1vYXV0aC1hcHBzLwogICAgICoKICAgICAqIEByZW1hcmtzCiAgICAgKiBJZiB0aGUgYGNvZGVgIGFuZCBgc3RhdGVgIGV4aXN0IGluIHRoZSBxdWVyeSwgYW5kIHRoZSBgc3RhdGVgIG1hdGNoZXMsIHJlbW92ZSB0aGVtIGZyb20gcXVlcnksIGFuZCB0cnkgdG8gZ2V0IHRoZSBhY2Nlc3MgdG9rZW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiaGFuZGxlQXV0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2hhbmRsZUF1dGggPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHF1ZXJ5LCBjb2RlLCByZXBsYWNlVVJMLCBhY2Nlc3NUb2tlbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBxdWVyeSA9IHBhcnNlUXVlcnkod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7CgogICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5jb2RlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEocXVlcnkuc3RhdGUgIT09IHRoaXMuc3RhdGUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgY29kZSA9IHF1ZXJ5LmNvZGU7CiAgICAgICAgICAgICAgICBkZWxldGUgcXVlcnkuY29kZTsKICAgICAgICAgICAgICAgIGRlbGV0ZSBxdWVyeS5zdGF0ZTsKICAgICAgICAgICAgICAgIHJlcGxhY2VVUkwgPSBidWlsZFVSTChnZXRDbGVhblVSTCh3aW5kb3cubG9jYXRpb24uaHJlZiksIHF1ZXJ5KSArIHdpbmRvdy5sb2NhdGlvbi5oYXNoOwogICAgICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKG51bGwsICcnLCByZXBsYWNlVVJMKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEFjY2Vzc1Rva2VuKHsKICAgICAgICAgICAgICAgICAgY29kZTogY29kZQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBhY2Nlc3NUb2tlbik7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBoYW5kbGVBdXRoKCkgewogICAgICAgIHJldHVybiBfaGFuZGxlQXV0aC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gaGFuZGxlQXV0aDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBHZXQgdXNlciBhY2Nlc3MgdG9rZW4gdmlhIGBjb2RlYAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS9hcHBzL2J1aWxkaW5nLW9hdXRoLWFwcHMvYXV0aG9yaXppbmctb2F1dGgtYXBwcy8jMi11c2Vycy1hcmUtcmVkaXJlY3RlZC1iYWNrLXRvLXlvdXItc2l0ZS1ieS1naXRodWIKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRBY2Nlc3NUb2tlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEFjY2Vzc1Rva2VuID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihfcmVmMikgewogICAgICAgIHZhciBjb2RlLCBvcmlnaW5hbFVSTCwgcHJveHlVUkwsIF95aWVsZCR0aGlzJCRodHRwJHBvcywgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvZGUgPSBfcmVmMi5jb2RlOwoKICAgICAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgICAgICogYWNjZXNzX3Rva2VuIGFwaSBkb2VzIG5vdCBzdXBwb3J0IGNvcnMKICAgICAgICAgICAgICAgICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2lzYWFjcy9naXRodWIvaXNzdWVzLzMzMAogICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICBvcmlnaW5hbFVSTCA9IGNvbmNhdFVSTCh0aGlzLmJhc2VVUkwsICdsb2dpbi9vYXV0aC9hY2Nlc3NfdG9rZW4nKTsKICAgICAgICAgICAgICAgIHByb3h5VVJMID0gdHlwZW9mIHRoaXMucHJveHkgPT09ICdmdW5jdGlvbicgPyB0aGlzLnByb3h5KG9yaWdpbmFsVVJMKSA6IHRoaXMucHJveHk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KHByb3h5VVJMLCB7CiAgICAgICAgICAgICAgICAgIGNsaWVudF9pZDogdGhpcy5jbGllbnRJZCwKICAgICAgICAgICAgICAgICAgY2xpZW50X3NlY3JldDogdGhpcy5jbGllbnRTZWNyZXQsCiAgICAgICAgICAgICAgICAgIGNvZGU6IGNvZGUKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3MgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3MuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBkYXRhLmFjY2Vzc190b2tlbik7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldEFjY2Vzc1Rva2VuKF94KSB7CiAgICAgICAgcmV0dXJuIF9nZXRBY2Nlc3NUb2tlbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0QWNjZXNzVG9rZW47CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IHRoZSBsb2dnZWQtaW4gdXNlciB3aXRoIGFjY2VzcyB0b2tlbi4KICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvcXVlcnkvIHZpZXdlcgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L29iamVjdC91c2VyLwogICAgICovCgogIH0sIHsKICAgIGtleTogImdldFVzZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRVc2VyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhfcmVmMykgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgX3lpZWxkJHRoaXMkJGh0dHAkcG9zMiwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjMuYWNjZXNzVG9rZW47CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCdncmFwaHFsJywgewogICAgICAgICAgICAgICAgICBxdWVyeTogInF1ZXJ5IGdldFVzZXIge1xuICB2aWV3ZXIge1xuICAgIGxvZ2luXG4gICAgYXZhdGFyVXJsXG4gICAgdXJsXG4gIH1cbn0iCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAidG9rZW4gIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3MyID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zMi5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZVVzZXIoZGF0YS5kYXRhLnZpZXdlcikpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRVc2VyKF94MikgewogICAgICAgIHJldHVybiBfZ2V0VXNlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0VXNlcjsKICAgIH0oKQogICAgLyoqCiAgICAgKiBHZXQgaXNzdWUgb2YgdGhpcyBwYWdlIGFjY29yZGluZyB0byB0aGUgaXNzdWUgaWQgb3IgdGhlIGlzc3VlIHRpdGxlCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L29iamVjdC9yZXBvc2l0b3J5LwogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L29iamVjdC9pc3N1ZWNvbm5lY3Rpb24vCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvb2JqZWN0L2lzc3VlLwogICAgICoKICAgICAqIEByZW1hcmtzCiAgICAgKiBUaGUgSXNzdWVDb25uZWN0aW9uIGRvZXMgbm90IGhhdmUgdGl0bGUgZmlsdGVyIGZvciBub3csIGFuZCB0aGUgbnVtYmVyIG9mIHJlc3VsdHMgaXMgbGltaXRlZCB0byAxMDAuCiAgICAgKiBGb3Igbm93LCBpZiBpc3N1ZXMgd2l0aCB0aGUgbGFiZWxzIGFyZSBtb3JlIHRoYW4gMTAwLCB3ZSBoYXZlIHRvIHJlcXVlc3QgdGhlIG5leHQgcGFnZShub3QgaW1wbGVtZW50ZWQgeWV0KS4KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRJc3N1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldElzc3VlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChfcmVmNCkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgaXNzdWVUaXRsZSwgb3B0aW9ucywgX3lpZWxkJHRoaXMkJGh0dHAkcG9zMywgZGF0YSwgcXVlcnksIF95aWVsZCR0aGlzJCRodHRwJHBvczQsIF9kYXRhLCBpc3N1ZTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjQuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmNC5pc3N1ZUlkLCBpc3N1ZVRpdGxlID0gX3JlZjQuaXNzdWVUaXRsZTsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICAgICAgICAgICAgICBpZiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIWlzc3VlSWQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSA0OwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgiZ3JhcGhxbCIsIHsKICAgICAgICAgICAgICAgICAgcXVlcnk6ICJxdWVyeSBnZXRJc3N1ZUJ5SWQge1xuICByZXBvc2l0b3J5KG93bmVyOiBcIiIuY29uY2F0KHRoaXMub3duZXIsICJcIiwgbmFtZTogXCIiKS5jb25jYXQodGhpcy5yZXBvLCAiXCIpIHtcbiAgICBpc3N1ZSAobnVtYmVyOiAiKS5jb25jYXQoaXNzdWVJZCwgIikge1xuICAgICAgaWRcbiAgICAgIG51bWJlclxuICAgICAgdGl0bGVcbiAgICAgIGJvZHlcbiAgICAgIHVybFxuICAgIH1cbiAgfVxufSIpCiAgICAgICAgICAgICAgICB9LCBvcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zMyA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvczMuZGF0YTsKICAgICAgICAgICAgICAgIC8vIHBvc3RDb21tZW50IG5lZWRzIGlzc3VlIE5vZGVJZCwgc28gd2Ugc3RvcmUgaXQgaW50ZXJuYWxseQogICAgICAgICAgICAgICAgdGhpcy5faXNzdWVOb2RlSWQgPSBkYXRhLmRhdGEucmVwb3NpdG9yeS5pc3N1ZS5pZDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVJc3N1ZShkYXRhLmRhdGEucmVwb3NpdG9yeS5pc3N1ZSkpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgX2NvbnRleHQ0LnByZXYgPSAxMzsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC50MCA9IF9jb250ZXh0NFsiY2F0Y2giXSg0KTsKCiAgICAgICAgICAgICAgICBpZiAoIShfY29udGV4dDQudDAucmVzcG9uc2UgJiYgX2NvbnRleHQ0LnQwLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDE5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dDQudDA7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDMyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjI6CiAgICAgICAgICAgICAgICBxdWVyeSA9IFsiXCIiLmNvbmNhdChpc3N1ZVRpdGxlLCAiXCIiKSwgImluOnRpdGxlIiwgInJlcG86Ii5jb25jYXQodGhpcy5vd25lciwgIi8iKS5jb25jYXQodGhpcy5yZXBvKSwgImlzOnB1YmxpYyJdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkodGhpcy5sYWJlbHMubWFwKGZ1bmN0aW9uIChsYWJlbCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gImxhYmVsOiIuY29uY2F0KGxhYmVsKTsKICAgICAgICAgICAgICAgIH0pKSkuam9pbignICcpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAyNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoImdyYXBocWwiLCB7CiAgICAgICAgICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiBxdWVyeQogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBxdWVyeTogInF1ZXJ5IGdldElzc3VlQnlUaXRsZShcbiAgJHF1ZXJ5OiBTdHJpbmchXG4pIHtcbiAgc2VhcmNoKFxuICAgIHF1ZXJ5OiAkcXVlcnlcbiAgICB0eXBlOiBJU1NVRVxuICAgIGZpcnN0OiAyMFxuICAgICkge1xuICAgICAgbm9kZXMge1xuICAgICAgLi4uIG9uIElzc3VlIHtcbiAgICAgICAgaWRcbiAgICAgICAgbnVtYmVyXG4gICAgICAgIHRpdGxlXG4gICAgICAgIGJvZHlcbiAgICAgICAgdXJsXG4gICAgICB9XG4gICAgfVxuICB9XG59IgogICAgICAgICAgICAgICAgfSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3M0ID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICBfZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvczQuZGF0YTsKICAgICAgICAgICAgICAgIGlzc3VlID0gX2RhdGEuZGF0YS5zZWFyY2gubm9kZXMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS50aXRsZSA9PT0gaXNzdWVUaXRsZTsKICAgICAgICAgICAgICAgIH0pOyAvLyBwb3N0Q29tbWVudCBuZWVkcyBpc3N1ZSBOb2RlSWQsIHNvIHdlIHN0b3JlIGl0IGludGVybmFsbHkKCiAgICAgICAgICAgICAgICBpZiAoIWlzc3VlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuX2lzc3VlTm9kZUlkID0gaXNzdWUuaWQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplSXNzdWUoaXNzdWUpKTsKCiAgICAgICAgICAgICAgY2FzZSAzMToKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcywgW1s0LCAxM11dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0SXNzdWUoX3gzKSB7CiAgICAgICAgcmV0dXJuIF9nZXRJc3N1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0SXNzdWU7CiAgICB9KCkKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGlzc3VlCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L211dGF0aW9uL2NyZWF0ZWlzc3VlLwogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L2lucHV0X29iamVjdC9jcmVhdGVpc3N1ZWlucHV0LwogICAgICoKICAgICAqIEByZW1hcmtzCiAgICAgKiBDcmVhdGluZyBpc3N1ZSByZXF1aXJlcyByZXBvc2l0b3J5SWQsIHdoaWNoIHNob3VsZCBiZSByZXF1ZXN0ZWQgaW4gYW4gZXh0cmEgcmVxdWVzdC4KICAgICAqIENyZWF0aW5nIGlzc3VlIHdpdGggbGFiZWxzIHJlcXVpcmVzIGxhYmVsSWRzLCB3aGljaCBzaG91bGQgYmUgcmVxdWVzdGVkIGluIGFuIGV4dHJhIHJlcXVlc3QsIG9yIGNyZWF0ZSB0aGUgbGFiZWwgaWYgaXQgZG9lcyBub3QgZXhpc3QuCiAgICAgKiBFbmRwb2ludHMgZm9yIGNyZWF0aW5nIGxhYmVscyBoYXMgbm90IGJlZW4gaW1wbGVtZW50ZWQgYnkgR2l0SHViIHlldCAoc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvbXV0YXRpb24vY3JlYXRlbGFiZWwvKQogICAgICoKICAgICAqIEZvciB0aGVzZSByZWFzb25zLCBmYWxsYmFjayB0byB2MyBmb3Igbm93CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicG9zdElzc3VlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdElzc3VlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNShfcmVmNSkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgdGl0bGUsIGNvbnRlbnQsIF95aWVsZCR0aGlzJCRodHRwJHBvczUsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY1LmFjY2Vzc1Rva2VuLCB0aXRsZSA9IF9yZWY1LnRpdGxlLCBjb250ZW50ID0gX3JlZjUuY29udGVudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoInJlcG9zLyIuY29uY2F0KHRoaXMub3duZXIsICIvIikuY29uY2F0KHRoaXMucmVwbywgIi9pc3N1ZXMiKSwgewogICAgICAgICAgICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAgICAgICAgICAgIGJvZHk6IGNvbnRlbnQsCiAgICAgICAgICAgICAgICAgIGxhYmVsczogdGhpcy5sYWJlbHMKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczUgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3M1LmRhdGE7CiAgICAgICAgICAgICAgICAvLyBgaHRtbF91cmxgIGluIHYzCiAgICAgICAgICAgICAgICAvLyBgdXJsYCBpbiB2NAogICAgICAgICAgICAgICAgZGF0YS51cmwgPSBkYXRhLmh0bWxfdXJsOyAvLyBwb3N0Q29tbWVudCBuZWVkcyBpc3N1ZSBOb2RlSWQsIHNvIHdlIHN0b3JlIGl0IGludGVybmFsbHkKCiAgICAgICAgICAgICAgICB0aGlzLl9pc3N1ZU5vZGVJZCA9IGRhdGEubm9kZV9pZDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVJc3N1ZShkYXRhKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHBvc3RJc3N1ZShfeDQpIHsKICAgICAgICByZXR1cm4gX3Bvc3RJc3N1ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcG9zdElzc3VlOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCBjb21tZW50cyBvZiB0aGlzIHBhZ2UgYWNjb3JkaW5nIHRvIHRoZSBpc3N1ZSBpZAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9vYmplY3QvaXNzdWVjb21tZW50Y29ubmVjdGlvbi8KICAgICAqCiAgICAgKiBAcmVtYXJrcwogICAgICogTm8gb2Zmc2V0IGltcGxlbWVudGVkLCBzbyBpdCdzIGRpZmZpY3VsdCB0byBpbXBsZW1lbnQgUkVTVC1saWtlIHBhZ2luYXRpb24KICAgICAqIEZvciBub3csIHdlIHVzZSBhbiBpbnRlcm5hbCBgX3BhZ2VJbmZvYCB2YXIgdG8gaGFjayB0aGF0CiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q29tbWVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRDb21tZW50cyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoX3JlZjYpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIF9yZWY2JHF1ZXJ5LCBfcmVmNiRxdWVyeSRwYWdlLCBwYWdlLCBfcmVmNiRxdWVyeSRwZXJQYWdlLCBwZXJQYWdlLCBfcmVmNiRxdWVyeSRzb3J0LCBzb3J0LCBvcHRpb25zLCBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMsIGZpcnN0T3JMYXN0LCBhZnRlck9yQmVmb3JlLCBjdXJzb3IsIF95aWVsZCR0aGlzJCRodHRwJHBvczYsIGRhdGEsIGNvbW1lbnRzOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmNi5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWY2Lmlzc3VlSWQsIF9yZWY2JHF1ZXJ5ID0gX3JlZjYucXVlcnk7CiAgICAgICAgICAgICAgICBfcmVmNiRxdWVyeSA9IF9yZWY2JHF1ZXJ5ID09PSB2b2lkIDAgPyB7fSA6IF9yZWY2JHF1ZXJ5OwogICAgICAgICAgICAgICAgX3JlZjYkcXVlcnkkcGFnZSA9IF9yZWY2JHF1ZXJ5LnBhZ2UsIHBhZ2UgPSBfcmVmNiRxdWVyeSRwYWdlID09PSB2b2lkIDAgPyAxIDogX3JlZjYkcXVlcnkkcGFnZSwgX3JlZjYkcXVlcnkkcGVyUGFnZSA9IF9yZWY2JHF1ZXJ5LnBlclBhZ2UsIHBlclBhZ2UgPSBfcmVmNiRxdWVyeSRwZXJQYWdlID09PSB2b2lkIDAgPyAxMCA6IF9yZWY2JHF1ZXJ5JHBlclBhZ2UsIF9yZWY2JHF1ZXJ5JHNvcnQgPSBfcmVmNiRxdWVyeS5zb3J0LCBzb3J0ID0gX3JlZjYkcXVlcnkkc29ydCA9PT0gdm9pZCAwID8gJ2Rlc2MnIDogX3JlZjYkcXVlcnkkc29ydDsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICAgICAgICAgICAgICBpZiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGFnZUluZm8uc29ydCAhPT0gbnVsbCAmJiBzb3J0ICE9PSB0aGlzLl9wYWdlSW5mby5zb3J0KSB7CiAgICAgICAgICAgICAgICAgIHBhZ2UgPSAxOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzJF9nZXRRdWVyeVBhcmFtcyA9IHRoaXMuX2dldFF1ZXJ5UGFyYW1zKHsKICAgICAgICAgICAgICAgICAgcGFnZTogcGFnZSwKICAgICAgICAgICAgICAgICAgc29ydDogc29ydAogICAgICAgICAgICAgICAgfSksIGZpcnN0T3JMYXN0ID0gX3RoaXMkX2dldFF1ZXJ5UGFyYW1zLmZpcnN0T3JMYXN0LCBhZnRlck9yQmVmb3JlID0gX3RoaXMkX2dldFF1ZXJ5UGFyYW1zLmFmdGVyT3JCZWZvcmUsIGN1cnNvciA9IF90aGlzJF9nZXRRdWVyeVBhcmFtcy5jdXJzb3I7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCJncmFwaHFsIiwgewogICAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICAgICAgICBvd25lcjogdGhpcy5vd25lciwKICAgICAgICAgICAgICAgICAgICByZXBvOiB0aGlzLnJlcG8sCiAgICAgICAgICAgICAgICAgICAgaXNzdWVJZDogaXNzdWVJZCwKICAgICAgICAgICAgICAgICAgICBwZXJQYWdlOiBwZXJQYWdlCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAicXVlcnkgZ2V0Q29tbWVudHMoXG4gICRvd25lcjogU3RyaW5nIVxuICAkcmVwbzogU3RyaW5nIVxuICAkaXNzdWVJZDogSW50IVxuICAkcGVyUGFnZTogSW50IVxuKSB7XG4gIHJlcG9zaXRvcnkob3duZXI6ICRvd25lciwgbmFtZTogJHJlcG8pIHtcbiAgICBpc3N1ZShudW1iZXI6ICRpc3N1ZUlkKSB7XG4gICAgICBjb21tZW50cyhcbiAgICAgICAgIi5jb25jYXQoZmlyc3RPckxhc3QsICI6ICRwZXJQYWdlXG4gICAgICAgICIpLmNvbmNhdChhZnRlck9yQmVmb3JlID09PSBudWxsID8gJycgOiAiIi5jb25jYXQoYWZ0ZXJPckJlZm9yZSwgIjogXCIiKS5jb25jYXQoY3Vyc29yLCAiXCIiKSwgIlxuICAgICAgKSB7XG4gICAgICAgIHRvdGFsQ291bnRcbiAgICAgICAgcGFnZUluZm8ge1xuICAgICAgICAgIGVuZEN1cnNvclxuICAgICAgICAgIHN0YXJ0Q3Vyc29yXG4gICAgICAgIH1cbiAgICAgICAgbm9kZXMge1xuICAgICAgICAgIGlkXG4gICAgICAgICAgYm9keVxuICAgICAgICAgIGJvZHlIVE1MXG4gICAgICAgICAgY3JlYXRlZEF0XG4gICAgICAgICAgdXBkYXRlZEF0XG4gICAgICAgICAgYXV0aG9yIHtcbiAgICAgICAgICAgIGF2YXRhclVybFxuICAgICAgICAgICAgbG9naW5cbiAgICAgICAgICAgIHVybFxuICAgICAgICAgIH1cbiAgICAgICAgICByZWFjdGlvbkdyb3VwcyB7XG4gICAgICAgICAgICB1c2VycyAoZmlyc3Q6IDApIHtcbiAgICAgICAgICAgICAgdG90YWxDb3VudFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGVudFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufSIpCiAgICAgICAgICAgICAgICB9LCBvcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zNiA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvczYuZGF0YTsKICAgICAgICAgICAgICAgIGNvbW1lbnRzID0gZGF0YS5kYXRhLnJlcG9zaXRvcnkuaXNzdWUuY29tbWVudHM7CgogICAgICAgICAgICAgICAgaWYgKHNvcnQgPT09ICdkZXNjJykgewogICAgICAgICAgICAgICAgICBjb21tZW50cy5ub2Rlcy5yZXZlcnNlKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy5fcGFnZUluZm8gPSB7CiAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsCiAgICAgICAgICAgICAgICAgIHN0YXJ0Q3Vyc29yOiBjb21tZW50cy5wYWdlSW5mby5zdGFydEN1cnNvciwKICAgICAgICAgICAgICAgICAgZW5kQ3Vyc29yOiBjb21tZW50cy5wYWdlSW5mby5lbmRDdXJzb3IsCiAgICAgICAgICAgICAgICAgIHNvcnQ6IHNvcnQsCiAgICAgICAgICAgICAgICAgIHBlclBhZ2U6IHBlclBhZ2UKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgewogICAgICAgICAgICAgICAgICBjb3VudDogY29tbWVudHMudG90YWxDb3VudCwKICAgICAgICAgICAgICAgICAgcGFnZTogcGFnZSwKICAgICAgICAgICAgICAgICAgcGVyUGFnZTogcGVyUGFnZSwKICAgICAgICAgICAgICAgICAgZGF0YTogY29tbWVudHMubm9kZXMubWFwKG5vcm1hbGl6ZUNvbW1lbnQpCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldENvbW1lbnRzKF94NSkgewogICAgICAgIHJldHVybiBfZ2V0Q29tbWVudHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldENvbW1lbnRzOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L211dGF0aW9uL2FkZGNvbW1lbnQvCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvaW5wdXRfb2JqZWN0L2FkZGNvbW1lbnRpbnB1dC8KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwb3N0Q29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RDb21tZW50ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhfcmVmNykgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgY29udGVudCwgX3lpZWxkJHRoaXMkJGh0dHAkcG9zNywgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjcuYWNjZXNzVG9rZW4sIGNvbnRlbnQgPSBfcmVmNy5jb250ZW50OwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgiZ3JhcGhxbCIsIHsKICAgICAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICAgICAgLy8gcG9zdENvbW1lbnQgbmVlZHMgaXNzdWUgTm9kZUlkLCBzbyB3ZSBzdG9yZSBpdCBpbnRlcm5hbGx5CiAgICAgICAgICAgICAgICAgICAgaXNzdWVOb2RlSWQ6IHRoaXMuX2lzc3VlTm9kZUlkLAogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvbnRlbnQKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcXVlcnk6ICJtdXRhdGlvbiBwb3N0Q29tbWVudChcbiAgJGlzc3VlTm9kZUlkOiBJRCFcbiAgJGNvbnRlbnQ6IFN0cmluZyFcbikge1xuICBhZGRDb21tZW50KFxuICAgIGlucHV0OiB7XG4gICAgICBzdWJqZWN0SWQ6ICRpc3N1ZU5vZGVJZFxuICAgICAgYm9keTogJGNvbnRlbnRcbiAgICB9XG4gICkge1xuICAgIGNvbW1lbnRFZGdlIHtcbiAgICAgIG5vZGUge1xuICAgICAgICBpZFxuICAgICAgICBib2R5XG4gICAgICAgIGJvZHlIVE1MXG4gICAgICAgIGNyZWF0ZWRBdFxuICAgICAgICB1cGRhdGVkQXRcbiAgICAgICAgYXV0aG9yIHtcbiAgICAgICAgICBhdmF0YXJVcmxcbiAgICAgICAgICBsb2dpblxuICAgICAgICAgIHVybFxuICAgICAgICB9XG4gICAgICAgIHJlYWN0aW9uR3JvdXBzIHtcbiAgICAgICAgICB1c2VycyAoZmlyc3Q6IDApIHtcbiAgICAgICAgICAgIHRvdGFsQ291bnRcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGVudFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59IgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogInRva2VuICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zNyA9IF9jb250ZXh0Ny5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvczcuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVDb21tZW50KGRhdGEuZGF0YS5hZGRDb21tZW50LmNvbW1lbnRFZGdlLm5vZGUpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcG9zdENvbW1lbnQoX3g2KSB7CiAgICAgICAgcmV0dXJuIF9wb3N0Q29tbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcG9zdENvbW1lbnQ7CiAgICB9KCkKICAgIC8qKgogICAgICogRWRpdCBhIGNvbW1lbnQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vdjQvbXV0YXRpb24vdXBkYXRlaXNzdWVjb21tZW50LwogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L2lucHV0X29iamVjdC91cGRhdGVpc3N1ZWNvbW1lbnRpbnB1dC8KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwdXRDb21tZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcHV0Q29tbWVudCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTgoX3JlZjgpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGNvbW1lbnRJZCwgY29udGVudCwgX3lpZWxkJHRoaXMkJGh0dHAkcG9zOCwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjguYWNjZXNzVG9rZW4sIGNvbW1lbnRJZCA9IF9yZWY4LmNvbW1lbnRJZCwgY29udGVudCA9IF9yZWY4LmNvbnRlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCJncmFwaHFsIiwgewogICAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICAgICAgICBjb21tZW50SWQ6IGNvbW1lbnRJZCwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAibXV0YXRpb24gcHV0Q29tbWVudChcbiAgJGNvbW1lbnRJZDogSUQhLFxuICAkY29udGVudDogU3RyaW5nISxcbikge1xuICB1cGRhdGVJc3N1ZUNvbW1lbnQoaW5wdXQ6IHtcbiAgICBpZDogJGNvbW1lbnRJZFxuICAgIGJvZHk6ICRjb250ZW50XG4gIH0pIHtcbiAgICBpc3N1ZUNvbW1lbnQge1xuICAgICAgaWRcbiAgICAgIGJvZHlcbiAgICAgIGJvZHlIVE1MXG4gICAgICBjcmVhdGVkQXRcbiAgICAgIHVwZGF0ZWRBdFxuICAgICAgYXV0aG9yIHtcbiAgICAgICAgYXZhdGFyVXJsXG4gICAgICAgIGxvZ2luXG4gICAgICAgIHVybFxuICAgICAgfVxuICAgICAgcmVhY3Rpb25Hcm91cHMge1xuICAgICAgICB1c2VycyAoZmlyc3Q6IDApIHtcbiAgICAgICAgICB0b3RhbENvdW50XG4gICAgICAgIH1cbiAgICAgICAgY29udGVudFxuICAgICAgfVxuICAgIH1cbiAgfVxufSIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJHBvczggPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3M4LmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplQ29tbWVudChkYXRhLmRhdGEudXBkYXRlSXNzdWVDb21tZW50Lmlzc3VlQ29tbWVudCkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwdXRDb21tZW50KF94NykgewogICAgICAgIHJldHVybiBfcHV0Q29tbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcHV0Q29tbWVudDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBEZWxldGUgYSBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RldmVsb3Blci5naXRodWIuY29tL3Y0L211dGF0aW9uL2RlbGV0ZWlzc3VlY29tbWVudC8KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZWxldGVDb21tZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZGVsZXRlQ29tbWVudCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoX3JlZjkpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGNvbW1lbnRJZDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmOS5hY2Nlc3NUb2tlbiwgY29tbWVudElkID0gX3JlZjkuY29tbWVudElkOwogICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAucG9zdCgiZ3JhcGhxbCIsIHsKICAgICAgICAgICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgICAgICAgICAgY29tbWVudElkOiBjb21tZW50SWQKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcXVlcnk6ICJtdXRhdGlvbiBkZWxldGVDb21tZW50KFxuICAkY29tbWVudElkOiBJRCEsXG4pIHtcbiAgZGVsZXRlSXNzdWVDb21tZW50KGlucHV0OiB7XG4gICAgaWQ6ICRjb21tZW50SWRcbiAgfSkge1xuICAgIGNsaWVudE11dGF0aW9uSWRcbiAgfVxufSIKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJ0b2tlbiAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU5LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZGVsZXRlQ29tbWVudChfeDgpIHsKICAgICAgICByZXR1cm4gX2RlbGV0ZUNvbW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRlbGV0ZUNvbW1lbnQ7CiAgICB9KCkKICAgIC8qKgogICAgICogR2V0IHJlYWN0aW9ucyBvZiBhIGNvbW1lbnQKICAgICAqCiAgICAgKiBAcmVtYXJrcwogICAgICogVGhpcyBxdWVyeSBoYXMgbm90IGJlZW4gaW1wbGVtZW50ZWQsIHVzZSB0aGUgY29tbWVudHMgcXVlcnkgaW5zdGVhZAogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENvbW1lbnRSZWFjdGlvbnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRDb21tZW50UmVhY3Rpb25zID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoX3JlZjEwKSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBjb21tZW50SWQsIF90aGlzJF9nZXRRdWVyeVBhcmFtczIsIGZpcnN0T3JMYXN0LCBhZnRlck9yQmVmb3JlLCBjdXJzb3IsIF95aWVsZCR0aGlzJCRodHRwJHBvczksIGRhdGEsIGNvbW1lbnQ7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmMTAuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmMTAuaXNzdWVJZCwgY29tbWVudElkID0gX3JlZjEwLmNvbW1lbnRJZDsKICAgICAgICAgICAgICAgIF90aGlzJF9nZXRRdWVyeVBhcmFtczIgPSB0aGlzLl9nZXRRdWVyeVBhcmFtcygpLCBmaXJzdE9yTGFzdCA9IF90aGlzJF9nZXRRdWVyeVBhcmFtczIuZmlyc3RPckxhc3QsIGFmdGVyT3JCZWZvcmUgPSBfdGhpcyRfZ2V0UXVlcnlQYXJhbXMyLmFmdGVyT3JCZWZvcmUsIGN1cnNvciA9IF90aGlzJF9nZXRRdWVyeVBhcmFtczIuY3Vyc29yOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoImdyYXBocWwiLCB7CiAgICAgICAgICAgICAgICAgIHZhcmlhYmxlczogewogICAgICAgICAgICAgICAgICAgIG93bmVyOiB0aGlzLm93bmVyLAogICAgICAgICAgICAgICAgICAgIHJlcG86IHRoaXMucmVwbywKICAgICAgICAgICAgICAgICAgICBpc3N1ZUlkOiBpc3N1ZUlkLAogICAgICAgICAgICAgICAgICAgIHBlclBhZ2U6IHRoaXMuX3BhZ2VJbmZvLnBlclBhZ2UKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcXVlcnk6ICJxdWVyeSBnZXRDb21tZW50cyhcbiAgJG93bmVyOiBTdHJpbmchXG4gICRyZXBvOiBTdHJpbmchXG4gICRpc3N1ZUlkOiBJbnQhXG4gICRwZXJQYWdlOiBJbnQhXG4pIHtcbiAgcmVwb3NpdG9yeShvd25lcjogJG93bmVyLCBuYW1lOiAkcmVwbykge1xuICAgIGlzc3VlKG51bWJlcjogJGlzc3VlSWQpIHtcbiAgICAgIGNvbW1lbnRzKFxuICAgICAgICAiLmNvbmNhdChmaXJzdE9yTGFzdCwgIjogJHBlclBhZ2VcbiAgICAgICAgIikuY29uY2F0KGFmdGVyT3JCZWZvcmUgPT09IG51bGwgPyAnJyA6ICIiLmNvbmNhdChhZnRlck9yQmVmb3JlLCAiOiBcIiIpLmNvbmNhdChjdXJzb3IsICJcIiIpLCAiXG4gICAgICApIHtcbiAgICAgICAgbm9kZXMge1xuICAgICAgICAgIGlkXG4gICAgICAgICAgcmVhY3Rpb25Hcm91cHMge1xuICAgICAgICAgICAgdXNlcnMgKGZpcnN0OiAwKSB7XG4gICAgICAgICAgICAgIHRvdGFsQ291bnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRlbnRcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iKQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogInRva2VuICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zOSA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwb3M5LmRhdGE7CiAgICAgICAgICAgICAgICBjb21tZW50ID0gZGF0YS5kYXRhLnJlcG9zaXRvcnkuaXNzdWUuY29tbWVudHMubm9kZXMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5pZCA9PT0gY29tbWVudElkOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZVJlYWN0aW9ucyhjb21tZW50LnJlYWN0aW9uR3JvdXBzKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEwLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0Q29tbWVudFJlYWN0aW9ucyhfeDkpIHsKICAgICAgICByZXR1cm4gX2dldENvbW1lbnRSZWFjdGlvbnMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldENvbW1lbnRSZWFjdGlvbnM7CiAgICB9KCkKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IHJlYWN0aW9uIG9mIGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9tdXRhdGlvbi9hZGRyZWFjdGlvbi8KICAgICAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0aHViLmNvbS92NC9pbnB1dF9vYmplY3QvYWRkcmVhY3Rpb25pbnB1dC8KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwb3N0Q29tbWVudFJlYWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcG9zdENvbW1lbnRSZWFjdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKF9yZWYxMSkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgY29tbWVudElkLCByZWFjdGlvbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTExJChfY29udGV4dDExKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTEucHJldiA9IF9jb250ZXh0MTEubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjExLmFjY2Vzc1Rva2VuLCBjb21tZW50SWQgPSBfcmVmMTEuY29tbWVudElkLCByZWFjdGlvbiA9IF9yZWYxMS5yZWFjdGlvbjsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTEubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5wb3N0KCJncmFwaHFsIiwgewogICAgICAgICAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgICAgICAgICBjb21tZW50SWQ6IGNvbW1lbnRJZCwKICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBtYXBSZWFjdGlvbk5hbWUocmVhY3Rpb24pCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHF1ZXJ5OiAibXV0YXRpb24gcG9zdENvbW1lbnRSZWFjdGlvbihcbiAgJGNvbW1lbnRJZDogSUQhLFxuICAkY29udGVudDogUmVhY3Rpb25Db250ZW50ISxcbikge1xuICBhZGRSZWFjdGlvbihpbnB1dDoge1xuICAgIHN1YmplY3RJZDogJGNvbW1lbnRJZFxuICAgIGNvbnRlbnQ6ICRjb250ZW50XG4gIH0pIHtcbiAgICByZWFjdGlvbiB7XG4gICAgICBkYXRhYmFzZUlkXG4gICAgfVxuICB9XG59IgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogInRva2VuICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCB0cnVlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTEsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwb3N0Q29tbWVudFJlYWN0aW9uKF94MTApIHsKICAgICAgICByZXR1cm4gX3Bvc3RDb21tZW50UmVhY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvc3RDb21tZW50UmVhY3Rpb247CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJfZ2V0UXVlcnlQYXJhbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRRdWVyeVBhcmFtcygpIHsKICAgICAgdmFyIF9yZWYxMiA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge30sCiAgICAgICAgICBfcmVmMTIkcGFnZSA9IF9yZWYxMi5wYWdlLAogICAgICAgICAgcGFnZSA9IF9yZWYxMiRwYWdlID09PSB2b2lkIDAgPyB0aGlzLl9wYWdlSW5mby5wYWdlIDogX3JlZjEyJHBhZ2UsCiAgICAgICAgICBfcmVmMTIkc29ydCA9IF9yZWYxMi5zb3J0LAogICAgICAgICAgc29ydCA9IF9yZWYxMiRzb3J0ID09PSB2b2lkIDAgPyB0aGlzLl9wYWdlSW5mby5zb3J0IDogX3JlZjEyJHNvcnQ7CgogICAgICB2YXIgZmlyc3RPckxhc3Q7CiAgICAgIHZhciBhZnRlck9yQmVmb3JlOwogICAgICB2YXIgY3Vyc29yOwoKICAgICAgaWYgKHBhZ2UgPT09IDEpIHsKICAgICAgICBmaXJzdE9yTGFzdCA9IHNvcnQgPT09ICdhc2MnID8gJ2ZpcnN0JyA6ICdsYXN0JzsKICAgICAgICBhZnRlck9yQmVmb3JlID0gbnVsbDsKICAgICAgICBjdXJzb3IgPSBudWxsOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChzb3J0ID09PSAnYXNjJykgewogICAgICAgICAgaWYgKHBhZ2UgPiB0aGlzLl9wYWdlSW5mby5wYWdlKSB7CiAgICAgICAgICAgIGZpcnN0T3JMYXN0ID0gJ2ZpcnN0JzsKICAgICAgICAgICAgYWZ0ZXJPckJlZm9yZSA9ICdhZnRlcic7CiAgICAgICAgICAgIGN1cnNvciA9IHRoaXMuX3BhZ2VJbmZvLmVuZEN1cnNvcjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZpcnN0T3JMYXN0ID0gJ2xhc3QnOwogICAgICAgICAgICBhZnRlck9yQmVmb3JlID0gJ2JlZm9yZSc7CiAgICAgICAgICAgIGN1cnNvciA9IHRoaXMuX3BhZ2VJbmZvLnN0YXJ0Q3Vyc29yOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAocGFnZSA+IHRoaXMuX3BhZ2VJbmZvLnBhZ2UpIHsKICAgICAgICAgICAgZmlyc3RPckxhc3QgPSAnbGFzdCc7CiAgICAgICAgICAgIGFmdGVyT3JCZWZvcmUgPSAnYmVmb3JlJzsKICAgICAgICAgICAgY3Vyc29yID0gdGhpcy5fcGFnZUluZm8uc3RhcnRDdXJzb3I7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmaXJzdE9yTGFzdCA9ICdmaXJzdCc7CiAgICAgICAgICAgIGFmdGVyT3JCZWZvcmUgPSAnYWZ0ZXInOwogICAgICAgICAgICBjdXJzb3IgPSB0aGlzLl9wYWdlSW5mby5lbmRDdXJzb3I7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGZpcnN0T3JMYXN0OiBmaXJzdE9yTGFzdCwKICAgICAgICBhZnRlck9yQmVmb3JlOiBhZnRlck9yQmVmb3JlLAogICAgICAgIGN1cnNvcjogY3Vyc29yCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAicGxhdGZvcm0iLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgbmFtZTogJ0dpdEh1YicsCiAgICAgICAgbGluazogdGhpcy5iYXNlVVJMLAogICAgICAgIHZlcnNpb246ICd2NCcsCiAgICAgICAgbWV0YTogewogICAgICAgICAgcmVhY3RhYmxlOiB0cnVlLAogICAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfV0pOwoKICByZXR1cm4gR2l0aHViVjQ7Cn0oKTsKCmV4cG9ydCB7IEdpdGh1YlY0IGFzIGRlZmF1bHQgfTs="},null]}