{"remainingRequest":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/babel-loader/lib/index.js??ref--3-1!/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/valine/dist/Valine.min.js","dependencies":[{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/valine/dist/Valine.min.js","mtime":1603118175375},{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/cache-loader/dist/cjs.js","mtime":1603041438982},{"path":"/opt/myblog/vuepress-theme-reco-master/zdblog/node_modules/babel-loader/lib/index.js","mtime":1603041438713}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5kZXNjcmlwdGlvbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5hc3luYy1pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC50by1zdHJpbmctdGFnIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pcy1hcnJheSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5yZXZlcnNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zcGxpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuY29uc3RydWN0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuc2xpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5kYXRhLXZpZXciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLm5vdyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24uYmluZCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnRvLXN0cmluZy10YWciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5tYXAiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5tYXRoLnRvLXN0cmluZy10YWciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuY3JlYXRlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1uYW1lcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtcHJvdG90eXBlLW9mIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMucGFyc2UtZmxvYXQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5wYXJzZS1pbnQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuY29uc3RydWN0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zZXQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2giKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0tZW5kIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmxpbmsiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mbG9hdDMyLWFycmF5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmxvYXQ2NC1hcnJheSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmludDgtYXJyYXkiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbnQxNi1hcnJheSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmludDMyLWFycmF5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDgtYXJyYXkiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1jbGFtcGVkLWFycmF5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDE2LWFycmF5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDMyLWFycmF5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuY29weS13aXRoaW4iKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5ldmVyeSIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbGwiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWx0ZXIiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC1pbmRleCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5jbHVkZXMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmRleC1vZiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lml0ZXJhdG9yIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuam9pbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lmxhc3QtaW5kZXgtb2YiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5tYXAiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UtcmlnaHQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZXZlcnNlIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2V0Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2xpY2UiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb21lIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29ydCIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnN1YmFycmF5Iik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tbG9jYWxlLXN0cmluZyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLXN0cmluZyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLndlYWstbWFwIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMud2Vhay1zZXQiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIudXJsIik7Cgp2YXIgX3R5cGVvZiA9IHJlcXVpcmUoIi9vcHQvbXlibG9nL3Z1ZXByZXNzLXRoZW1lLXJlY28tbWFzdGVyL3pkYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90eXBlb2YiKTsKCi8qIQogKiBWYWxpbmUgdjEuNC4xNAogKiAoYykgMjAxNy0yMDIwIHhDc3MKICogUmVsZWFzZWQgdW5kZXIgdGhlIEdQTC0yLjAgTGljZW5zZS4KICogTGFzdCBVcGRhdGU6IDIwMjAvNC8yNiDkuIvljYg4OjM5OjA4CiAqLwohZnVuY3Rpb24gKGUsIHQpIHsKICAib2JqZWN0IiA9PSAodHlwZW9mIGV4cG9ydHMgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGV4cG9ydHMpKSAmJiAib2JqZWN0IiA9PSAodHlwZW9mIG1vZHVsZSA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YobW9kdWxlKSkgPyBtb2R1bGUuZXhwb3J0cyA9IHQoKSA6ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFtdLCB0KSA6ICJvYmplY3QiID09ICh0eXBlb2YgZXhwb3J0cyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoZXhwb3J0cykpID8gZXhwb3J0cy5WYWxpbmUgPSB0KCkgOiBlLlZhbGluZSA9IHQoKTsKfSh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7CiAgICBmdW5jdGlvbiB0KHIpIHsKICAgICAgaWYgKG5bcl0pIHJldHVybiBuW3JdLmV4cG9ydHM7CiAgICAgIHZhciBvID0gbltyXSA9IHsKICAgICAgICBpOiByLAogICAgICAgIGw6ICExLAogICAgICAgIGV4cG9ydHM6IHt9CiAgICAgIH07CiAgICAgIHJldHVybiBlW3JdLmNhbGwoby5leHBvcnRzLCBvLCBvLmV4cG9ydHMsIHQpLCBvLmwgPSAhMCwgby5leHBvcnRzOwogICAgfQoKICAgIHZhciBuID0ge307CiAgICByZXR1cm4gdC5tID0gZSwgdC5jID0gbiwgdC5pID0gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGU7CiAgICB9LCB0LmQgPSBmdW5jdGlvbiAoZSwgbiwgcikgewogICAgICB0Lm8oZSwgbikgfHwgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIG4sIHsKICAgICAgICBjb25maWd1cmFibGU6ICExLAogICAgICAgIGVudW1lcmFibGU6ICEwLAogICAgICAgIGdldDogcgogICAgICB9KTsKICAgIH0sIHQubiA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBuID0gZSAmJiBlLl9fZXNNb2R1bGUgPyBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGVbImRlZmF1bHQiXTsKICAgICAgfSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZTsKICAgICAgfTsKICAgICAgcmV0dXJuIHQuZChuLCAiYSIsIG4pLCBuOwogICAgfSwgdC5vID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLCB0KTsKICAgIH0sIHQucCA9ICIiLCB0KHQucyA9IDYzKTsKICB9KFtmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogewogICAgICAgICJkZWZhdWx0IjogZQogICAgICB9OwogICAgfQoKICAgIHQuX19lc01vZHVsZSA9ICEwOwogICAgdmFyIG8gPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihTeW1ib2wuaXRlcmF0b3IpID8gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIF90eXBlb2YoZSk7CiAgICB9IDogZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIGUuY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBlICE9PSBTeW1ib2wucHJvdG90eXBlID8gInN5bWJvbCIgOiBfdHlwZW9mKGUpOwogICAgfSwKICAgICAgICBpID0gbigzOCksCiAgICAgICAgYSA9IHIoaSksCiAgICAgICAgcyA9IG4oMjgpLAogICAgICAgIGwgPSByKHMpLAogICAgICAgIGMgPSBuKDI3KSwKICAgICAgICB1ID0gcihjKSwKICAgICAgICBkID0gbig0MiksCiAgICAgICAgcCA9IHIoZCksCiAgICAgICAgZiA9IGRvY3VtZW50LAogICAgICAgIGggPSBuYXZpZ2F0b3IsCiAgICAgICAgdiA9IC9bJjw+IidgXFxdL2csCiAgICAgICAgZyA9IFJlZ0V4cCh2LnNvdXJjZSksCiAgICAgICAgbSA9IC8mKD86YW1wfGx0fGd0fHF1b3R8IzM5fCN4NjB8I3g1Yyk7L2csCiAgICAgICAgeSA9IFJlZ0V4cChtLnNvdXJjZSksCiAgICAgICAgYiA9IHsKICAgICAgIiYiOiAiJmFtcDsiLAogICAgICAiPCI6ICImbHQ7IiwKICAgICAgIj4iOiAiJmd0OyIsCiAgICAgICciJzogIiZxdW90OyIsCiAgICAgICInIjogIiYjMzk7IiwKICAgICAgImAiOiAiJiN4NjA7IiwKICAgICAgIlxcIjogIiYjeDVjOyIKICAgIH0sCiAgICAgICAgdyA9IHt9OwoKICAgIGZvciAodmFyIHggaW4gYikgewogICAgICB3W2JbeF1dID0geDsKICAgIH0KCiAgICB2YXIgayA9IG51bGw7CiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCB8fCAoQXJyYXkucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICB2YXIgbiwgcjsKICAgICAgaWYgKG51bGwgPT0gdGhpcykgdGhyb3cgbmV3IFR5cGVFcnJvcigiIHRoaXMgaXMgbnVsbCBvciBub3QgZGVmaW5lZCIpOwogICAgICB2YXIgbyA9IE9iamVjdCh0aGlzKSwKICAgICAgICAgIGkgPSBvLmxlbmd0aCA+Pj4gMDsKICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoZSArICIgaXMgbm90IGEgZnVuY3Rpb24iKTsKCiAgICAgIGZvciAoYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgKG4gPSB0KSwgciA9IDA7IHIgPCBpOykgewogICAgICAgIHZhciBhOwogICAgICAgIHIgaW4gbyAmJiAoYSA9IG9bcl0sIGUuY2FsbChuLCBhLCByLCBvKSksIHIrKzsKICAgICAgfQogICAgfSksIHdpbmRvdy5Ob2RlTGlzdCAmJiAhTm9kZUxpc3QucHJvdG90eXBlLmZvckVhY2ggJiYgKE5vZGVMaXN0LnByb3RvdHlwZS5mb3JFYWNoID0gQXJyYXkucHJvdG90eXBlLmZvckVhY2gpLCBTdHJpbmcucHJvdG90eXBlLnRyaW0gfHwgKFN0cmluZy5wcm90b3R5cGUudHJpbSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXltcc1x1RkVGRlx4QTBdK3xbXHNcdUZFRkZceEEwXSskL2csICIiKTsKICAgIH0pLCAoMCwgYVsiZGVmYXVsdCJdKShsWyJkZWZhdWx0Il0uZm4sIHsKICAgICAgcHJlcGVuZDogZnVuY3Rpb24gcHJlcGVuZChlKSB7CiAgICAgICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCB8fCAoZSA9IGVbMF0pLCB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCJhZnRlckJlZ2luIiwgZSk7CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIGFwcGVuZDogZnVuY3Rpb24gYXBwZW5kKGUpIHsKICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50IHx8IChlID0gZVswXSksIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgdC5pbnNlcnRBZGphY2VudEVsZW1lbnQoImJlZm9yZUVuZCIsIGUpOwogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7fQogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICBmaW5kOiBmdW5jdGlvbiBmaW5kKGUpIHsKICAgICAgICByZXR1cm4gKDAsIGxbImRlZmF1bHQiXSkoZSwgdGhpcyk7CiAgICAgIH0sCiAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgZS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgICB9KSwgdGhpczsKICAgICAgfSwKICAgICAgaGlkZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBlLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIG9uOiBmdW5jdGlvbiBvbihlLCB0LCBuKSB7CiAgICAgICAgcmV0dXJuIGxbImRlZmF1bHQiXS5mbi5vZmYoZSwgdCwgbiksIHRoaXMuZm9yRWFjaChmdW5jdGlvbiAocikgewogICAgICAgICAgZS5zcGxpdCgiICIpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgci5hZGRFdmVudExpc3RlbmVyID8gci5hZGRFdmVudExpc3RlbmVyKGUsIHQsIG4gfHwgITEpIDogci5hdHRhY2hFdmVudCA/IHIuYXR0YWNoRXZlbnQoIm9uIiArIGUsIHQpIDogclsib24iICsgZV0gPSB0OwogICAgICAgICAgfSk7CiAgICAgICAgfSksIHRoaXM7CiAgICAgIH0sCiAgICAgIG9mZjogZnVuY3Rpb24gb2ZmKGUsIHQsIG4pIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICBlLnNwbGl0KCIgIikuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByLnJlbW92ZUV2ZW50TGlzdGVuZXIgPyByLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSwgdCwgbiB8fCAhMSkgOiByLmRldGFjaEV2ZW50ID8gci5kZXRhY2hFdmVudCgib24iICsgZSwgdCkgOiByWyJvbiIgKyBlXSA9IG51bGw7CiAgICAgICAgICB9KTsKICAgICAgICB9KSwgdGhpczsKICAgICAgfSwKICAgICAgaHRtbDogZnVuY3Rpb24gaHRtbChlKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZSA/ICh0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHQuaW5uZXJIVE1MID0gZTsKICAgICAgICB9KSwgdGhpcykgOiB0aGlzWzBdLmlubmVySFRNTDsKICAgICAgfSwKICAgICAgdGV4dDogZnVuY3Rpb24gdGV4dChlKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gZSA/ICh0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHQuaW5uZXJUZXh0ID0gZTsKICAgICAgICB9KSwgdGhpcykgOiB0aGlzWzBdLmlubmVyVGV4dDsKICAgICAgfSwKICAgICAgZW1wdHk6IGZ1bmN0aW9uIGVtcHR5KGUpIHsKICAgICAgICByZXR1cm4gZSA9IGUgfHwgMCwgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHQuaW5uZXJUZXh0ID0gIiI7CiAgICAgICAgICB9LCBlKTsKICAgICAgICB9KSwgdGhpczsKICAgICAgfSwKICAgICAgdmFsOiBmdW5jdGlvbiB2YWwoZSkgewogICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgPyAodGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB0LnZhbHVlID0gZTsKICAgICAgICB9KSwgdGhpcykgOiB0aGlzWzBdLnZhbHVlIHx8ICIiOwogICAgICB9LAogICAgICBhdHRyOiBmdW5jdGlvbiBhdHRyKCkgewogICAgICAgIHZhciBlID0gYXJndW1lbnRzOwoKICAgICAgICBpZiAoIm9iamVjdCIgPT0gbyhhcmd1bWVudHNbMF0pKSB7CiAgICAgICAgICB2YXIgdCA9IGFyZ3VtZW50c1swXSwKICAgICAgICAgICAgICBuID0gdGhpczsKICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIG4uZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgICAgICAgIG4uc2V0QXR0cmlidXRlKGUsIHRbZV0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pLCB0aGlzOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICJzdHJpbmciID09IHR5cGVvZiBhcmd1bWVudHNbMF0gJiYgYXJndW1lbnRzLmxlbmd0aCA8IDIgPyB0aGlzWzBdLmdldEF0dHJpYnV0ZShhcmd1bWVudHNbMF0pIHx8ICIiIDogKHRoaXMuZm9yRWFjaChmdW5jdGlvbiAodCkgewogICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoZVswXSwgZVsxXSk7CiAgICAgICAgfSksIHRoaXMpOwogICAgICB9LAogICAgICByZW1vdmVBdHRyOiBmdW5jdGlvbiByZW1vdmVBdHRyKGUpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB2YXIgbiwKICAgICAgICAgICAgICByID0gMCwKICAgICAgICAgICAgICBvID0gZSAmJiBlLm1hdGNoKC9bXlx4MjBcdFxyXG5cZlwqXC9cXF0rL2cpOwogICAgICAgICAgaWYgKG8gJiYgMSA9PT0gdC5ub2RlVHlwZSkgZm9yICg7IG4gPSBvW3IrK107KSB7CiAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKG4pOwogICAgICAgICAgfQogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICBoYXNDbGFzczogZnVuY3Rpb24gaGFzQ2xhc3MoZSkgewogICAgICAgIHJldHVybiAhIXRoaXNbMF0gJiYgbmV3IFJlZ0V4cCgiKFxcc3xeKSIgKyBlICsgIihcXHN8JCkiKS50ZXN0KHRoaXNbMF0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpKTsKICAgICAgfSwKICAgICAgYWRkQ2xhc3M6IGZ1bmN0aW9uIGFkZENsYXNzKGUpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB2YXIgbiA9ICgwLCBsWyJkZWZhdWx0Il0pKHQpLAogICAgICAgICAgICAgIHIgPSBuLmF0dHIoImNsYXNzIik7CiAgICAgICAgICBuLmhhc0NsYXNzKGUpIHx8IG4uYXR0cigiY2xhc3MiLCByICs9ICIgIiArIGUpOwogICAgICAgIH0pLCB0aGlzOwogICAgICB9LAogICAgICByZW1vdmVDbGFzczogZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZSkgewogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIHZhciBuID0gKDAsIGxbImRlZmF1bHQiXSkodCksCiAgICAgICAgICAgICAgciA9IG4uYXR0cigiY2xhc3MiKTsKCiAgICAgICAgICBpZiAobi5oYXNDbGFzcyhlKSkgewogICAgICAgICAgICB2YXIgbyA9IG5ldyBSZWdFeHAoIihcXHN8XikiICsgZSArICIoXFxzfCQpIik7CiAgICAgICAgICAgIG4uYXR0cigiY2xhc3MiLCByLnJlcGxhY2UobywgIiIpKTsKICAgICAgICAgIH0KICAgICAgICB9KSwgdGhpczsKICAgICAgfQogICAgfSksICgwLCBhWyJkZWZhdWx0Il0pKGxbImRlZmF1bHQiXSwgewogICAgICBleHRlbmQ6IGFbImRlZmF1bHQiXSwKICAgICAgbm9vcDogZnVuY3Rpb24gbm9vcCgpIHt9LAogICAgICBuYXZpOiBoLAogICAgICB1YTogaC51c2VyQWdlbnQsCiAgICAgIGxhbmc6IGgubGFuZ3VhZ2UgfHwgaC5sYW5ndWFnZXNbMF0sCiAgICAgIGRldGVjdDogdVsiZGVmYXVsdCJdLAogICAgICBzdG9yZTogcFsiZGVmYXVsdCJdLAogICAgICBlc2NhcGU6IGZ1bmN0aW9uIGVzY2FwZShlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgZy50ZXN0KGUpID8gZS5yZXBsYWNlKHYsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gYltlXTsKICAgICAgICB9KSA6IGU7CiAgICAgIH0sCiAgICAgIHVuZXNjYXBlOiBmdW5jdGlvbiB1bmVzY2FwZShlKSB7CiAgICAgICAgcmV0dXJuIGUgJiYgeS50ZXN0KGUpID8gZS5yZXBsYWNlKG0sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gd1tlXTsKICAgICAgICB9KSA6IGU7CiAgICAgIH0sCiAgICAgIGR5bmFtaWNMb2FkU291cmNlOiBmdW5jdGlvbiBkeW5hbWljTG9hZFNvdXJjZShlLCB0KSB7CiAgICAgICAgaWYgKCgwLCBsWyJkZWZhdWx0Il0pKCdzY3JpcHRbc3JjPSInICsgZSArICciXScpLmxlbmd0aCkgdCAmJiB0KCk7ZWxzZSB7CiAgICAgICAgICB2YXIgbiA9IGYuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7CiAgICAgICAgICBuLm9ubG9hZCA9IG4ub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgICAgIGUub25sb2FkID0gZS5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsLCB0ICYmIHQoKSwgKDAsIGxbImRlZmF1bHQiXSkobikucmVtb3ZlKCk7CiAgICAgICAgICB9LCBuLmFzeW5jID0gITAsIG4uc2V0QXR0cmlidXRlKCJyZWZlcnJlclBvbGljeSIsICJuby1yZWZlcnJlciIpOwogICAgICAgICAgKDAsIGxbImRlZmF1bHQiXSkoImhlYWQiKVswXS5hcHBlbmRDaGlsZChuKSwgbi5zcmMgPSBlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2RrTG9hZGVyOiBmdW5jdGlvbiBzZGtMb2FkZXIoZSwgdCwgbikgewogICAgICAgIHQgaW4gd2luZG93ICYmIHdpbmRvd1t0XSA/IChrICYmIGNsZWFyVGltZW91dChrKSwgbiAmJiBuKCkpIDogbFsiZGVmYXVsdCJdLmR5bmFtaWNMb2FkU291cmNlKGUsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGsgPSBzZXRUaW1lb3V0KGxbImRlZmF1bHQiXS5zZGtMb2FkZXIoZSwgdCwgbiksIDEwMCk7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGRlbGV0ZUluV2luOiBmdW5jdGlvbiBkZWxldGVJbldpbihlLCB0KSB7CiAgICAgICAgdmFyIG4gPSBmdW5jdGlvbiBuKHQpIHsKICAgICAgICAgIGlmIChlIGluIHdpbmRvdykgdHJ5IHsKICAgICAgICAgICAgZGVsZXRlIHdpbmRvd1tlXTsKICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgd2luZG93W2VdID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICAwID09PSB0ID8gbigpIDogc2V0VGltZW91dChuLCB0IHx8IDUwMCk7CiAgICAgIH0sCiAgICAgIGFqYXg6IGZ1bmN0aW9uIGFqYXgoZSkgewogICAgICAgIGUgPSBlIHx8IHt9LCBlLnR5cGUgPSAoZS50eXBlIHx8ICJHRVQiKS50b1VwcGVyQ2FzZSgpLCBlLmRhdGFUeXBlID0gZS5kYXRhVHlwZSB8fCAianNvbiIsIGUuYXN5bmMgPSBlLmFzeW5jIHx8ICEwLCBlLnRpbWVvdXQgPSBlLnRpbWVvdXQgfHwgOGUzOwogICAgICAgIHZhciB0ID0gIltvYmplY3QgRm9ybURhdGFdIiA9PSB7fS50b1N0cmluZy5jYWxsKGUuZGF0YSkgPyBlLmRhdGEgOiBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHQgPSBbXTsKCiAgICAgICAgICBmb3IgKHZhciBuIGluIGUpIHsKICAgICAgICAgICAgdC5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChuKSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChlW25dKSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHQucHVzaCgidD0iICsgRGF0ZS5ub3coKSksIHQuam9pbigiJiIpOwogICAgICAgIH0oZS5kYXRhKSwKICAgICAgICAgICAgbiA9IG51bGwsCiAgICAgICAgICAgIHIgPSAiWE1MSHR0cFJlcXVlc3QiIGluIHdpbmRvdyA/IG5ldyBYTUxIdHRwUmVxdWVzdCgpIDogbmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIik7CiAgICAgICAgci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgaWYgKDQgPT0gci5yZWFkeVN0YXRlKSB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dChuKTsKICAgICAgICAgICAgdmFyIG8gPSByLnN0YXR1czsKICAgICAgICAgICAgbyA+PSAyMDAgJiYgbyA8IDMwMCA/IGUuc3VjY2VzcyAmJiBlLnN1Y2Nlc3MoSlNPTi5wYXJzZShyLnJlc3BvbnNlVGV4dCkpIDogZS5mYWlsICYmIGUuZmFpbChvKTsKICAgICAgICAgIH0KICAgICAgICB9LCAiR0VUIiA9PSBlLnR5cGUgPyAoci5vcGVuKCJHRVQiLCBlLnVybCArICI/IiArIHQsIGUuYXN5bmMpLCByLnNlbmQobnVsbCkpIDogIlBPU1QiID09IGUudHlwZSAmJiAoci5vcGVuKCJQT1NUIiwgZS51cmwsIGUuYXN5bmMpLCB2b2lkIDAgPT0gZS5jb250ZW50VHlwZSB8fCBudWxsID09IGUuY29udGVudFR5cGUgPyByLnNlbmQodCkgOiAoci5zZXRSZXF1ZXN0SGVhZGVyKCJDb250ZW50LVR5cGUiLCBlLmNvbnRlbnRUeXBlKSwgci5zZW5kKEpTT04uc3RyaW5naWZ5KGUuZGF0YSkpKSksIG4gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQobiksIHIuYWJvcnQoKTsKICAgICAgICB9LCBlLnRpbWVvdXQpOwogICAgICB9CiAgICB9KSwgdFsiZGVmYXVsdCJdID0gbFsiZGVmYXVsdCJdOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBUeXBlRXJyb3IsCiAgICAgICAgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7CiAgICBpZiAobykgdHJ5IHsKICAgICAgbyh7fSwgIiIpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBvID0gbnVsbDsKICAgIH0KCiAgICB2YXIgaSwKICAgICAgICBhLAogICAgICAgIHMgPSBmdW5jdGlvbiBzKCkgewogICAgICB0aHJvdyBuZXcgcigpOwogICAgfSwKICAgICAgICBsID0gbyA/IGZ1bmN0aW9uICgpIHsKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gYXJndW1lbnRzLmNhbGxlZSwgczsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gbyhhcmd1bWVudHMsICJjYWxsZWUiKS5nZXQ7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgcmV0dXJuIHM7CiAgICAgICAgfQogICAgICB9CiAgICB9KCkgOiBzLAogICAgICAgIGMgPSBuKDQ3KSgpLAogICAgICAgIHUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUuX19wcm90b19fOwogICAgfSwKICAgICAgICBkID0gaSA/IHUoaSkgOiB2b2lkIDAsCiAgICAgICAgcCA9IGEgPyB1KGEpIDogdm9pZCAwLAogICAgICAgIGYgPSBhID8gYSgpIDogdm9pZCAwLAogICAgICAgIGggPSAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDhBcnJheSA/IHZvaWQgMCA6IHUoVWludDhBcnJheSksCiAgICAgICAgdiA9IHsKICAgICAgIiVBcnJheSUiOiBBcnJheSwKICAgICAgIiVBcnJheUJ1ZmZlciUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgQXJyYXlCdWZmZXIgPyB2b2lkIDAgOiBBcnJheUJ1ZmZlciwKICAgICAgIiVBcnJheUJ1ZmZlclByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgQXJyYXlCdWZmZXIgPyB2b2lkIDAgOiBBcnJheUJ1ZmZlci5wcm90b3R5cGUsCiAgICAgICIlQXJyYXlJdGVyYXRvclByb3RvdHlwZSUiOiBjID8gdShbXVtTeW1ib2wuaXRlcmF0b3JdKCkpIDogdm9pZCAwLAogICAgICAiJUFycmF5UHJvdG90eXBlJSI6IEFycmF5LnByb3RvdHlwZSwKICAgICAgIiVBcnJheVByb3RvX2VudHJpZXMlIjogQXJyYXkucHJvdG90eXBlLmVudHJpZXMsCiAgICAgICIlQXJyYXlQcm90b19mb3JFYWNoJSI6IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLAogICAgICAiJUFycmF5UHJvdG9fa2V5cyUiOiBBcnJheS5wcm90b3R5cGUua2V5cywKICAgICAgIiVBcnJheVByb3RvX3ZhbHVlcyUiOiBBcnJheS5wcm90b3R5cGUudmFsdWVzLAogICAgICAiJUFzeW5jRnJvbVN5bmNJdGVyYXRvclByb3RvdHlwZSUiOiB2b2lkIDAsCiAgICAgICIlQXN5bmNGdW5jdGlvbiUiOiB2b2lkIDAsCiAgICAgICIlQXN5bmNGdW5jdGlvblByb3RvdHlwZSUiOiB2b2lkIDAsCiAgICAgICIlQXN5bmNHZW5lcmF0b3IlIjogYSA/IHUoZikgOiB2b2lkIDAsCiAgICAgICIlQXN5bmNHZW5lcmF0b3JGdW5jdGlvbiUiOiBwLAogICAgICAiJUFzeW5jR2VuZXJhdG9yUHJvdG90eXBlJSI6IHAgPyBwLnByb3RvdHlwZSA6IHZvaWQgMCwKICAgICAgIiVBc3luY0l0ZXJhdG9yUHJvdG90eXBlJSI6IGYgJiYgYyAmJiBTeW1ib2wuYXN5bmNJdGVyYXRvciA/IGZbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkgOiB2b2lkIDAsCiAgICAgICIlQXRvbWljcyUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgQXRvbWljcyA/IHZvaWQgMCA6IEF0b21pY3MsCiAgICAgICIlQm9vbGVhbiUiOiBCb29sZWFuLAogICAgICAiJUJvb2xlYW5Qcm90b3R5cGUlIjogQm9vbGVhbi5wcm90b3R5cGUsCiAgICAgICIlRGF0YVZpZXclIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIERhdGFWaWV3ID8gdm9pZCAwIDogRGF0YVZpZXcsCiAgICAgICIlRGF0YVZpZXdQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIERhdGFWaWV3ID8gdm9pZCAwIDogRGF0YVZpZXcucHJvdG90eXBlLAogICAgICAiJURhdGUlIjogRGF0ZSwKICAgICAgIiVEYXRlUHJvdG90eXBlJSI6IERhdGUucHJvdG90eXBlLAogICAgICAiJWRlY29kZVVSSSUiOiBkZWNvZGVVUkksCiAgICAgICIlZGVjb2RlVVJJQ29tcG9uZW50JSI6IGRlY29kZVVSSUNvbXBvbmVudCwKICAgICAgIiVlbmNvZGVVUkklIjogZW5jb2RlVVJJLAogICAgICAiJWVuY29kZVVSSUNvbXBvbmVudCUiOiBlbmNvZGVVUklDb21wb25lbnQsCiAgICAgICIlRXJyb3IlIjogRXJyb3IsCiAgICAgICIlRXJyb3JQcm90b3R5cGUlIjogRXJyb3IucHJvdG90eXBlLAogICAgICAiJWV2YWwlIjogZXZhbCwKICAgICAgIiVFdmFsRXJyb3IlIjogRXZhbEVycm9yLAogICAgICAiJUV2YWxFcnJvclByb3RvdHlwZSUiOiBFdmFsRXJyb3IucHJvdG90eXBlLAogICAgICAiJUZsb2F0MzJBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgRmxvYXQzMkFycmF5ID8gdm9pZCAwIDogRmxvYXQzMkFycmF5LAogICAgICAiJUZsb2F0MzJBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgRmxvYXQzMkFycmF5ID8gdm9pZCAwIDogRmxvYXQzMkFycmF5LnByb3RvdHlwZSwKICAgICAgIiVGbG9hdDY0QXJyYXklIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIEZsb2F0NjRBcnJheSA/IHZvaWQgMCA6IEZsb2F0NjRBcnJheSwKICAgICAgIiVGbG9hdDY0QXJyYXlQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIEZsb2F0NjRBcnJheSA/IHZvaWQgMCA6IEZsb2F0NjRBcnJheS5wcm90b3R5cGUsCiAgICAgICIlRnVuY3Rpb24lIjogRnVuY3Rpb24sCiAgICAgICIlRnVuY3Rpb25Qcm90b3R5cGUlIjogRnVuY3Rpb24ucHJvdG90eXBlLAogICAgICAiJUdlbmVyYXRvciUiOiBpID8gdShpKCkpIDogdm9pZCAwLAogICAgICAiJUdlbmVyYXRvckZ1bmN0aW9uJSI6IGQsCiAgICAgICIlR2VuZXJhdG9yUHJvdG90eXBlJSI6IGQgPyBkLnByb3RvdHlwZSA6IHZvaWQgMCwKICAgICAgIiVJbnQ4QXJyYXklIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIEludDhBcnJheSA/IHZvaWQgMCA6IEludDhBcnJheSwKICAgICAgIiVJbnQ4QXJyYXlQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIEludDhBcnJheSA/IHZvaWQgMCA6IEludDhBcnJheS5wcm90b3R5cGUsCiAgICAgICIlSW50MTZBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgSW50MTZBcnJheSA/IHZvaWQgMCA6IEludDE2QXJyYXksCiAgICAgICIlSW50MTZBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgSW50MTZBcnJheSA/IHZvaWQgMCA6IEludDhBcnJheS5wcm90b3R5cGUsCiAgICAgICIlSW50MzJBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgSW50MzJBcnJheSA/IHZvaWQgMCA6IEludDMyQXJyYXksCiAgICAgICIlSW50MzJBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgSW50MzJBcnJheSA/IHZvaWQgMCA6IEludDMyQXJyYXkucHJvdG90eXBlLAogICAgICAiJWlzRmluaXRlJSI6IGlzRmluaXRlLAogICAgICAiJWlzTmFOJSI6IGlzTmFOLAogICAgICAiJUl0ZXJhdG9yUHJvdG90eXBlJSI6IGMgPyB1KHUoW11bU3ltYm9sLml0ZXJhdG9yXSgpKSkgOiB2b2lkIDAsCiAgICAgICIlSlNPTiUiOiAib2JqZWN0IiA9PSAodHlwZW9mIEpTT04gPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKEpTT04pKSA/IEpTT04gOiB2b2lkIDAsCiAgICAgICIlSlNPTlBhcnNlJSI6ICJvYmplY3QiID09ICh0eXBlb2YgSlNPTiA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2YoSlNPTikpID8gSlNPTi5wYXJzZSA6IHZvaWQgMCwKICAgICAgIiVNYXAlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIE1hcCA/IHZvaWQgMCA6IE1hcCwKICAgICAgIiVNYXBJdGVyYXRvclByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgTWFwICYmIGMgPyB1KG5ldyBNYXAoKVtTeW1ib2wuaXRlcmF0b3JdKCkpIDogdm9pZCAwLAogICAgICAiJU1hcFByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgTWFwID8gdm9pZCAwIDogTWFwLnByb3RvdHlwZSwKICAgICAgIiVNYXRoJSI6IE1hdGgsCiAgICAgICIlTnVtYmVyJSI6IE51bWJlciwKICAgICAgIiVOdW1iZXJQcm90b3R5cGUlIjogTnVtYmVyLnByb3RvdHlwZSwKICAgICAgIiVPYmplY3QlIjogT2JqZWN0LAogICAgICAiJU9iamVjdFByb3RvdHlwZSUiOiBPYmplY3QucHJvdG90eXBlLAogICAgICAiJU9ialByb3RvX3RvU3RyaW5nJSI6IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsCiAgICAgICIlT2JqUHJvdG9fdmFsdWVPZiUiOiBPYmplY3QucHJvdG90eXBlLnZhbHVlT2YsCiAgICAgICIlcGFyc2VGbG9hdCUiOiBwYXJzZUZsb2F0LAogICAgICAiJXBhcnNlSW50JSI6IHBhcnNlSW50LAogICAgICAiJVByb21pc2UlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFByb21pc2UgPyB2b2lkIDAgOiBQcm9taXNlLAogICAgICAiJVByb21pc2VQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFByb21pc2UgPyB2b2lkIDAgOiBQcm9taXNlLnByb3RvdHlwZSwKICAgICAgIiVQcm9taXNlUHJvdG9fdGhlbiUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSA/IHZvaWQgMCA6IFByb21pc2UucHJvdG90eXBlLnRoZW4sCiAgICAgICIlUHJvbWlzZV9hbGwlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFByb21pc2UgPyB2b2lkIDAgOiBQcm9taXNlLmFsbCwKICAgICAgIiVQcm9taXNlX3JlamVjdCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSA/IHZvaWQgMCA6IFByb21pc2UucmVqZWN0LAogICAgICAiJVByb21pc2VfcmVzb2x2ZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSA/IHZvaWQgMCA6IFByb21pc2UucmVzb2x2ZSwKICAgICAgIiVQcm94eSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJveHkgPyB2b2lkIDAgOiBQcm94eSwKICAgICAgIiVSYW5nZUVycm9yJSI6IFJhbmdlRXJyb3IsCiAgICAgICIlUmFuZ2VFcnJvclByb3RvdHlwZSUiOiBSYW5nZUVycm9yLnByb3RvdHlwZSwKICAgICAgIiVSZWZlcmVuY2VFcnJvciUiOiBSZWZlcmVuY2VFcnJvciwKICAgICAgIiVSZWZlcmVuY2VFcnJvclByb3RvdHlwZSUiOiBSZWZlcmVuY2VFcnJvci5wcm90b3R5cGUsCiAgICAgICIlUmVmbGVjdCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUmVmbGVjdCA/IHZvaWQgMCA6IFJlZmxlY3QsCiAgICAgICIlUmVnRXhwJSI6IFJlZ0V4cCwKICAgICAgIiVSZWdFeHBQcm90b3R5cGUlIjogUmVnRXhwLnByb3RvdHlwZSwKICAgICAgIiVTZXQlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFNldCA/IHZvaWQgMCA6IFNldCwKICAgICAgIiVTZXRJdGVyYXRvclByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU2V0ICYmIGMgPyB1KG5ldyBTZXQoKVtTeW1ib2wuaXRlcmF0b3JdKCkpIDogdm9pZCAwLAogICAgICAiJVNldFByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgU2V0ID8gdm9pZCAwIDogU2V0LnByb3RvdHlwZSwKICAgICAgIiVTaGFyZWRBcnJheUJ1ZmZlciUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgU2hhcmVkQXJyYXlCdWZmZXIgPyB2b2lkIDAgOiBTaGFyZWRBcnJheUJ1ZmZlciwKICAgICAgIiVTaGFyZWRBcnJheUJ1ZmZlclByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgU2hhcmVkQXJyYXlCdWZmZXIgPyB2b2lkIDAgOiBTaGFyZWRBcnJheUJ1ZmZlci5wcm90b3R5cGUsCiAgICAgICIlU3RyaW5nJSI6IFN0cmluZywKICAgICAgIiVTdHJpbmdJdGVyYXRvclByb3RvdHlwZSUiOiBjID8gdSgiIltTeW1ib2wuaXRlcmF0b3JdKCkpIDogdm9pZCAwLAogICAgICAiJVN0cmluZ1Byb3RvdHlwZSUiOiBTdHJpbmcucHJvdG90eXBlLAogICAgICAiJVN5bWJvbCUiOiBjID8gU3ltYm9sIDogdm9pZCAwLAogICAgICAiJVN5bWJvbFByb3RvdHlwZSUiOiBjID8gU3ltYm9sLnByb3RvdHlwZSA6IHZvaWQgMCwKICAgICAgIiVTeW50YXhFcnJvciUiOiBTeW50YXhFcnJvciwKICAgICAgIiVTeW50YXhFcnJvclByb3RvdHlwZSUiOiBTeW50YXhFcnJvci5wcm90b3R5cGUsCiAgICAgICIlVGhyb3dUeXBlRXJyb3IlIjogbCwKICAgICAgIiVUeXBlZEFycmF5JSI6IGgsCiAgICAgICIlVHlwZWRBcnJheVByb3RvdHlwZSUiOiBoID8gaC5wcm90b3R5cGUgOiB2b2lkIDAsCiAgICAgICIlVHlwZUVycm9yJSI6IHIsCiAgICAgICIlVHlwZUVycm9yUHJvdG90eXBlJSI6IHIucHJvdG90eXBlLAogICAgICAiJVVpbnQ4QXJyYXklIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFVpbnQ4QXJyYXkgPyB2b2lkIDAgOiBVaW50OEFycmF5LAogICAgICAiJVVpbnQ4QXJyYXlQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFVpbnQ4QXJyYXkgPyB2b2lkIDAgOiBVaW50OEFycmF5LnByb3RvdHlwZSwKICAgICAgIiVVaW50OENsYW1wZWRBcnJheSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDhDbGFtcGVkQXJyYXkgPyB2b2lkIDAgOiBVaW50OENsYW1wZWRBcnJheSwKICAgICAgIiVVaW50OENsYW1wZWRBcnJheVByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgVWludDhDbGFtcGVkQXJyYXkgPyB2b2lkIDAgOiBVaW50OENsYW1wZWRBcnJheS5wcm90b3R5cGUsCiAgICAgICIlVWludDE2QXJyYXklIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFVpbnQxNkFycmF5ID8gdm9pZCAwIDogVWludDE2QXJyYXksCiAgICAgICIlVWludDE2QXJyYXlQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFVpbnQxNkFycmF5ID8gdm9pZCAwIDogVWludDE2QXJyYXkucHJvdG90eXBlLAogICAgICAiJVVpbnQzMkFycmF5JSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBVaW50MzJBcnJheSA/IHZvaWQgMCA6IFVpbnQzMkFycmF5LAogICAgICAiJVVpbnQzMkFycmF5UHJvdG90eXBlJSI6ICJ1bmRlZmluZWQiID09IHR5cGVvZiBVaW50MzJBcnJheSA/IHZvaWQgMCA6IFVpbnQzMkFycmF5LnByb3RvdHlwZSwKICAgICAgIiVVUklFcnJvciUiOiBVUklFcnJvciwKICAgICAgIiVVUklFcnJvclByb3RvdHlwZSUiOiBVUklFcnJvci5wcm90b3R5cGUsCiAgICAgICIlV2Vha01hcCUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgV2Vha01hcCA/IHZvaWQgMCA6IFdlYWtNYXAsCiAgICAgICIlV2Vha01hcFByb3RvdHlwZSUiOiAidW5kZWZpbmVkIiA9PSB0eXBlb2YgV2Vha01hcCA/IHZvaWQgMCA6IFdlYWtNYXAucHJvdG90eXBlLAogICAgICAiJVdlYWtTZXQlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFdlYWtTZXQgPyB2b2lkIDAgOiBXZWFrU2V0LAogICAgICAiJVdlYWtTZXRQcm90b3R5cGUlIjogInVuZGVmaW5lZCIgPT0gdHlwZW9mIFdlYWtTZXQgPyB2b2lkIDAgOiBXZWFrU2V0LnByb3RvdHlwZQogICAgfSwKICAgICAgICBnID0gbig0KSwKICAgICAgICBtID0gZy5jYWxsKEZ1bmN0aW9uLmNhbGwsIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZSksCiAgICAgICAgeSA9IC9bXiUuW1xdXSt8XFsoPzooLT9cZCsoPzpcLlxkKyk/KXwoWyInXSkoKD86KD8hXDIpW15cXF18XFwuKSo/KVwyKVxdfCg/PSg/OlwufFxbXF0pKD86XC58XFtcXXwlJCkpL2csCiAgICAgICAgYiA9IC9cXChcXCk/L2csCiAgICAgICAgdyA9IGZ1bmN0aW9uIHcoZSkgewogICAgICB2YXIgdCA9IFtdOwogICAgICByZXR1cm4gbShlLCB5LCBmdW5jdGlvbiAoZSwgbiwgciwgbykgewogICAgICAgIHRbdC5sZW5ndGhdID0gciA/IG0obywgYiwgIiQxIikgOiBuIHx8IGU7CiAgICAgIH0pLCB0OwogICAgfSwKICAgICAgICB4ID0gZnVuY3Rpb24geChlLCB0KSB7CiAgICAgIGlmICghKGUgaW4gdikpIHRocm93IG5ldyBTeW50YXhFcnJvcigiaW50cmluc2ljICIgKyBlICsgIiBkb2VzIG5vdCBleGlzdCEiKTsKICAgICAgaWYgKHZvaWQgMCA9PT0gdltlXSAmJiAhdCkgdGhyb3cgbmV3IHIoImludHJpbnNpYyAiICsgZSArICIgZXhpc3RzLCBidXQgaXMgbm90IGF2YWlsYWJsZS4gUGxlYXNlIGZpbGUgYW4gaXNzdWUhIik7CiAgICAgIHJldHVybiB2W2VdOwogICAgfTsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICBpZiAoInN0cmluZyIgIT0gdHlwZW9mIGUgfHwgMCA9PT0gZS5sZW5ndGgpIHRocm93IG5ldyBUeXBlRXJyb3IoImludHJpbnNpYyBuYW1lIG11c3QgYmUgYSBub24tZW1wdHkgc3RyaW5nIik7CiAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSAmJiAiYm9vbGVhbiIgIT0gdHlwZW9mIHQpIHRocm93IG5ldyBUeXBlRXJyb3IoJyJhbGxvd01pc3NpbmciIGFyZ3VtZW50IG11c3QgYmUgYSBib29sZWFuJyk7CgogICAgICBmb3IgKHZhciBuID0gdyhlKSwgaSA9IHgoIiUiICsgKG4ubGVuZ3RoID4gMCA/IG5bMF0gOiAiIikgKyAiJSIsIHQpLCBhID0gMTsgYSA8IG4ubGVuZ3RoOyBhICs9IDEpIHsKICAgICAgICBpZiAobnVsbCAhPSBpKSBpZiAobyAmJiBhICsgMSA+PSBuLmxlbmd0aCkgewogICAgICAgICAgdmFyIHMgPSBvKGksIG5bYV0pOwogICAgICAgICAgaWYgKCEodCB8fCBuW2FdIGluIGkpKSB0aHJvdyBuZXcgcigiYmFzZSBpbnRyaW5zaWMgZm9yICIgKyBlICsgIiBleGlzdHMsIGJ1dCB0aGUgcHJvcGVydHkgaXMgbm90IGF2YWlsYWJsZS4iKTsKICAgICAgICAgIGkgPSBzID8gcy5nZXQgfHwgcy52YWx1ZSA6IGlbblthXV07CiAgICAgICAgfSBlbHNlIGkgPSBpW25bYV1dOwogICAgICB9CgogICAgICByZXR1cm4gaTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB0Ll9fZXNNb2R1bGUgPSAhMDsKICAgIHQuREVGQVVMVF9FTU9KSV9DRE4gPSAiLy9pbWcudC5zaW5hanMuY24vdDQvYXBwc3R5bGUvZXhwcmVzc2lvbi9leHQvbm9ybWFsLyIsIHQuREJfTkFNRSA9ICJDb21tZW50IiwgdC5kZWZhdWx0Q29uZmlnID0gewogICAgICBsYW5nOiAiemgtQ04iLAogICAgICBsYW5nTW9kZTogbnVsbCwKICAgICAgYXBwSWQ6ICIiLAogICAgICBhcHBLZXk6ICIiLAogICAgICBjbGF6ek5hbWU6ICJDb21tZW50IiwKICAgICAgbWV0YTogWyJuaWNrIiwgIm1haWwiLCAibGluayJdLAogICAgICBwYXRoOiBsb2NhdGlvbi5wYXRobmFtZSwKICAgICAgcGxhY2Vob2xkZXI6ICJKdXN0IEdvIEdvIiwKICAgICAgcGFnZVNpemU6IDEwLAogICAgICByZWNvcmRJUDogITAsCiAgICAgIHNlcnZlclVSTHM6ICIiLAogICAgICB2aXNpdG9yOiAhMSwKICAgICAgZW1vamlDRE46ICIiLAogICAgICBlbW9qaU1hcHM6IHZvaWQgMCwKICAgICAgZW5hYmxlUVE6ICExLAogICAgICByZXF1aXJlZEZpZWxkczogW10KICAgIH0sIHQuZGVmYXVsdE1ldGEgPSBbIm5pY2siLCAibWFpbCIsICJsaW5rIl0sIHQuUVFDYWNoZUtleSA9ICJfdl9DYWNoZV9RIiwgdC5NZXRhQ2FjaGVLZXkgPSAiX3ZfQ2FjaGVfTWV0YSIsIHQuUmFuZG9tU3RyID0gKERhdGUubm93KCkgKyBNYXRoLnJvdW5kKDFlMyAqIE1hdGgucmFuZG9tKCkpKS50b1N0cmluZygzMiksIHQuVkVSU0lPTiA9ICIxLjQuMTQiOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICBmdW5jdGlvbiByKGUsIHQpIHsKICAgICAgcmV0dXJuIG5ldyBpKHQpLnByb2Nlc3MoZSk7CiAgICB9CgogICAgdmFyIG8gPSBuKDcpLAogICAgICAgIGkgPSBuKDI5KTsKICAgIHQgPSBlLmV4cG9ydHMgPSByLCB0LkZpbHRlckNTUyA9IGk7CgogICAgZm9yICh2YXIgYSBpbiBvKSB7CiAgICAgIHRbYV0gPSBvW2FdOwogICAgfQoKICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgKHdpbmRvdy5maWx0ZXJDU1MgPSBlLmV4cG9ydHMpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDMyKTsKICAgIGUuZXhwb3J0cyA9IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kIHx8IHI7CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IHsKICAgICAgaW5kZXhPZjogZnVuY3Rpb24gaW5kZXhPZihlLCB0KSB7CiAgICAgICAgdmFyIG4sIHI7CiAgICAgICAgaWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSByZXR1cm4gZS5pbmRleE9mKHQpOwoKICAgICAgICBmb3IgKG4gPSAwLCByID0gZS5sZW5ndGg7IG4gPCByOyBuKyspIHsKICAgICAgICAgIGlmIChlW25dID09PSB0KSByZXR1cm4gbjsKICAgICAgICB9CgogICAgICAgIHJldHVybiAtMTsKICAgICAgfSwKICAgICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChlLCB0LCBuKSB7CiAgICAgICAgdmFyIHIsIG87CiAgICAgICAgaWYgKEFycmF5LnByb3RvdHlwZS5mb3JFYWNoKSByZXR1cm4gZS5mb3JFYWNoKHQsIG4pOwoKICAgICAgICBmb3IgKHIgPSAwLCBvID0gZS5sZW5ndGg7IHIgPCBvOyByKyspIHsKICAgICAgICAgIHQuY2FsbChuLCBlW3JdLCByLCBlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRyaW06IGZ1bmN0aW9uIHRyaW0oZSkgewogICAgICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLnRyaW0gPyBlLnRyaW0oKSA6IGUucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCAiIik7CiAgICAgIH0sCiAgICAgIHNwYWNlSW5kZXg6IGZ1bmN0aW9uIHNwYWNlSW5kZXgoZSkgewogICAgICAgIHZhciB0ID0gL1xzfFxufFx0LywKICAgICAgICAgICAgbiA9IHQuZXhlYyhlKTsKICAgICAgICByZXR1cm4gbiA/IG4uaW5kZXggOiAtMTsKICAgICAgfQogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwOwogICAgdmFyIHIgPSBuKDIpLAogICAgICAgIG8gPSB7CiAgICAgIGNkbjogci5ERUZBVUxUX0VNT0pJX0NETiwKICAgICAgbWFwczogbig1MyksCiAgICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZShlKSB7CiAgICAgICAgcmV0dXJuIFN0cmluZyhlKS5yZXBsYWNlKG5ldyBSZWdFeHAoIjooIiArIE9iamVjdC5rZXlzKG8ubWFwcykuam9pbigifCIpICsgIik6IiwgImlnIiksIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICByZXR1cm4gby5tYXBzW3RdID8gby5idWlsZCh0KSA6IGU7CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGJ1aWxkOiBmdW5jdGlvbiBidWlsZChlKSB7CiAgICAgICAgdmFyIHQgPSAvXihodHRwcz86KT9cL1wvL2ksCiAgICAgICAgICAgIG4gPSBvLm1hcHNbZV0sCiAgICAgICAgICAgIHIgPSB0LnRlc3QobikgPyBuIDogby5jZG4gKyBuOwogICAgICAgIHJldHVybiB0LnRlc3QocikgPyAnPGltZyBhbHQ9IicgKyBlICsgJyIgcmVmZXJyZXJQb2xpY3k9Im5vLXJlZmVycmVyIiBjbGFzcz0idmVtb2ppIiBzcmM9IicgKyByICsgJyIgLz4nIDogIiI7CiAgICAgIH0KICAgIH07CiAgICB0WyJkZWZhdWx0Il0gPSBvOwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBmdW5jdGlvbiBuKCkgewogICAgICB2YXIgZSA9IHt9OwogICAgICByZXR1cm4gZVsiYWxpZ24tY29udGVudCJdID0gITEsIGVbImFsaWduLWl0ZW1zIl0gPSAhMSwgZVsiYWxpZ24tc2VsZiJdID0gITEsIGVbImFsaWdubWVudC1hZGp1c3QiXSA9ICExLCBlWyJhbGlnbm1lbnQtYmFzZWxpbmUiXSA9ICExLCBlLmFsbCA9ICExLCBlWyJhbmNob3ItcG9pbnQiXSA9ICExLCBlLmFuaW1hdGlvbiA9ICExLCBlWyJhbmltYXRpb24tZGVsYXkiXSA9ICExLCBlWyJhbmltYXRpb24tZGlyZWN0aW9uIl0gPSAhMSwgZVsiYW5pbWF0aW9uLWR1cmF0aW9uIl0gPSAhMSwgZVsiYW5pbWF0aW9uLWZpbGwtbW9kZSJdID0gITEsIGVbImFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQiXSA9ICExLCBlWyJhbmltYXRpb24tbmFtZSJdID0gITEsIGVbImFuaW1hdGlvbi1wbGF5LXN0YXRlIl0gPSAhMSwgZVsiYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbiJdID0gITEsIGUuYXppbXV0aCA9ICExLCBlWyJiYWNrZmFjZS12aXNpYmlsaXR5Il0gPSAhMSwgZS5iYWNrZ3JvdW5kID0gITAsIGVbImJhY2tncm91bmQtYXR0YWNobWVudCJdID0gITAsIGVbImJhY2tncm91bmQtY2xpcCJdID0gITAsIGVbImJhY2tncm91bmQtY29sb3IiXSA9ICEwLCBlWyJiYWNrZ3JvdW5kLWltYWdlIl0gPSAhMCwgZVsiYmFja2dyb3VuZC1vcmlnaW4iXSA9ICEwLCBlWyJiYWNrZ3JvdW5kLXBvc2l0aW9uIl0gPSAhMCwgZVsiYmFja2dyb3VuZC1yZXBlYXQiXSA9ICEwLCBlWyJiYWNrZ3JvdW5kLXNpemUiXSA9ICEwLCBlWyJiYXNlbGluZS1zaGlmdCJdID0gITEsIGUuYmluZGluZyA9ICExLCBlLmJsZWVkID0gITEsIGVbImJvb2ttYXJrLWxhYmVsIl0gPSAhMSwgZVsiYm9va21hcmstbGV2ZWwiXSA9ICExLCBlWyJib29rbWFyay1zdGF0ZSJdID0gITEsIGUuYm9yZGVyID0gITAsIGVbImJvcmRlci1ib3R0b20iXSA9ICEwLCBlWyJib3JkZXItYm90dG9tLWNvbG9yIl0gPSAhMCwgZVsiYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1cyJdID0gITAsIGVbImJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzIl0gPSAhMCwgZVsiYm9yZGVyLWJvdHRvbS1zdHlsZSJdID0gITAsIGVbImJvcmRlci1ib3R0b20td2lkdGgiXSA9ICEwLCBlWyJib3JkZXItY29sbGFwc2UiXSA9ICEwLCBlWyJib3JkZXItY29sb3IiXSA9ICEwLCBlWyJib3JkZXItaW1hZ2UiXSA9ICEwLCBlWyJib3JkZXItaW1hZ2Utb3V0c2V0Il0gPSAhMCwgZVsiYm9yZGVyLWltYWdlLXJlcGVhdCJdID0gITAsIGVbImJvcmRlci1pbWFnZS1zbGljZSJdID0gITAsIGVbImJvcmRlci1pbWFnZS1zb3VyY2UiXSA9ICEwLCBlWyJib3JkZXItaW1hZ2Utd2lkdGgiXSA9ICEwLCBlWyJib3JkZXItbGVmdCJdID0gITAsIGVbImJvcmRlci1sZWZ0LWNvbG9yIl0gPSAhMCwgZVsiYm9yZGVyLWxlZnQtc3R5bGUiXSA9ICEwLCBlWyJib3JkZXItbGVmdC13aWR0aCJdID0gITAsIGVbImJvcmRlci1yYWRpdXMiXSA9ICEwLCBlWyJib3JkZXItcmlnaHQiXSA9ICEwLCBlWyJib3JkZXItcmlnaHQtY29sb3IiXSA9ICEwLCBlWyJib3JkZXItcmlnaHQtc3R5bGUiXSA9ICEwLCBlWyJib3JkZXItcmlnaHQtd2lkdGgiXSA9ICEwLCBlWyJib3JkZXItc3BhY2luZyJdID0gITAsIGVbImJvcmRlci1zdHlsZSJdID0gITAsIGVbImJvcmRlci10b3AiXSA9ICEwLCBlWyJib3JkZXItdG9wLWNvbG9yIl0gPSAhMCwgZVsiYm9yZGVyLXRvcC1sZWZ0LXJhZGl1cyJdID0gITAsIGVbImJvcmRlci10b3AtcmlnaHQtcmFkaXVzIl0gPSAhMCwgZVsiYm9yZGVyLXRvcC1zdHlsZSJdID0gITAsIGVbImJvcmRlci10b3Atd2lkdGgiXSA9ICEwLCBlWyJib3JkZXItd2lkdGgiXSA9ICEwLCBlLmJvdHRvbSA9ICExLCBlWyJib3gtZGVjb3JhdGlvbi1icmVhayJdID0gITAsIGVbImJveC1zaGFkb3ciXSA9ICEwLCBlWyJib3gtc2l6aW5nIl0gPSAhMCwgZVsiYm94LXNuYXAiXSA9ICEwLCBlWyJib3gtc3VwcHJlc3MiXSA9ICEwLCBlWyJicmVhay1hZnRlciJdID0gITAsIGVbImJyZWFrLWJlZm9yZSJdID0gITAsIGVbImJyZWFrLWluc2lkZSJdID0gITAsIGVbImNhcHRpb24tc2lkZSJdID0gITEsIGUuY2hhaW5zID0gITEsIGUuY2xlYXIgPSAhMCwgZS5jbGlwID0gITEsIGVbImNsaXAtcGF0aCJdID0gITEsIGVbImNsaXAtcnVsZSJdID0gITEsIGUuY29sb3IgPSAhMCwgZVsiY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzIl0gPSAhMCwgZVsiY29sdW1uLWNvdW50Il0gPSAhMSwgZVsiY29sdW1uLWZpbGwiXSA9ICExLCBlWyJjb2x1bW4tZ2FwIl0gPSAhMSwgZVsiY29sdW1uLXJ1bGUiXSA9ICExLCBlWyJjb2x1bW4tcnVsZS1jb2xvciJdID0gITEsIGVbImNvbHVtbi1ydWxlLXN0eWxlIl0gPSAhMSwgZVsiY29sdW1uLXJ1bGUtd2lkdGgiXSA9ICExLCBlWyJjb2x1bW4tc3BhbiJdID0gITEsIGVbImNvbHVtbi13aWR0aCJdID0gITEsIGUuY29sdW1ucyA9ICExLCBlLmNvbnRhaW4gPSAhMSwgZS5jb250ZW50ID0gITEsIGVbImNvdW50ZXItaW5jcmVtZW50Il0gPSAhMSwgZVsiY291bnRlci1yZXNldCJdID0gITEsIGVbImNvdW50ZXItc2V0Il0gPSAhMSwgZS5jcm9wID0gITEsIGUuY3VlID0gITEsIGVbImN1ZS1hZnRlciJdID0gITEsIGVbImN1ZS1iZWZvcmUiXSA9ICExLCBlLmN1cnNvciA9ICExLCBlLmRpcmVjdGlvbiA9ICExLCBlLmRpc3BsYXkgPSAhMCwgZVsiZGlzcGxheS1pbnNpZGUiXSA9ICEwLCBlWyJkaXNwbGF5LWxpc3QiXSA9ICEwLCBlWyJkaXNwbGF5LW91dHNpZGUiXSA9ICEwLCBlWyJkb21pbmFudC1iYXNlbGluZSJdID0gITEsIGUuZWxldmF0aW9uID0gITEsIGVbImVtcHR5LWNlbGxzIl0gPSAhMSwgZS5maWx0ZXIgPSAhMSwgZS5mbGV4ID0gITEsIGVbImZsZXgtYmFzaXMiXSA9ICExLCBlWyJmbGV4LWRpcmVjdGlvbiJdID0gITEsIGVbImZsZXgtZmxvdyJdID0gITEsIGVbImZsZXgtZ3JvdyJdID0gITEsIGVbImZsZXgtc2hyaW5rIl0gPSAhMSwgZVsiZmxleC13cmFwIl0gPSAhMSwgZVsiZmxvYXQiXSA9ICExLCBlWyJmbG9hdC1vZmZzZXQiXSA9ICExLCBlWyJmbG9vZC1jb2xvciJdID0gITEsIGVbImZsb29kLW9wYWNpdHkiXSA9ICExLCBlWyJmbG93LWZyb20iXSA9ICExLCBlWyJmbG93LWludG8iXSA9ICExLCBlLmZvbnQgPSAhMCwgZVsiZm9udC1mYW1pbHkiXSA9ICEwLCBlWyJmb250LWZlYXR1cmUtc2V0dGluZ3MiXSA9ICEwLCBlWyJmb250LWtlcm5pbmciXSA9ICEwLCBlWyJmb250LWxhbmd1YWdlLW92ZXJyaWRlIl0gPSAhMCwgZVsiZm9udC1zaXplIl0gPSAhMCwgZVsiZm9udC1zaXplLWFkanVzdCJdID0gITAsIGVbImZvbnQtc3RyZXRjaCJdID0gITAsIGVbImZvbnQtc3R5bGUiXSA9ICEwLCBlWyJmb250LXN5bnRoZXNpcyJdID0gITAsIGVbImZvbnQtdmFyaWFudCJdID0gITAsIGVbImZvbnQtdmFyaWFudC1hbHRlcm5hdGVzIl0gPSAhMCwgZVsiZm9udC12YXJpYW50LWNhcHMiXSA9ICEwLCBlWyJmb250LXZhcmlhbnQtZWFzdC1hc2lhbiJdID0gITAsIGVbImZvbnQtdmFyaWFudC1saWdhdHVyZXMiXSA9ICEwLCBlWyJmb250LXZhcmlhbnQtbnVtZXJpYyJdID0gITAsIGVbImZvbnQtdmFyaWFudC1wb3NpdGlvbiJdID0gITAsIGVbImZvbnQtd2VpZ2h0Il0gPSAhMCwgZS5ncmlkID0gITEsIGVbImdyaWQtYXJlYSJdID0gITEsIGVbImdyaWQtYXV0by1jb2x1bW5zIl0gPSAhMSwgZVsiZ3JpZC1hdXRvLWZsb3ciXSA9ICExLCBlWyJncmlkLWF1dG8tcm93cyJdID0gITEsIGVbImdyaWQtY29sdW1uIl0gPSAhMSwgZVsiZ3JpZC1jb2x1bW4tZW5kIl0gPSAhMSwgZVsiZ3JpZC1jb2x1bW4tc3RhcnQiXSA9ICExLCBlWyJncmlkLXJvdyJdID0gITEsIGVbImdyaWQtcm93LWVuZCJdID0gITEsIGVbImdyaWQtcm93LXN0YXJ0Il0gPSAhMSwgZVsiZ3JpZC10ZW1wbGF0ZSJdID0gITEsIGVbImdyaWQtdGVtcGxhdGUtYXJlYXMiXSA9ICExLCBlWyJncmlkLXRlbXBsYXRlLWNvbHVtbnMiXSA9ICExLCBlWyJncmlkLXRlbXBsYXRlLXJvd3MiXSA9ICExLCBlWyJoYW5naW5nLXB1bmN0dWF0aW9uIl0gPSAhMSwgZS5oZWlnaHQgPSAhMCwgZS5oeXBoZW5zID0gITEsIGUuaWNvbiA9ICExLCBlWyJpbWFnZS1vcmllbnRhdGlvbiJdID0gITEsIGVbImltYWdlLXJlc29sdXRpb24iXSA9ICExLCBlWyJpbWUtbW9kZSJdID0gITEsIGVbImluaXRpYWwtbGV0dGVycyJdID0gITEsIGVbImlubGluZS1ib3gtYWxpZ24iXSA9ICExLCBlWyJqdXN0aWZ5LWNvbnRlbnQiXSA9ICExLCBlWyJqdXN0aWZ5LWl0ZW1zIl0gPSAhMSwgZVsianVzdGlmeS1zZWxmIl0gPSAhMSwgZS5sZWZ0ID0gITEsIGVbImxldHRlci1zcGFjaW5nIl0gPSAhMCwgZVsibGlnaHRpbmctY29sb3IiXSA9ICEwLCBlWyJsaW5lLWJveC1jb250YWluIl0gPSAhMSwgZVsibGluZS1icmVhayJdID0gITEsIGVbImxpbmUtZ3JpZCJdID0gITEsIGVbImxpbmUtaGVpZ2h0Il0gPSAhMSwgZVsibGluZS1zbmFwIl0gPSAhMSwgZVsibGluZS1zdGFja2luZyJdID0gITEsIGVbImxpbmUtc3RhY2tpbmctcnVieSJdID0gITEsIGVbImxpbmUtc3RhY2tpbmctc2hpZnQiXSA9ICExLCBlWyJsaW5lLXN0YWNraW5nLXN0cmF0ZWd5Il0gPSAhMSwgZVsibGlzdC1zdHlsZSJdID0gITAsIGVbImxpc3Qtc3R5bGUtaW1hZ2UiXSA9ICEwLCBlWyJsaXN0LXN0eWxlLXBvc2l0aW9uIl0gPSAhMCwgZVsibGlzdC1zdHlsZS10eXBlIl0gPSAhMCwgZS5tYXJnaW4gPSAhMCwgZVsibWFyZ2luLWJvdHRvbSJdID0gITAsIGVbIm1hcmdpbi1sZWZ0Il0gPSAhMCwgZVsibWFyZ2luLXJpZ2h0Il0gPSAhMCwgZVsibWFyZ2luLXRvcCJdID0gITAsIGVbIm1hcmtlci1vZmZzZXQiXSA9ICExLCBlWyJtYXJrZXItc2lkZSJdID0gITEsIGUubWFya3MgPSAhMSwgZS5tYXNrID0gITEsIGVbIm1hc2stYm94Il0gPSAhMSwgZVsibWFzay1ib3gtb3V0c2V0Il0gPSAhMSwgZVsibWFzay1ib3gtcmVwZWF0Il0gPSAhMSwgZVsibWFzay1ib3gtc2xpY2UiXSA9ICExLCBlWyJtYXNrLWJveC1zb3VyY2UiXSA9ICExLCBlWyJtYXNrLWJveC13aWR0aCJdID0gITEsIGVbIm1hc2stY2xpcCJdID0gITEsIGVbIm1hc2staW1hZ2UiXSA9ICExLCBlWyJtYXNrLW9yaWdpbiJdID0gITEsIGVbIm1hc2stcG9zaXRpb24iXSA9ICExLCBlWyJtYXNrLXJlcGVhdCJdID0gITEsIGVbIm1hc2stc2l6ZSJdID0gITEsIGVbIm1hc2stc291cmNlLXR5cGUiXSA9ICExLCBlWyJtYXNrLXR5cGUiXSA9ICExLCBlWyJtYXgtaGVpZ2h0Il0gPSAhMCwgZVsibWF4LWxpbmVzIl0gPSAhMSwgZVsibWF4LXdpZHRoIl0gPSAhMCwgZVsibWluLWhlaWdodCJdID0gITAsIGVbIm1pbi13aWR0aCJdID0gITAsIGVbIm1vdmUtdG8iXSA9ICExLCBlWyJuYXYtZG93biJdID0gITEsIGVbIm5hdi1pbmRleCJdID0gITEsIGVbIm5hdi1sZWZ0Il0gPSAhMSwgZVsibmF2LXJpZ2h0Il0gPSAhMSwgZVsibmF2LXVwIl0gPSAhMSwgZVsib2JqZWN0LWZpdCJdID0gITEsIGVbIm9iamVjdC1wb3NpdGlvbiJdID0gITEsIGUub3BhY2l0eSA9ICExLCBlLm9yZGVyID0gITEsIGUub3JwaGFucyA9ICExLCBlLm91dGxpbmUgPSAhMSwgZVsib3V0bGluZS1jb2xvciJdID0gITEsIGVbIm91dGxpbmUtb2Zmc2V0Il0gPSAhMSwgZVsib3V0bGluZS1zdHlsZSJdID0gITEsIGVbIm91dGxpbmUtd2lkdGgiXSA9ICExLCBlLm92ZXJmbG93ID0gITEsIGVbIm92ZXJmbG93LXdyYXAiXSA9ICExLCBlWyJvdmVyZmxvdy14Il0gPSAhMSwgZVsib3ZlcmZsb3cteSJdID0gITEsIGUucGFkZGluZyA9ICEwLCBlWyJwYWRkaW5nLWJvdHRvbSJdID0gITAsIGVbInBhZGRpbmctbGVmdCJdID0gITAsIGVbInBhZGRpbmctcmlnaHQiXSA9ICEwLCBlWyJwYWRkaW5nLXRvcCJdID0gITAsIGUucGFnZSA9ICExLCBlWyJwYWdlLWJyZWFrLWFmdGVyIl0gPSAhMSwgZVsicGFnZS1icmVhay1iZWZvcmUiXSA9ICExLCBlWyJwYWdlLWJyZWFrLWluc2lkZSJdID0gITEsIGVbInBhZ2UtcG9saWN5Il0gPSAhMSwgZS5wYXVzZSA9ICExLCBlWyJwYXVzZS1hZnRlciJdID0gITEsIGVbInBhdXNlLWJlZm9yZSJdID0gITEsIGUucGVyc3BlY3RpdmUgPSAhMSwgZVsicGVyc3BlY3RpdmUtb3JpZ2luIl0gPSAhMSwgZS5waXRjaCA9ICExLCBlWyJwaXRjaC1yYW5nZSJdID0gITEsIGVbInBsYXktZHVyaW5nIl0gPSAhMSwgZS5wb3NpdGlvbiA9ICExLCBlWyJwcmVzZW50YXRpb24tbGV2ZWwiXSA9ICExLCBlLnF1b3RlcyA9ICExLCBlWyJyZWdpb24tZnJhZ21lbnQiXSA9ICExLCBlLnJlc2l6ZSA9ICExLCBlLnJlc3QgPSAhMSwgZVsicmVzdC1hZnRlciJdID0gITEsIGVbInJlc3QtYmVmb3JlIl0gPSAhMSwgZS5yaWNobmVzcyA9ICExLCBlLnJpZ2h0ID0gITEsIGUucm90YXRpb24gPSAhMSwgZVsicm90YXRpb24tcG9pbnQiXSA9ICExLCBlWyJydWJ5LWFsaWduIl0gPSAhMSwgZVsicnVieS1tZXJnZSJdID0gITEsIGVbInJ1YnktcG9zaXRpb24iXSA9ICExLCBlWyJzaGFwZS1pbWFnZS10aHJlc2hvbGQiXSA9ICExLCBlWyJzaGFwZS1vdXRzaWRlIl0gPSAhMSwgZVsic2hhcGUtbWFyZ2luIl0gPSAhMSwgZS5zaXplID0gITEsIGUuc3BlYWsgPSAhMSwgZVsic3BlYWstYXMiXSA9ICExLCBlWyJzcGVhay1oZWFkZXIiXSA9ICExLCBlWyJzcGVhay1udW1lcmFsIl0gPSAhMSwgZVsic3BlYWstcHVuY3R1YXRpb24iXSA9ICExLCBlWyJzcGVlY2gtcmF0ZSJdID0gITEsIGUuc3RyZXNzID0gITEsIGVbInN0cmluZy1zZXQiXSA9ICExLCBlWyJ0YWItc2l6ZSJdID0gITEsIGVbInRhYmxlLWxheW91dCJdID0gITEsIGVbInRleHQtYWxpZ24iXSA9ICEwLCBlWyJ0ZXh0LWFsaWduLWxhc3QiXSA9ICEwLCBlWyJ0ZXh0LWNvbWJpbmUtdXByaWdodCJdID0gITAsIGVbInRleHQtZGVjb3JhdGlvbiJdID0gITAsIGVbInRleHQtZGVjb3JhdGlvbi1jb2xvciJdID0gITAsIGVbInRleHQtZGVjb3JhdGlvbi1saW5lIl0gPSAhMCwgZVsidGV4dC1kZWNvcmF0aW9uLXNraXAiXSA9ICEwLCBlWyJ0ZXh0LWRlY29yYXRpb24tc3R5bGUiXSA9ICEwLCBlWyJ0ZXh0LWVtcGhhc2lzIl0gPSAhMCwgZVsidGV4dC1lbXBoYXNpcy1jb2xvciJdID0gITAsIGVbInRleHQtZW1waGFzaXMtcG9zaXRpb24iXSA9ICEwLCBlWyJ0ZXh0LWVtcGhhc2lzLXN0eWxlIl0gPSAhMCwgZVsidGV4dC1oZWlnaHQiXSA9ICEwLCBlWyJ0ZXh0LWluZGVudCJdID0gITAsIGVbInRleHQtanVzdGlmeSJdID0gITAsIGVbInRleHQtb3JpZW50YXRpb24iXSA9ICEwLCBlWyJ0ZXh0LW92ZXJmbG93Il0gPSAhMCwgZVsidGV4dC1zaGFkb3ciXSA9ICEwLCBlWyJ0ZXh0LXNwYWNlLWNvbGxhcHNlIl0gPSAhMCwgZVsidGV4dC10cmFuc2Zvcm0iXSA9ICEwLCBlWyJ0ZXh0LXVuZGVybGluZS1wb3NpdGlvbiJdID0gITAsIGVbInRleHQtd3JhcCJdID0gITAsIGUudG9wID0gITEsIGUudHJhbnNmb3JtID0gITEsIGVbInRyYW5zZm9ybS1vcmlnaW4iXSA9ICExLCBlWyJ0cmFuc2Zvcm0tc3R5bGUiXSA9ICExLCBlLnRyYW5zaXRpb24gPSAhMSwgZVsidHJhbnNpdGlvbi1kZWxheSJdID0gITEsIGVbInRyYW5zaXRpb24tZHVyYXRpb24iXSA9ICExLCBlWyJ0cmFuc2l0aW9uLXByb3BlcnR5Il0gPSAhMSwgZVsidHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb24iXSA9ICExLCBlWyJ1bmljb2RlLWJpZGkiXSA9ICExLCBlWyJ2ZXJ0aWNhbC1hbGlnbiJdID0gITEsIGUudmlzaWJpbGl0eSA9ICExLCBlWyJ2b2ljZS1iYWxhbmNlIl0gPSAhMSwgZVsidm9pY2UtZHVyYXRpb24iXSA9ICExLCBlWyJ2b2ljZS1mYW1pbHkiXSA9ICExLCBlWyJ2b2ljZS1waXRjaCJdID0gITEsIGVbInZvaWNlLXJhbmdlIl0gPSAhMSwgZVsidm9pY2UtcmF0ZSJdID0gITEsIGVbInZvaWNlLXN0cmVzcyJdID0gITEsIGVbInZvaWNlLXZvbHVtZSJdID0gITEsIGUudm9sdW1lID0gITEsIGVbIndoaXRlLXNwYWNlIl0gPSAhMSwgZS53aWRvd3MgPSAhMSwgZS53aWR0aCA9ICEwLCBlWyJ3aWxsLWNoYW5nZSJdID0gITEsIGVbIndvcmQtYnJlYWsiXSA9ICEwLCBlWyJ3b3JkLXNwYWNpbmciXSA9ICEwLCBlWyJ3b3JkLXdyYXAiXSA9ICEwLCBlWyJ3cmFwLWZsb3ciXSA9ICExLCBlWyJ3cmFwLXRocm91Z2giXSA9ICExLCBlWyJ3cml0aW5nLW1vZGUiXSA9ICExLCBlWyJ6LWluZGV4Il0gPSAhMSwgZTsKICAgIH0KCiAgICBmdW5jdGlvbiByKGUsIHQsIG4pIHt9CgogICAgZnVuY3Rpb24gbyhlLCB0LCBuKSB7fQoKICAgIGZ1bmN0aW9uIGkoZSwgdCkgewogICAgICByZXR1cm4gYS50ZXN0KHQpID8gIiIgOiB0OwogICAgfQoKICAgIHZhciBhID0gL2phdmFzY3JpcHRccypcOi9naW07CiAgICB0LndoaXRlTGlzdCA9IG4oKSwgdC5nZXREZWZhdWx0V2hpdGVMaXN0ID0gbiwgdC5vbkF0dHIgPSByLCB0Lm9uSWdub3JlQXR0ciA9IG8sIHQuc2FmZUF0dHJWYWx1ZSA9IGk7CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IHsKICAgICAgaW5kZXhPZjogZnVuY3Rpb24gaW5kZXhPZihlLCB0KSB7CiAgICAgICAgdmFyIG4sIHI7CiAgICAgICAgaWYgKEFycmF5LnByb3RvdHlwZS5pbmRleE9mKSByZXR1cm4gZS5pbmRleE9mKHQpOwoKICAgICAgICBmb3IgKG4gPSAwLCByID0gZS5sZW5ndGg7IG4gPCByOyBuKyspIHsKICAgICAgICAgIGlmIChlW25dID09PSB0KSByZXR1cm4gbjsKICAgICAgICB9CgogICAgICAgIHJldHVybiAtMTsKICAgICAgfSwKICAgICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChlLCB0LCBuKSB7CiAgICAgICAgdmFyIHIsIG87CiAgICAgICAgaWYgKEFycmF5LnByb3RvdHlwZS5mb3JFYWNoKSByZXR1cm4gZS5mb3JFYWNoKHQsIG4pOwoKICAgICAgICBmb3IgKHIgPSAwLCBvID0gZS5sZW5ndGg7IHIgPCBvOyByKyspIHsKICAgICAgICAgIHQuY2FsbChuLCBlW3JdLCByLCBlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRyaW06IGZ1bmN0aW9uIHRyaW0oZSkgewogICAgICAgIHJldHVybiBTdHJpbmcucHJvdG90eXBlLnRyaW0gPyBlLnRyaW0oKSA6IGUucmVwbGFjZSgvKF5ccyopfChccyokKS9nLCAiIik7CiAgICAgIH0sCiAgICAgIHRyaW1SaWdodDogZnVuY3Rpb24gdHJpbVJpZ2h0KGUpIHsKICAgICAgICByZXR1cm4gU3RyaW5nLnByb3RvdHlwZS50cmltUmlnaHQgPyBlLnRyaW1SaWdodCgpIDogZS5yZXBsYWNlKC8oXHMqJCkvZywgIiIpOwogICAgICB9CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDQwKSwKICAgICAgICBvID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sKCJmb28iKSksCiAgICAgICAgaSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsCiAgICAgICAgYSA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQsCiAgICAgICAgcyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSwKICAgICAgICBsID0gZnVuY3Rpb24gbChlKSB7CiAgICAgIHJldHVybiAiZnVuY3Rpb24iID09IHR5cGVvZiBlICYmICJbb2JqZWN0IEZ1bmN0aW9uXSIgPT09IGkuY2FsbChlKTsKICAgIH0sCiAgICAgICAgYyA9IHMgJiYgZnVuY3Rpb24gKCkgewogICAgICB2YXIgZSA9IHt9OwoKICAgICAgdHJ5IHsKICAgICAgICBzKGUsICJ4IiwgewogICAgICAgICAgZW51bWVyYWJsZTogITEsCiAgICAgICAgICB2YWx1ZTogZQogICAgICAgIH0pOwoKICAgICAgICBmb3IgKHZhciB0IGluIGUpIHsKICAgICAgICAgIHJldHVybiAhMTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBlLnggPT09IGU7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZXR1cm4gITE7CiAgICAgIH0KICAgIH0oKSwKICAgICAgICB1ID0gZnVuY3Rpb24gdShlLCB0LCBuLCByKSB7CiAgICAgICghKHQgaW4gZSkgfHwgbChyKSAmJiByKCkpICYmIChjID8gcyhlLCB0LCB7CiAgICAgICAgY29uZmlndXJhYmxlOiAhMCwKICAgICAgICBlbnVtZXJhYmxlOiAhMSwKICAgICAgICB2YWx1ZTogbiwKICAgICAgICB3cml0YWJsZTogITAKICAgICAgfSkgOiBlW3RdID0gbik7CiAgICB9LAogICAgICAgIGQgPSBmdW5jdGlvbiBkKGUsIHQpIHsKICAgICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHt9LAogICAgICAgICAgaSA9IHIodCk7CiAgICAgIG8gJiYgKGkgPSBhLmNhbGwoaSwgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyh0KSkpOwoKICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBpLmxlbmd0aDsgcyArPSAxKSB7CiAgICAgICAgdShlLCBpW3NdLCB0W2lbc11dLCBuW2lbc11dKTsKICAgICAgfQogICAgfTsKCiAgICBkLnN1cHBvcnRzRGVzY3JpcHRvcnMgPSAhIWMsIGUuZXhwb3J0cyA9IGQ7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSByLmNhbGwoZSksCiAgICAgICAgICBuID0gIltvYmplY3QgQXJndW1lbnRzXSIgPT09IHQ7CiAgICAgIHJldHVybiBuIHx8IChuID0gIltvYmplY3QgQXJyYXldIiAhPT0gdCAmJiBudWxsICE9PSBlICYmICJvYmplY3QiID09IF90eXBlb2YoZSkgJiYgIm51bWJlciIgPT0gdHlwZW9mIGUubGVuZ3RoICYmIGUubGVuZ3RoID49IDAgJiYgIltvYmplY3QgRnVuY3Rpb25dIiA9PT0gci5jYWxsKGUuY2FsbGVlKSksIG47CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDQ1KSwKICAgICAgICBvID0gbig0NCksCiAgICAgICAgaSA9IG4oNDYpLAogICAgICAgIGEgPSBpKCJTdHJpbmcucHJvdG90eXBlLnJlcGxhY2UiKSwKICAgICAgICBzID0gL15bXHgwOVx4MEFceDBCXHgwQ1x4MERceDIwXHhBMFx1MTY4MFx1MTgwRVx1MjAwMFx1MjAwMVx1MjAwMlx1MjAwM1x1MjAwNFx1MjAwNVx1MjAwNlx1MjAwN1x1MjAwOFx1MjAwOVx1MjAwQVx1MjAyRlx1MjA1Rlx1MzAwMFx1MjAyOFx1MjAyOVx1RkVGRl0rLywKICAgICAgICBsID0gL1tceDA5XHgwQVx4MEJceDBDXHgwRFx4MjBceEEwXHUxNjgwXHUxODBFXHUyMDAwXHUyMDAxXHUyMDAyXHUyMDAzXHUyMDA0XHUyMDA1XHUyMDA2XHUyMDA3XHUyMDA4XHUyMDA5XHUyMDBBXHUyMDJGXHUyMDVGXHUzMDAwXHUyMDI4XHUyMDI5XHVGRUZGXSskLzsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBlID0gbyhyKHRoaXMpKTsKICAgICAgcmV0dXJuIGEoYShlLCBzLCAiIiksIGwsICIiKTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oNCksCiAgICAgICAgbyA9IG4oMSksCiAgICAgICAgaSA9IG8oIiVGdW5jdGlvbiUiKSwKICAgICAgICBhID0gaS5hcHBseSwKICAgICAgICBzID0gaS5jYWxsOwogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gci5hcHBseShzLCBhcmd1bWVudHMpOwogICAgfSwgZS5leHBvcnRzLmFwcGx5ID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gci5hcHBseShhLCBhcmd1bWVudHMpOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbigxMSksCiAgICAgICAgbyA9ICLigIsiOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbSAmJiBvLnRyaW0oKSA9PT0gbyA/IFN0cmluZy5wcm90b3R5cGUudHJpbSA6IHI7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICB2YXIgbjsKCiAgICBuID0gZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0oKTsKCiAgICB0cnkgewogICAgICBuID0gbiB8fCBGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpIHx8ICgwLCBldmFsKSgidGhpcyIpOwogICAgfSBjYXRjaCAoZSkgewogICAgICAib2JqZWN0IiA9PSAodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIgPyAidW5kZWZpbmVkIiA6IF90eXBlb2Yod2luZG93KSkgJiYgKG4gPSB3aW5kb3cpOwogICAgfQoKICAgIGUuZXhwb3J0cyA9IG47CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgYTogWyJ0YXJnZXQiLCAiaHJlZiIsICJ0aXRsZSJdLAogICAgICAgIGFiYnI6IFsidGl0bGUiXSwKICAgICAgICBhZGRyZXNzOiBbXSwKICAgICAgICBhcmVhOiBbInNoYXBlIiwgImNvb3JkcyIsICJocmVmIiwgImFsdCJdLAogICAgICAgIGFydGljbGU6IFtdLAogICAgICAgIGFzaWRlOiBbXSwKICAgICAgICBhdWRpbzogWyJhdXRvcGxheSIsICJjb250cm9scyIsICJsb29wIiwgInByZWxvYWQiLCAic3JjIl0sCiAgICAgICAgYjogW10sCiAgICAgICAgYmRpOiBbImRpciJdLAogICAgICAgIGJkbzogWyJkaXIiXSwKICAgICAgICBiaWc6IFtdLAogICAgICAgIGJsb2NrcXVvdGU6IFsiY2l0ZSJdLAogICAgICAgIGJyOiBbXSwKICAgICAgICBjYXB0aW9uOiBbXSwKICAgICAgICBjZW50ZXI6IFtdLAogICAgICAgIGNpdGU6IFtdLAogICAgICAgIGNvZGU6IFtdLAogICAgICAgIGNvbDogWyJhbGlnbiIsICJ2YWxpZ24iLCAic3BhbiIsICJ3aWR0aCJdLAogICAgICAgIGNvbGdyb3VwOiBbImFsaWduIiwgInZhbGlnbiIsICJzcGFuIiwgIndpZHRoIl0sCiAgICAgICAgZGQ6IFtdLAogICAgICAgIGRlbDogWyJkYXRldGltZSJdLAogICAgICAgIGRldGFpbHM6IFsib3BlbiJdLAogICAgICAgIGRpdjogW10sCiAgICAgICAgZGw6IFtdLAogICAgICAgIGR0OiBbXSwKICAgICAgICBlbTogW10sCiAgICAgICAgZm9udDogWyJjb2xvciIsICJzaXplIiwgImZhY2UiXSwKICAgICAgICBmb290ZXI6IFtdLAogICAgICAgIGgxOiBbXSwKICAgICAgICBoMjogW10sCiAgICAgICAgaDM6IFtdLAogICAgICAgIGg0OiBbXSwKICAgICAgICBoNTogW10sCiAgICAgICAgaDY6IFtdLAogICAgICAgIGhlYWRlcjogW10sCiAgICAgICAgaHI6IFtdLAogICAgICAgIGk6IFtdLAogICAgICAgIGltZzogWyJzcmMiLCAiYWx0IiwgInRpdGxlIiwgIndpZHRoIiwgImhlaWdodCJdLAogICAgICAgIGluczogWyJkYXRldGltZSJdLAogICAgICAgIGxpOiBbXSwKICAgICAgICBtYXJrOiBbXSwKICAgICAgICBuYXY6IFtdLAogICAgICAgIG9sOiBbXSwKICAgICAgICBwOiBbXSwKICAgICAgICBwcmU6IFtdLAogICAgICAgIHM6IFtdLAogICAgICAgIHNlY3Rpb246IFtdLAogICAgICAgIHNtYWxsOiBbXSwKICAgICAgICBzcGFuOiBbXSwKICAgICAgICBzdWI6IFtdLAogICAgICAgIHN1cDogW10sCiAgICAgICAgc3Ryb25nOiBbXSwKICAgICAgICB0YWJsZTogWyJ3aWR0aCIsICJib3JkZXIiLCAiYWxpZ24iLCAidmFsaWduIl0sCiAgICAgICAgdGJvZHk6IFsiYWxpZ24iLCAidmFsaWduIl0sCiAgICAgICAgdGQ6IFsid2lkdGgiLCAicm93c3BhbiIsICJjb2xzcGFuIiwgImFsaWduIiwgInZhbGlnbiJdLAogICAgICAgIHRmb290OiBbImFsaWduIiwgInZhbGlnbiJdLAogICAgICAgIHRoOiBbIndpZHRoIiwgInJvd3NwYW4iLCAiY29sc3BhbiIsICJhbGlnbiIsICJ2YWxpZ24iXSwKICAgICAgICB0aGVhZDogWyJhbGlnbiIsICJ2YWxpZ24iXSwKICAgICAgICB0cjogWyJyb3dzcGFuIiwgImFsaWduIiwgInZhbGlnbiJdLAogICAgICAgIHR0OiBbXSwKICAgICAgICB1OiBbXSwKICAgICAgICB1bDogW10sCiAgICAgICAgdmlkZW86IFsiYXV0b3BsYXkiLCAiY29udHJvbHMiLCAibG9vcCIsICJwcmVsb2FkIiwgInNyYyIsICJoZWlnaHQiLCAid2lkdGgiXQogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIG8oZSwgdCwgbikge30KCiAgICBmdW5jdGlvbiBpKGUsIHQsIG4pIHt9CgogICAgZnVuY3Rpb24gYShlLCB0LCBuKSB7fQoKICAgIGZ1bmN0aW9uIHMoZSwgdCwgbikge30KCiAgICBmdW5jdGlvbiBsKGUpIHsKICAgICAgcmV0dXJuIGUucmVwbGFjZShTLCAiJmx0OyIpLnJlcGxhY2UoTywgIiZndDsiKTsKICAgIH0KCiAgICBmdW5jdGlvbiBjKGUsIHQsIG4sIHIpIHsKICAgICAgaWYgKG4gPSB2KG4pLCAiaHJlZiIgPT09IHQgfHwgInNyYyIgPT09IHQpIHsKICAgICAgICBpZiAoIiMiID09PSAobiA9IF8udHJpbShuKSkpIHJldHVybiAiIyI7CiAgICAgICAgaWYgKCJodHRwOi8vIiAhPT0gbi5zdWJzdHIoMCwgNykgJiYgImh0dHBzOi8vIiAhPT0gbi5zdWJzdHIoMCwgOCkgJiYgIm1haWx0bzoiICE9PSBuLnN1YnN0cigwLCA3KSAmJiAidGVsOiIgIT09IG4uc3Vic3RyKDAsIDQpICYmICIjIiAhPT0gblswXSAmJiAiLyIgIT09IG5bMF0pIHJldHVybiAiIjsKICAgICAgfSBlbHNlIGlmICgiYmFja2dyb3VuZCIgPT09IHQpIHsKICAgICAgICBpZiAoSS5sYXN0SW5kZXggPSAwLCBJLnRlc3QobikpIHJldHVybiAiIjsKICAgICAgfSBlbHNlIGlmICgic3R5bGUiID09PSB0KSB7CiAgICAgICAgaWYgKFAubGFzdEluZGV4ID0gMCwgUC50ZXN0KG4pKSByZXR1cm4gIiI7CiAgICAgICAgaWYgKE0ubGFzdEluZGV4ID0gMCwgTS50ZXN0KG4pICYmIChJLmxhc3RJbmRleCA9IDAsIEkudGVzdChuKSkpIHJldHVybiAiIjsKICAgICAgICAhMSAhPT0gciAmJiAociA9IHIgfHwgQSwgbiA9IHIucHJvY2VzcyhuKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBuID0gZyhuKTsKICAgIH0KCiAgICBmdW5jdGlvbiB1KGUpIHsKICAgICAgcmV0dXJuIGUucmVwbGFjZSgkLCAiJnF1b3Q7Iik7CiAgICB9CgogICAgZnVuY3Rpb24gZChlKSB7CiAgICAgIHJldHVybiBlLnJlcGxhY2UoRSwgJyInKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwKGUpIHsKICAgICAgcmV0dXJuIGUucmVwbGFjZShqLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHJldHVybiAieCIgPT09IHRbMF0gfHwgIlgiID09PSB0WzBdID8gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludCh0LnN1YnN0cigxKSwgMTYpKSA6IFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQodCwgMTApKTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gZihlKSB7CiAgICAgIHJldHVybiBlLnJlcGxhY2UoVCwgIjoiKS5yZXBsYWNlKEMsICIgIik7CiAgICB9CgogICAgZnVuY3Rpb24gaChlKSB7CiAgICAgIGZvciAodmFyIHQgPSAiIiwgbiA9IDAsIHIgPSBlLmxlbmd0aDsgbiA8IHI7IG4rKykgewogICAgICAgIHQgKz0gZS5jaGFyQ29kZUF0KG4pIDwgMzIgPyAiICIgOiBlLmNoYXJBdChuKTsKICAgICAgfQoKICAgICAgcmV0dXJuIF8udHJpbSh0KTsKICAgIH0KCiAgICBmdW5jdGlvbiB2KGUpIHsKICAgICAgcmV0dXJuIGUgPSBkKGUpLCBlID0gcChlKSwgZSA9IGYoZSksIGUgPSBoKGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGcoZSkgewogICAgICByZXR1cm4gZSA9IHUoZSksIGUgPSBsKGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIG0oKSB7CiAgICAgIHJldHVybiAiIjsKICAgIH0KCiAgICBmdW5jdGlvbiB5KGUsIHQpIHsKICAgICAgZnVuY3Rpb24gbih0KSB7CiAgICAgICAgcmV0dXJuICEhciB8fCAtMSAhPT0gXy5pbmRleE9mKGUsIHQpOwogICAgICB9CgogICAgICAiZnVuY3Rpb24iICE9IHR5cGVvZiB0ICYmICh0ID0gZnVuY3Rpb24gdCgpIHt9KTsKICAgICAgdmFyIHIgPSAhQXJyYXkuaXNBcnJheShlKSwKICAgICAgICAgIG8gPSBbXSwKICAgICAgICAgIGkgPSAhMTsKICAgICAgcmV0dXJuIHsKICAgICAgICBvbklnbm9yZVRhZzogZnVuY3Rpb24gb25JZ25vcmVUYWcoZSwgciwgYSkgewogICAgICAgICAgaWYgKG4oZSkpIHsKICAgICAgICAgICAgaWYgKGEuaXNDbG9zaW5nKSB7CiAgICAgICAgICAgICAgdmFyIHMgPSAiWy9yZW1vdmVkXSIsCiAgICAgICAgICAgICAgICAgIGwgPSBhLnBvc2l0aW9uICsgcy5sZW5ndGg7CiAgICAgICAgICAgICAgcmV0dXJuIG8ucHVzaChbITEgIT09IGkgPyBpIDogYS5wb3NpdGlvbiwgbF0pLCBpID0gITEsIHM7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBpIHx8IChpID0gYS5wb3NpdGlvbiksICJbcmVtb3ZlZF0iOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0KGUsIHIsIGEpOwogICAgICAgIH0sCiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoZSkgewogICAgICAgICAgdmFyIHQgPSAiIiwKICAgICAgICAgICAgICBuID0gMDsKICAgICAgICAgIHJldHVybiBfLmZvckVhY2gobywgZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgdCArPSBlLnNsaWNlKG4sIHJbMF0pLCBuID0gclsxXTsKICAgICAgICAgIH0pLCB0ICs9IGUuc2xpY2Uobik7CiAgICAgICAgfQogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIGIoZSkgewogICAgICByZXR1cm4gZS5yZXBsYWNlKFIsICIiKTsKICAgIH0KCiAgICBmdW5jdGlvbiB3KGUpIHsKICAgICAgdmFyIHQgPSBlLnNwbGl0KCIiKTsKICAgICAgcmV0dXJuIHQgPSB0LmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciB0ID0gZS5jaGFyQ29kZUF0KDApOwogICAgICAgIHJldHVybiAxMjcgIT09IHQgJiYgKCEodCA8PSAzMSkgfHwgMTAgPT09IHQgfHwgMTMgPT09IHQpOwogICAgICB9KSwgdC5qb2luKCIiKTsKICAgIH0KCiAgICB2YXIgeCA9IG4oMykuRmlsdGVyQ1NTLAogICAgICAgIGsgPSBuKDMpLmdldERlZmF1bHRXaGl0ZUxpc3QsCiAgICAgICAgXyA9IG4oNSksCiAgICAgICAgQSA9IG5ldyB4KCksCiAgICAgICAgUyA9IC88L2csCiAgICAgICAgTyA9IC8+L2csCiAgICAgICAgJCA9IC8iL2csCiAgICAgICAgRSA9IC8mcXVvdDsvZywKICAgICAgICBqID0gLyYjKFthLXpBLVowLTldKik7Py9naW0sCiAgICAgICAgVCA9IC8mY29sb247Py9naW0sCiAgICAgICAgQyA9IC8mbmV3bGluZTs/L2dpbSwKICAgICAgICBJID0gLygoalxzKmFccyp2XHMqYXx2XHMqYnxsXHMqaVxzKnZccyplKVxzKnNccypjXHMqclxzKmlccypwXHMqdFxzKnxtXHMqb1xzKmNccypoXHMqYSlcOi9naSwKICAgICAgICBQID0gL2Vccyp4XHMqcFxzKnJccyplXHMqc1xzKnNccyppXHMqb1xzKm5ccypcKC4qL2dpLAogICAgICAgIE0gPSAvdVxzKnJccypsXHMqXCguKi9naSwKICAgICAgICBSID0gLzwhLS1bXHNcU10qPy0tPi9nOwoKICAgIHQud2hpdGVMaXN0ID0gcigpLCB0LmdldERlZmF1bHRXaGl0ZUxpc3QgPSByLCB0Lm9uVGFnID0gbywgdC5vbklnbm9yZVRhZyA9IGksIHQub25UYWdBdHRyID0gYSwgdC5vbklnbm9yZVRhZ0F0dHIgPSBzLCB0LnNhZmVBdHRyVmFsdWUgPSBjLCB0LmVzY2FwZUh0bWwgPSBsLCB0LmVzY2FwZVF1b3RlID0gdSwgdC51bmVzY2FwZVF1b3RlID0gZCwgdC5lc2NhcGVIdG1sRW50aXRpZXMgPSBwLCB0LmVzY2FwZURhbmdlckh0bWw1RW50aXRpZXMgPSBmLCB0LmNsZWFyTm9uUHJpbnRhYmxlQ2hhcmFjdGVyID0gaCwgdC5mcmllbmRseUF0dHJWYWx1ZSA9IHYsIHQuZXNjYXBlQXR0clZhbHVlID0gZywgdC5vbklnbm9yZVRhZ1N0cmlwQWxsID0gbSwgdC5TdHJpcFRhZ0JvZHkgPSB5LCB0LnN0cmlwQ29tbWVudFRhZyA9IGIsIHQuc3RyaXBCbGFua0NoYXIgPSB3LCB0LmNzc0ZpbHRlciA9IEEsIHQuZ2V0RGVmYXVsdENTU1doaXRlTGlzdCA9IGs7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICB2YXIgdCA9IGQuc3BhY2VJbmRleChlKTsKICAgICAgaWYgKC0xID09PSB0KSB2YXIgbiA9IGUuc2xpY2UoMSwgLTEpO2Vsc2UgdmFyIG4gPSBlLnNsaWNlKDEsIHQgKyAxKTsKICAgICAgcmV0dXJuIG4gPSBkLnRyaW0obikudG9Mb3dlckNhc2UoKSwgIi8iID09PSBuLnNsaWNlKDAsIDEpICYmIChuID0gbi5zbGljZSgxKSksICIvIiA9PT0gbi5zbGljZSgtMSkgJiYgKG4gPSBuLnNsaWNlKDAsIC0xKSksIG47CiAgICB9CgogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIHJldHVybiAiPC8iID09PSBlLnNsaWNlKDAsIDIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSwgdCwgbikgewogICAgICAidXNlciBzdHJpY3QiOwoKICAgICAgdmFyIGkgPSAiIiwKICAgICAgICAgIGEgPSAwLAogICAgICAgICAgcyA9ICExLAogICAgICAgICAgbCA9ICExLAogICAgICAgICAgYyA9IDAsCiAgICAgICAgICB1ID0gZS5sZW5ndGgsCiAgICAgICAgICBkID0gIiIsCiAgICAgICAgICBwID0gIiI7CgogICAgICBmb3IgKGMgPSAwOyBjIDwgdTsgYysrKSB7CiAgICAgICAgdmFyIGYgPSBlLmNoYXJBdChjKTsKCiAgICAgICAgaWYgKCExID09PSBzKSB7CiAgICAgICAgICBpZiAoIjwiID09PSBmKSB7CiAgICAgICAgICAgIHMgPSBjOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKCExID09PSBsKSB7CiAgICAgICAgICBpZiAoIjwiID09PSBmKSB7CiAgICAgICAgICAgIGkgKz0gbihlLnNsaWNlKGEsIGMpKSwgcyA9IGMsIGEgPSBjOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIj4iID09PSBmKSB7CiAgICAgICAgICAgIGkgKz0gbihlLnNsaWNlKGEsIHMpKSwgcCA9IGUuc2xpY2UocywgYyArIDEpLCBkID0gcihwKSwgaSArPSB0KHMsIGkubGVuZ3RoLCBkLCBwLCBvKHApKSwgYSA9IGMgKyAxLCBzID0gITE7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICgoJyInID09PSBmIHx8ICInIiA9PT0gZikgJiYgIj0iID09PSBlLmNoYXJBdChjIC0gMSkpIHsKICAgICAgICAgICAgbCA9IGY7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZiA9PT0gbCkgewogICAgICAgICAgbCA9ICExOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gYSA8IGUubGVuZ3RoICYmIChpICs9IG4oZS5zdWJzdHIoYSkpKSwgaTsKICAgIH0KCiAgICBmdW5jdGlvbiBhKGUsIHQpIHsKICAgICAgInVzZXIgc3RyaWN0IjsKCiAgICAgIGZ1bmN0aW9uIG4oZSwgbikgewogICAgICAgIGlmIChlID0gZC50cmltKGUpLCBlID0gZS5yZXBsYWNlKHAsICIiKS50b0xvd2VyQ2FzZSgpLCAhKGUubGVuZ3RoIDwgMSkpIHsKICAgICAgICAgIHZhciByID0gdChlLCBuIHx8ICIiKTsKICAgICAgICAgIHIgJiYgby5wdXNoKHIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yICh2YXIgciA9IDAsIG8gPSBbXSwgaSA9ICExLCBhID0gZS5sZW5ndGgsIGMgPSAwOyBjIDwgYTsgYysrKSB7CiAgICAgICAgdmFyIGYsCiAgICAgICAgICAgIGgsCiAgICAgICAgICAgIHYgPSBlLmNoYXJBdChjKTsKICAgICAgICBpZiAoITEgIT09IGkgfHwgIj0iICE9PSB2KSB7CiAgICAgICAgICBpZiAoITEgPT09IGkgfHwgYyAhPT0gciB8fCAnIicgIT09IHYgJiYgIiciICE9PSB2IHx8ICI9IiAhPT0gZS5jaGFyQXQoYyAtIDEpKSB7CiAgICAgICAgICAgIGlmICgvXHN8XG58XHQvLnRlc3QodikpIHsKICAgICAgICAgICAgICBpZiAoZSA9IGUucmVwbGFjZSgvXHN8XG58XHQvZywgIiAiKSwgITEgPT09IGkpIHsKICAgICAgICAgICAgICAgIGlmICgtMSA9PT0gKGggPSBzKGUsIGMpKSkgewogICAgICAgICAgICAgICAgICBmID0gZC50cmltKGUuc2xpY2UociwgYykpLCBuKGYpLCBpID0gITEsIHIgPSBjICsgMTsKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYyA9IGggLSAxOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAoLTEgPT09IChoID0gbChlLCBjIC0gMSkpKSB7CiAgICAgICAgICAgICAgICBmID0gZC50cmltKGUuc2xpY2UociwgYykpLCBmID0gdShmKSwgbihpLCBmKSwgaSA9ICExLCByID0gYyArIDE7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSA7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoLTEgPT09IChoID0gZS5pbmRleE9mKHYsIGMgKyAxKSkpIGJyZWFrOwogICAgICAgICAgICBmID0gZC50cmltKGUuc2xpY2UociArIDEsIGgpKSwgbihpLCBmKSwgaSA9ICExLCBjID0gaCwgciA9IGMgKyAxOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpID0gZS5zbGljZShyLCBjKSwgciA9IGMgKyAxOwogICAgICB9CgogICAgICByZXR1cm4gciA8IGUubGVuZ3RoICYmICghMSA9PT0gaSA/IG4oZS5zbGljZShyKSkgOiBuKGksIHUoZC50cmltKGUuc2xpY2UocikpKSkpLCBkLnRyaW0oby5qb2luKCIgIikpOwogICAgfQoKICAgIGZ1bmN0aW9uIHMoZSwgdCkgewogICAgICBmb3IgKDsgdCA8IGUubGVuZ3RoOyB0KyspIHsKICAgICAgICB2YXIgbiA9IGVbdF07CiAgICAgICAgaWYgKCIgIiAhPT0gbikgcmV0dXJuICI9IiA9PT0gbiA/IHQgOiAtMTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGwoZSwgdCkgewogICAgICBmb3IgKDsgdCA+IDA7IHQtLSkgewogICAgICAgIHZhciBuID0gZVt0XTsKICAgICAgICBpZiAoIiAiICE9PSBuKSByZXR1cm4gIj0iID09PSBuID8gdCA6IC0xOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYyhlKSB7CiAgICAgIHJldHVybiAnIicgPT09IGVbMF0gJiYgJyInID09PSBlW2UubGVuZ3RoIC0gMV0gfHwgIiciID09PSBlWzBdICYmICInIiA9PT0gZVtlLmxlbmd0aCAtIDFdOwogICAgfQoKICAgIGZ1bmN0aW9uIHUoZSkgewogICAgICByZXR1cm4gYyhlKSA/IGUuc3Vic3RyKDEsIGUubGVuZ3RoIC0gMikgOiBlOwogICAgfQoKICAgIHZhciBkID0gbig1KSwKICAgICAgICBwID0gL1teYS16QS1aMC05XzpcLlwtXS9naW07CiAgICB0LnBhcnNlVGFnID0gaSwgdC5wYXJzZUF0dHIgPSBhOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICB2YXIgciwgbywgaTsKICAgIC8qIQogICAgYXV0b3NpemUgNC4wLjIKICAgIGxpY2Vuc2U6IE1JVAogICAgaHR0cDovL3d3dy5qYWNrbG1vb3JlLmNvbS9hdXRvc2l6ZQogICAgKi8KCiAgICAhZnVuY3Rpb24gKG4sIGEpIHsKICAgICAgbyA9IFtlLCB0XSwgciA9IGEsIHZvaWQgMCAhPT0gKGkgPSAiZnVuY3Rpb24iID09IHR5cGVvZiByID8gci5hcHBseSh0LCBvKSA6IHIpICYmIChlLmV4cG9ydHMgPSBpKTsKICAgIH0oMCwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgZnVuY3Rpb24gbihlKSB7CiAgICAgICAgZnVuY3Rpb24gdCh0KSB7CiAgICAgICAgICB2YXIgbiA9IGUuc3R5bGUud2lkdGg7CiAgICAgICAgICBlLnN0eWxlLndpZHRoID0gIjBweCIsIGUub2Zmc2V0V2lkdGgsIGUuc3R5bGUud2lkdGggPSBuLCBlLnN0eWxlLm92ZXJmbG93WSA9IHQ7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBuKGUpIHsKICAgICAgICAgIGZvciAodmFyIHQgPSBbXTsgZSAmJiBlLnBhcmVudE5vZGUgJiYgZS5wYXJlbnROb2RlIGluc3RhbmNlb2YgRWxlbWVudDspIHsKICAgICAgICAgICAgZS5wYXJlbnROb2RlLnNjcm9sbFRvcCAmJiB0LnB1c2goewogICAgICAgICAgICAgIG5vZGU6IGUucGFyZW50Tm9kZSwKICAgICAgICAgICAgICBzY3JvbGxUb3A6IGUucGFyZW50Tm9kZS5zY3JvbGxUb3AKICAgICAgICAgICAgfSksIGUgPSBlLnBhcmVudE5vZGU7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByKCkgewogICAgICAgICAgaWYgKDAgIT09IGUuc2Nyb2xsSGVpZ2h0KSB7CiAgICAgICAgICAgIHZhciB0ID0gbihlKSwKICAgICAgICAgICAgICAgIHIgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKICAgICAgICAgICAgZS5zdHlsZS5oZWlnaHQgPSAiIiwgZS5zdHlsZS5oZWlnaHQgPSBlLnNjcm9sbEhlaWdodCArIHMgKyAicHgiLCBsID0gZS5jbGllbnRXaWR0aCwgdC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgZS5ub2RlLnNjcm9sbFRvcCA9IGUuc2Nyb2xsVG9wOwogICAgICAgICAgICB9KSwgciAmJiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IHIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbygpIHsKICAgICAgICAgIHIoKTsKICAgICAgICAgIHZhciBuID0gTWF0aC5yb3VuZChwYXJzZUZsb2F0KGUuc3R5bGUuaGVpZ2h0KSksCiAgICAgICAgICAgICAgbyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGUsIG51bGwpLAogICAgICAgICAgICAgIGkgPSAiY29udGVudC1ib3giID09PSBvLmJveFNpemluZyA/IE1hdGgucm91bmQocGFyc2VGbG9hdChvLmhlaWdodCkpIDogZS5vZmZzZXRIZWlnaHQ7CgogICAgICAgICAgaWYgKGkgPCBuID8gImhpZGRlbiIgPT09IG8ub3ZlcmZsb3dZICYmICh0KCJzY3JvbGwiKSwgcigpLCBpID0gImNvbnRlbnQtYm94IiA9PT0gby5ib3hTaXppbmcgPyBNYXRoLnJvdW5kKHBhcnNlRmxvYXQod2luZG93LmdldENvbXB1dGVkU3R5bGUoZSwgbnVsbCkuaGVpZ2h0KSkgOiBlLm9mZnNldEhlaWdodCkgOiAiaGlkZGVuIiAhPT0gby5vdmVyZmxvd1kgJiYgKHQoImhpZGRlbiIpLCByKCksIGkgPSAiY29udGVudC1ib3giID09PSBvLmJveFNpemluZyA/IE1hdGgucm91bmQocGFyc2VGbG9hdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlLCBudWxsKS5oZWlnaHQpKSA6IGUub2Zmc2V0SGVpZ2h0KSwgYyAhPT0gaSkgewogICAgICAgICAgICBjID0gaTsKICAgICAgICAgICAgdmFyIHMgPSBhKCJhdXRvc2l6ZTpyZXNpemVkIik7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGUuZGlzcGF0Y2hFdmVudChzKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChlICYmIGUubm9kZU5hbWUgJiYgIlRFWFRBUkVBIiA9PT0gZS5ub2RlTmFtZSAmJiAhaS5oYXMoZSkpIHsKICAgICAgICAgIHZhciBzID0gbnVsbCwKICAgICAgICAgICAgICBsID0gbnVsbCwKICAgICAgICAgICAgICBjID0gbnVsbCwKICAgICAgICAgICAgICB1ID0gZnVuY3Rpb24gdSgpIHsKICAgICAgICAgICAgZS5jbGllbnRXaWR0aCAhPT0gbCAmJiBvKCk7CiAgICAgICAgICB9LAogICAgICAgICAgICAgIGQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdSwgITEpLCBlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImlucHV0IiwgbywgITEpLCBlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImtleXVwIiwgbywgITEpLCBlLnJlbW92ZUV2ZW50TGlzdGVuZXIoImF1dG9zaXplOmRlc3Ryb3kiLCBkLCAhMSksIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcigiYXV0b3NpemU6dXBkYXRlIiwgbywgITEpLCBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7CiAgICAgICAgICAgICAgZS5zdHlsZVtuXSA9IHRbbl07CiAgICAgICAgICAgIH0pLCBpWyJkZWxldGUiXShlKTsKICAgICAgICAgIH0uYmluZChlLCB7CiAgICAgICAgICAgIGhlaWdodDogZS5zdHlsZS5oZWlnaHQsCiAgICAgICAgICAgIHJlc2l6ZTogZS5zdHlsZS5yZXNpemUsCiAgICAgICAgICAgIG92ZXJmbG93WTogZS5zdHlsZS5vdmVyZmxvd1ksCiAgICAgICAgICAgIG92ZXJmbG93WDogZS5zdHlsZS5vdmVyZmxvd1gsCiAgICAgICAgICAgIHdvcmRXcmFwOiBlLnN0eWxlLndvcmRXcmFwCiAgICAgICAgICB9KTsKCiAgICAgICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoImF1dG9zaXplOmRlc3Ryb3kiLCBkLCAhMSksICJvbnByb3BlcnR5Y2hhbmdlIiBpbiBlICYmICJvbmlucHV0IiBpbiBlICYmIGUuYWRkRXZlbnRMaXN0ZW5lcigia2V5dXAiLCBvLCAhMSksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLCB1LCAhMSksIGUuYWRkRXZlbnRMaXN0ZW5lcigiaW5wdXQiLCBvLCAhMSksIGUuYWRkRXZlbnRMaXN0ZW5lcigiYXV0b3NpemU6dXBkYXRlIiwgbywgITEpLCBlLnN0eWxlLm92ZXJmbG93WCA9ICJoaWRkZW4iLCBlLnN0eWxlLndvcmRXcmFwID0gImJyZWFrLXdvcmQiLCBpLnNldChlLCB7CiAgICAgICAgICAgIGRlc3Ryb3k6IGQsCiAgICAgICAgICAgIHVwZGF0ZTogbwogICAgICAgICAgfSksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlLCBudWxsKTsKICAgICAgICAgICAgInZlcnRpY2FsIiA9PT0gdC5yZXNpemUgPyBlLnN0eWxlLnJlc2l6ZSA9ICJub25lIiA6ICJib3RoIiA9PT0gdC5yZXNpemUgJiYgKGUuc3R5bGUucmVzaXplID0gImhvcml6b250YWwiKSwgcyA9ICJjb250ZW50LWJveCIgPT09IHQuYm94U2l6aW5nID8gLShwYXJzZUZsb2F0KHQucGFkZGluZ1RvcCkgKyBwYXJzZUZsb2F0KHQucGFkZGluZ0JvdHRvbSkpIDogcGFyc2VGbG9hdCh0LmJvcmRlclRvcFdpZHRoKSArIHBhcnNlRmxvYXQodC5ib3JkZXJCb3R0b21XaWR0aCksIGlzTmFOKHMpICYmIChzID0gMCksIG8oKTsKICAgICAgICAgIH0oKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHIoZSkgewogICAgICAgIHZhciB0ID0gaS5nZXQoZSk7CiAgICAgICAgdCAmJiB0LmRlc3Ryb3koKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgICAgdmFyIHQgPSBpLmdldChlKTsKICAgICAgICB0ICYmIHQudXBkYXRlKCk7CiAgICAgIH0KCiAgICAgIHZhciBpID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgTWFwID8gbmV3IE1hcCgpIDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBlID0gW10sCiAgICAgICAgICAgIHQgPSBbXTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgaGFzOiBmdW5jdGlvbiBoYXModCkgewogICAgICAgICAgICByZXR1cm4gZS5pbmRleE9mKHQpID4gLTE7CiAgICAgICAgICB9LAogICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQobikgewogICAgICAgICAgICByZXR1cm4gdFtlLmluZGV4T2YobildOwogICAgICAgICAgfSwKICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KG4sIHIpIHsKICAgICAgICAgICAgLTEgPT09IGUuaW5kZXhPZihuKSAmJiAoZS5wdXNoKG4pLCB0LnB1c2gocikpOwogICAgICAgICAgfSwKICAgICAgICAgICJkZWxldGUiOiBmdW5jdGlvbiBfZGVsZXRlKG4pIHsKICAgICAgICAgICAgdmFyIHIgPSBlLmluZGV4T2Yobik7CiAgICAgICAgICAgIHIgPiAtMSAmJiAoZS5zcGxpY2UociwgMSksIHQuc3BsaWNlKHIsIDEpKTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9KCksCiAgICAgICAgICBhID0gZnVuY3Rpb24gYShlKSB7CiAgICAgICAgcmV0dXJuIG5ldyBFdmVudChlLCB7CiAgICAgICAgICBidWJibGVzOiAhMAogICAgICAgIH0pOwogICAgICB9OwoKICAgICAgdHJ5IHsKICAgICAgICBuZXcgRXZlbnQoInRlc3QiKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIGEgPSBmdW5jdGlvbiBhKGUpIHsKICAgICAgICAgIHZhciB0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkV2ZW50Iik7CiAgICAgICAgICByZXR1cm4gdC5pbml0RXZlbnQoZSwgITAsICExKSwgdDsKICAgICAgICB9OwogICAgICB9CgogICAgICB2YXIgcyA9IG51bGw7CiAgICAgICJ1bmRlZmluZWQiID09IHR5cGVvZiB3aW5kb3cgfHwgImZ1bmN0aW9uIiAhPSB0eXBlb2Ygd2luZG93LmdldENvbXB1dGVkU3R5bGUgPyAocyA9IGZ1bmN0aW9uIHMoZSkgewogICAgICAgIHJldHVybiBlOwogICAgICB9LCBzLmRlc3Ryb3kgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlOwogICAgICB9LCBzLnVwZGF0ZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgcmV0dXJuIGU7CiAgICAgIH0pIDogKHMgPSBmdW5jdGlvbiBzKGUsIHQpIHsKICAgICAgICByZXR1cm4gZSAmJiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGUubGVuZ3RoID8gZSA6IFtlXSwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBuKGUpOwogICAgICAgIH0pLCBlOwogICAgICB9LCBzLmRlc3Ryb3kgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlICYmIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZS5sZW5ndGggPyBlIDogW2VdLCByKSwgZTsKICAgICAgfSwgcy51cGRhdGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHJldHVybiBlICYmIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZS5sZW5ndGggPyBlIDogW2VdLCBvKSwgZTsKICAgICAgfSksIHRbImRlZmF1bHQiXSA9IHMsIGUuZXhwb3J0cyA9IHRbImRlZmF1bHQiXTsKICAgIH0pOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7CiAgICAgICAgImRlZmF1bHQiOiBlCiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIHJldHVybiAhIWUgJiYgdGhpcy5pbml0KGUpLCB0aGlzOwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSkgewogICAgICByZXR1cm4gbmV3IG8oZSk7CiAgICB9CgogICAgdmFyIGEgPSBuKDI2KSwKICAgICAgICBzID0gcihhKSwKICAgICAgICBsID0gbigxNyksCiAgICAgICAgYyA9IHIobCksCiAgICAgICAgdSA9IG4oMjApLAogICAgICAgIGQgPSByKHUpLAogICAgICAgIHAgPSBuKDYpLAogICAgICAgIGYgPSByKHApLAogICAgICAgIGggPSBuKDIpLAogICAgICAgIHYgPSBuKDI0KSwKICAgICAgICBnID0gcih2KSwKICAgICAgICBtID0gbigwKSwKICAgICAgICB5ID0gcihtKSwKICAgICAgICBiID0gbigyMiksCiAgICAgICAgdyA9IHIoYiksCiAgICAgICAgeCA9IG4oMTkpLAogICAgICAgIGsgPSByKHgpLAogICAgICAgIF8gPSBuKDIzKSwKICAgICAgICBBID0gbigyNSksCiAgICAgICAgUyA9IHIoQSksCiAgICAgICAgTyA9IG4oMjEpLAogICAgICAgICQgPSByKE8pLAogICAgICAgIEUgPSB7CiAgICAgIGNvbW1lbnQ6ICIiLAogICAgICBuaWNrOiAiIiwKICAgICAgbWFpbDogIiIsCiAgICAgIGxpbms6ICIiLAogICAgICB1YTogeVsiZGVmYXVsdCJdLnVhLAogICAgICB1cmw6ICIiLAogICAgICBRUUF2YXRhcjogIiIKICAgIH0sCiAgICAgICAgaiA9ICIiLAogICAgICAgIFQgPSB7CiAgICAgIGNkbjogImh0dHBzOi8vZ3JhdmF0YXIubG9saS5uZXQvYXZhdGFyLyIsCiAgICAgIGRzOiBbIm1wIiwgImlkZW50aWNvbiIsICJtb25zdGVyaWQiLCAid2F2YXRhciIsICJyb2JvaGFzaCIsICJyZXRybyIsICIiXSwKICAgICAgcGFyYW1zOiAiIiwKICAgICAgaGlkZTogITEKICAgIH07CgogICAgby5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIGlmICgidW5kZWZpbmVkIiA9PSB0eXBlb2YgZG9jdW1lbnQpIHRocm93IG5ldyBFcnJvcigiU29ycnksIFZhbGluZSBkb2VzIG5vdCBzdXBwb3J0IFNlcnZlci1zaWRlIHJlbmRlcmluZy4iKTsKICAgICAgdmFyIHQgPSB0aGlzOwogICAgICByZXR1cm4gZSAmJiAoZSA9IHlbImRlZmF1bHQiXS5leHRlbmQoaC5kZWZhdWx0Q29uZmlnLCBlKSwgdC5pMThuID0gKDAsIGRbImRlZmF1bHQiXSkoZS5sYW5nIHx8IHlbImRlZmF1bHQiXS5sYW5nLCBlLmxhbmdNb2RlKSwgdC5jb25maWcgPSBlLCBmWyJkZWZhdWx0Il0ubWFwcyA9ICEhZS5lbW9qaU1hcHMgJiYgZS5lbW9qaU1hcHMgfHwgZlsiZGVmYXVsdCJdLm1hcHMsIGZbImRlZmF1bHQiXS5jZG4gPSAhIWUuZW1vamlDRE4gJiYgZS5lbW9qaUNETiB8fCBmWyJkZWZhdWx0Il0uY2RuLCB0Ll9pbml0KCkpLCB0OwogICAgfSwgby5wcm90b3R5cGUuX2luaXQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBlID0gdGhpczsKCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIHQgPSBlLmNvbmZpZywKICAgICAgICAgICAgbiA9IHQuYXZhdGFyLAogICAgICAgICAgICByID0gdC5hdmF0YXJGb3JjZSwKICAgICAgICAgICAgbyA9IHQuYXZhdGFyX2NkbiwKICAgICAgICAgICAgaSA9IHQudmlzaXRvciwKICAgICAgICAgICAgYSA9IHQucGF0aCwKICAgICAgICAgICAgcyA9IHZvaWQgMCA9PT0gYSA/IGxvY2F0aW9uLnBhdGhuYW1lIDogYSwKICAgICAgICAgICAgbCA9IHQucGFnZVNpemUsCiAgICAgICAgICAgIGMgPSB0LnJlY29yZElQOwogICAgICAgIGUuY29uZmlnLnBhdGggPSBzLnJlcGxhY2UoL2luZGV4XC5odG1sPyQvLCAiIik7CiAgICAgICAgdmFyIHUgPSBULmRzLAogICAgICAgICAgICBkID0gciA/ICImcT0iICsgaC5SYW5kb21TdHIgOiAiIjsKICAgICAgICBULnBhcmFtcyA9ICI/ZD0iICsgKHUuaW5kZXhPZihuKSA+IC0xID8gbiA6ICJtcCIpICsgIiZ2PSIgKyBoLlZFUlNJT04gKyBkLCBULmhpZGUgPSAiaGlkZSIgPT09IG4sIFQuY2RuID0gL15odHRwcz9cOlwvXC8vLnRlc3QobykgPyBvIDogVC5jZG4sIGUuY29uZmlnLnBhZ2VTaXplID0gaXNOYU4obCkgPyAxMCA6IGwgPCAxID8gMTAgOiBsLCBjICYmICgwLCBfLnJlY29yZElQRm4pKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gRS5pcCA9IGU7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIHAgPSBlLmNvbmZpZy5lbCB8fCBudWxsLAogICAgICAgICAgICBmID0gKDAsIHlbImRlZmF1bHQiXSkocCk7CgogICAgICAgIGlmIChwID0gcCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ID8gcCA6IGZbZi5sZW5ndGggLSAxXSB8fCBudWxsKSB7CiAgICAgICAgICBlLiRlbCA9ICgwLCB5WyJkZWZhdWx0Il0pKHApLCBlLiRlbC5hZGRDbGFzcygidiIpLmF0dHIoImRhdGEtY2xhc3MiLCAidiIpLCBULmhpZGUgJiYgZS4kZWwuYWRkQ2xhc3MoImhpZGUtYXZhdGFyIiksIGUuY29uZmlnLm1ldGEgPSAoZS5jb25maWcuZ3Vlc3RfaW5mbyB8fCBlLmNvbmZpZy5tZXRhIHx8IGguZGVmYXVsdE1ldGEpLmZpbHRlcihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICByZXR1cm4gaC5kZWZhdWx0TWV0YS5pbmRleE9mKGUpID4gLTE7CiAgICAgICAgICB9KSwgZS5jb25maWcucmVxdWlyZWRGaWVsZHMgPSBlLmNvbmZpZy5yZXF1aXJlZEZpZWxkcy5maWx0ZXIoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgcmV0dXJuIGguZGVmYXVsdE1ldGEuaW5kZXhPZihlKSA+IC0xOwogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgdiA9ICgwID09IGUuY29uZmlnLm1ldGEubGVuZ3RoID8gaC5kZWZhdWx0TWV0YSA6IGUuY29uZmlnLm1ldGEpLm1hcChmdW5jdGlvbiAodCkgewogICAgICAgICAgICB2YXIgbiA9ICJtYWlsIiA9PSB0ID8gImVtYWlsIiA6ICJ0ZXh0IjsKICAgICAgICAgICAgcmV0dXJuIGguZGVmYXVsdE1ldGEuaW5kZXhPZih0KSA+IC0xID8gJzxpbnB1dCBuYW1lPSInICsgdCArICciIHBsYWNlaG9sZGVyPSInICsgZS5pMThuLnQodCkgKyAnIiBjbGFzcz0idicgKyB0ICsgJyB2aW5wdXQiIHR5cGU9IicgKyBuICsgJyI+JyA6ICIiOwogICAgICAgICAgfSksCiAgICAgICAgICAgICAgZyA9ICc8ZGl2IGNsYXNzPSJ2cGFuZWwiPjxkaXYgY2xhc3M9InZ3cmFwIj48cCBjbGFzcz0iY2FuY2VsLXJlcGx5IHRleHQtcmlnaHQiIHN0eWxlPSJkaXNwbGF5Om5vbmU7IiB0aXRsZT0iJyArIGUuaTE4bi50KCJjYW5jZWxSZXBseSIpICsgJyI+PHN2ZyBjbGFzcz0idmljb24gY2FuY2VsLXJlcGx5LWJ0biIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQyMjAiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PHBhdGggZD0iTTc5Ni40NTQgOTg1SDIyNy41NDVjLTUwLjE4MyAwLTk3LjQ4MS0xOS42NjItMTMzLjE4My01NS4zNjMtMzUuNy0zNS43MDEtNTUuMzYyLTgzLTU1LjM2Mi0xMzMuMTgzVjIyNy41NDVjMC01MC4xODMgMTkuNjYyLTk3LjQ4MSA1NS4zNjMtMTMzLjE4MyAzNS43MDEtMzUuNyA4My01NS4zNjIgMTMzLjE4Mi01NS4zNjJoNTY4LjkwOWM1MC4xODMgMCA5Ny40ODEgMTkuNjYyIDEzMy4xODMgNTUuMzYzIDM1LjcwMSAzNS43MDIgNTUuMzYzIDgzIDU1LjM2MyAxMzMuMTgzdjU2OC45MDljMCA1MC4xODMtMTkuNjYyIDk3LjQ4MS01NS4zNjMgMTMzLjE4M1M4NDYuNjM3IDk4NSA3OTYuNDU0IDk4NXpNMjI3LjU0NSA5MUMxNTIuMjU0IDkxIDkxIDE1Mi4yNTQgOTEgMjI3LjU0NXY1NjguOTA5QzkxIDg3MS43NDYgMTUyLjI1NCA5MzMgMjI3LjU0NSA5MzNoNTY4LjkwOUM4NzEuNzQ2IDkzMyA5MzMgODcxLjc0NiA5MzMgNzk2LjQ1NFYyMjcuNTQ1QzkzMyAxNTIuMjU0IDg3MS43NDYgOTEgNzk2LjQ1NCA5MUgyMjcuNTQ1eiIgcC1pZD0iNDIyMSI+PC9wYXRoPjxwYXRoIGQ9Ik01NjguNTY5IDUxMmwxNzAuMjY3LTE3MC4yNjdjMTUuNTU2LTE1LjU1NiAxNS41NTYtNDEuMDEyIDAtNTYuNTY5cy00MS4wMTItMTUuNTU2LTU2LjU2OSAwTDUxMiA0NTUuNDMxIDM0MS43MzMgMjg1LjE2NWMtMTUuNTU2LTE1LjU1Ni00MS4wMTItMTUuNTU2LTU2LjU2OSAwcy0xNS41NTYgNDEuMDEyIDAgNTYuNTY5TDQ1NS40MzEgNTEyIDI4NS4xNjUgNjgyLjI2N2MtMTUuNTU2IDE1LjU1Ni0xNS41NTYgNDEuMDEyIDAgNTYuNTY5IDE1LjU1NiAxNS41NTYgNDEuMDEyIDE1LjU1NiA1Ni41NjkgMEw1MTIgNTY4LjU2OWwxNzAuMjY3IDE3MC4yNjdjMTUuNTU2IDE1LjU1NiA0MS4wMTIgMTUuNTU2IDU2LjU2OSAwIDE1LjU1Ni0xNS41NTYgMTUuNTU2LTQxLjAxMiAwLTU2LjU2OUw1NjguNTY5IDUxMnoiIHAtaWQ9IjQyMjIiID48L3BhdGg+PC9zdmc+PC9wPjxkaXYgY2xhc3M9InZoZWFkZXIgaXRlbScgKyB2Lmxlbmd0aCArICciPicgKyB2LmpvaW4oIiIpICsgJzwvZGl2PjxkaXYgY2xhc3M9InZlZGl0Ij48dGV4dGFyZWEgaWQ9InZlZGl0b3IiIGNsYXNzPSJ2ZWRpdG9yIHZpbnB1dCIgcGxhY2Vob2xkZXI9IicgKyBlLmNvbmZpZy5wbGFjZWhvbGRlciArICciPjwvdGV4dGFyZWE+PGRpdiBjbGFzcz0idnJvdyI+PGRpdiBjbGFzcz0idmNvbCB2Y29sLTYwIHN0YXR1cy1iYXIiPjwvZGl2PjxkaXYgY2xhc3M9InZjb2wgdmNvbC00MCB2Y3RybCB0ZXh0LXJpZ2h0Ij48c3BhbiB0aXRsZT0iJyArIGUuaTE4bi50KCJlbW9qaSIpICsgJyIgIGNsYXNzPSJ2aWNvbiB2ZW1vamktYnRuIj48c3ZnICB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgcC1pZD0iMTYxNzIiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgPjxwYXRoIGQ9Ik01MTIgMTAyNGE1MTIgNTEyIDAgMSAxIDUxMi01MTIgNTEyIDUxMiAwIDAgMS01MTIgNTEyek01MTIgNTYuODg4ODg5YTQ1NS4xMTExMTEgNDU1LjExMTExMSAwIDEgMCA0NTUuMTExMTExIDQ1NS4xMTExMTEgNDU1LjExMTExMSA0NTUuMTExMTExIDAgMCAwLTQ1NS4xMTExMTEtNDU1LjExMTExMXpNMzEyLjg4ODg4OSA1MTJBODUuMzMzMzMzIDg1LjMzMzMzMyAwIDEgMSAzOTguMjIyMjIyIDQyNi42NjY2NjcgODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMSAzMTIuODg4ODg5IDUxMnoiIHAtaWQ9IjE2MTczIj48L3BhdGg+PHBhdGggZD0iTTUxMiA3NjhBMTQyLjIyMjIyMiAxNDIuMjIyMjIyIDAgMCAxIDM2OS43Nzc3NzggNjI1Ljc3Nzc3OGEyOC40NDQ0NDQgMjguNDQ0NDQ0IDAgMCAxIDU2Ljg4ODg4OSAwIDg1LjMzMzMzMyA4NS4zMzMzMzMgMCAwIDAgMTcwLjY2NjY2NiAwIDI4LjQ0NDQ0NCAyOC40NDQ0NDQgMCAwIDEgNTYuODg4ODg5IDBBMTQyLjIyMjIyMiAxNDIuMjIyMjIyIDAgMCAxIDUxMiA3Njh6IiBwLWlkPSIxNjE3NCI+PC9wYXRoPjxwYXRoIGQ9Ik03ODIuMjIyMjIyIDM5MS45NjQ0NDRsLTExMy43Nzc3NzggNTkuNzMzMzM0YTI5LjAxMzMzMyAyOS4wMTMzMzMgMCAwIDEtMzguNjg0NDQ0LTEwLjgwODg4OSAyOC40NDQ0NDQgMjguNDQ0NDQ0IDAgMCAxIDEwLjI0LTM4LjY4NDQ0NWwxMTMuNzc3Nzc4LTU2Ljg4ODg4OGEyOC40NDQ0NDQgMjguNDQ0NDQ0IDAgMCAxIDM4LjY4NDQ0NCAxMC4yNCAyOC40NDQ0NDQgMjguNDQ0NDQ0IDAgMCAxLTEwLjI0IDM2LjQwODg4OHoiIHAtaWQ9IjE2MTc1Ij48L3BhdGg+PHBhdGggZD0iTTY0MC41Njg4ODkgNDUxLjY5Nzc3OGwxMTMuNzc3Nzc4IDU2Ljg4ODg4OWEyNy44NzU1NTYgMjcuODc1NTU2IDAgMCAwIDM4LjY4NDQ0NC0xMC4yNCAyNy44NzU1NTYgMjcuODc1NTU2IDAgMCAwLTEwLjI0LTM4LjY4NDQ0NWwtMTEzLjc3Nzc3OC01Ni44ODg4ODlhMjguNDQ0NDQ0IDI4LjQ0NDQ0NCAwIDAgMC0zOC42ODQ0NDQgMTAuODA4ODg5IDI4LjQ0NDQ0NCAyOC40NDQ0NDQgMCAwIDAgMTAuMjQgMzguMTE1NTU2eiIgcC1pZD0iMTYxNzYiPjwvcGF0aD48L3N2Zz48L3NwYW4+PHNwYW4gdGl0bGU9IicgKyBlLmkxOG4udCgicHJldmlldyIpICsgJyIgY2xhc3M9InZpY29uIHZwcmV2aWV3LWJ0biI+PHN2ZyAgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE3Njg4IiB3aWR0aD0iMjIiIGhlaWdodD0iMjIiPjxwYXRoIGQ9Ik01MDIuMzkwMTU0IDkzNS4zODQ2MTVhMjkuNTM4NDYyIDI5LjUzODQ2MiAwIDEgMSAwIDU5LjA3NjkyM0gxNDEuNDMwMTU0Qzc5LjkxMTM4NSA5OTQuNDYxNTM4IDI5LjUzODQ2MiA5NDYuMjU0NzY5IDI5LjUzODQ2MiA4ODYuMTUzODQ2VjEzNy44NDYxNTRDMjkuNTM4NDYyIDc3Ljc0NTIzMSA3OS45NTA3NjkgMjkuNTM4NDYyIDE0MS4zOTA3NjkgMjkuNTM4NDYyaDc0MS4yMTg0NjJjNjEuNDQgMCAxMTEuODUyMzA4IDQ4LjIwNjc2OSAxMTEuODUyMzA3IDEwOC4zMDc2OTJ2MzAwLjI2ODMwOGEyOS41Mzg0NjIgMjkuNTM4NDYyIDAgMSAxLTU5LjA3NjkyMyAwVjEzNy44NDYxNTRjMC0yNi44OTk2OTItMjMuMzU1MDc3LTQ5LjIzMDc2OS01Mi43NzUzODQtNDkuMjMwNzY5SDE0MS4zOTA3NjljLTI5LjQyMDMwOCAwLTUyLjc3NTM4NSAyMi4zMzEwNzctNTIuNzc1Mzg0IDQ5LjIzMDc2OXY3NDguMzA3NjkyYzAgMjYuODk5NjkyIDIzLjM1NTA3NyA0OS4yMzA3NjkgNTIuNzc1Mzg0IDQ5LjIzMDc2OWgzNjAuOTk5Mzg1eiIgcC1pZD0iMTc2ODkiPjwvcGF0aD48cGF0aCBkPSJNMTk2LjkyMzA3NyAyMTYuNjE1Mzg1bTI5LjUzODQ2MSAwbDM3NC4xNTM4NDcgMHEyOS41Mzg0NjIgMCAyOS41Mzg0NjEgMjkuNTM4NDYxbDAgMHEwIDI5LjUzODQ2Mi0yOS41Mzg0NjEgMjkuNTM4NDYybC0zNzQuMTUzODQ3IDBxLTI5LjUzODQ2MiAwLTI5LjUzODQ2MS0yOS41Mzg0NjJsMCAwcTAtMjkuNTM4NDYyIDI5LjUzODQ2MS0yOS41Mzg0NjFaIiBwLWlkPSIxNzY5MCI+PC9wYXRoPjxwYXRoIGQ9Ik02NDkuODQ2MTU0IDg0Ni43NjkyMzFhMjE2LjYxNTM4NSAyMTYuNjE1Mzg1IDAgMSAwIDAtNDMzLjIzMDc2OSAyMTYuNjE1Mzg1IDIxNi42MTUzODUgMCAwIDAgMCA0MzMuMjMwNzY5eiBtMCA1OS4wNzY5MjNhMjc1LjY5MjMwOCAyNzUuNjkyMzA4IDAgMSAxIDAtNTUxLjM4NDYxNiAyNzUuNjkyMzA4IDI3NS42OTIzMDggMCAwIDEgMCA1NTEuMzg0NjE2eiIgcC1pZD0iMTc2OTEiPjwvcGF0aD48cGF0aCBkPSJNODA3LjM5ODM4MyA4MjkuNDc5NzY4bTIwLjg4Njg0Ny0yMC44ODY4NDZsMCAwcTIwLjg4Njg0Ni0yMC44ODY4NDYgNDEuNzczNjkyIDBsMTI1LjMyMTA3OSAxMjUuMzIxMDc5cTIwLjg4Njg0NiAyMC44ODY4NDYgMCA0MS43NzM2OTNsMCAwcS0yMC44ODY4NDYgMjAuODg2ODQ2LTQxLjc3MzY5MyAwbC0xMjUuMzIxMDc4LTEyNS4zMjEwNzlxLTIwLjg4Njg0Ni0yMC44ODY4NDYgMC00MS43NzM2OTNaIiBwLWlkPSIxNzY5MiI+PC9wYXRoPjwvc3ZnPjwvc3Bhbj48L2Rpdj48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPSJ2cm93Ij48ZGl2IGNsYXNzPSJ2Y29sIHZjb2wtMzAiID48YSBhbHQ9Ik1hcmtkb3duIGlzIHN1cHBvcnRlZCIgaHJlZj0iaHR0cHM6Ly9ndWlkZXMuZ2l0aHViLmNvbS9mZWF0dXJlcy9tYXN0ZXJpbmctbWFya2Rvd24vIiBjbGFzcz0idmljb24iIHRhcmdldD0iX2JsYW5rIj48c3ZnIGNsYXNzPSJtYXJrZG93biIgdmlld0JveD0iMCAwIDE2IDE2IiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgYXJpYS1oaWRkZW49InRydWUiPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTE0Ljg1IDNIMS4xNUMuNTIgMyAwIDMuNTIgMCA0LjE1djcuNjlDMCAxMi40OC41MiAxMyAxLjE1IDEzaDEzLjY5Yy42NCAwIDEuMTUtLjUyIDEuMTUtMS4xNXYtNy43QzE2IDMuNTIgMTUuNDggMyAxNC44NSAzek05IDExSDdWOEw1LjUgOS45MiA0IDh2M0gyVjVoMmwxLjUgMkw3IDVoMnY2em0yLjk5LjVMOS41IDhIMTFWNWgydjNoMS41bC0yLjUxIDMuNXoiPjwvcGF0aD48L3N2Zz48L2E+PC9kaXY+PGRpdiBjbGFzcz0idmNvbCB2Y29sLTcwIHRleHQtcmlnaHQiPjxidXR0b24gdHlwZT0iYnV0dG9uIiAgdGl0bGU9IkNtZHxDdHJsK0VudGVyIiBjbGFzcz0idnN1Ym1pdCB2YnRuIj4nICsgZS5pMThuLnQoInN1Ym1pdCIpICsgJzwvYnV0dG9uPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9InZlbW9qaXMiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij48L2Rpdj48ZGl2IGNsYXNzPSJ2aW5wdXQgdnByZXZpZXciIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij48L2Rpdj48ZGl2IHN0eWxlPSJkaXNwbGF5Om5vbmU7IiBjbGFzcz0idm1hcmsiPjwvZGl2PjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9InZjb3VudCIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjxzcGFuIGNsYXNzPSJ2bnVtIj4wPC9zcGFuPiAnICsgZS5pMThuLnQoImNvbW1lbnRzIikgKyAnPC9kaXY+PGRpdiBjbGFzcz0idmxvYWQtdG9wIHRleHQtY2VudGVyIiBzdHlsZT0iZGlzcGxheTpub25lOyI+PGkgY2xhc3M9InZzcGlubmVyIiBzdHlsZT0id2lkdGg6MzBweDtoZWlnaHQ6MzBweDsiPjwvaT48L2Rpdj48ZGl2IGNsYXNzPSJ2Y2FyZHMiPjwvZGl2PjxkaXYgY2xhc3M9InZsb2FkLWJvdHRvbSB0ZXh0LWNlbnRlciIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjxpIGNsYXNzPSJ2c3Bpbm5lciIgc3R5bGU9IndpZHRoOjMwcHg7aGVpZ2h0OjMwcHg7Ij48L2k+PC9kaXY+PGRpdiBjbGFzcz0idmVtcHR5IiBzdHlsZT0iZGlzcGxheTpub25lOyI+PC9kaXY+PGRpdiBjbGFzcz0idnBhZ2UgdHh0LWNlbnRlciIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+PGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJ2bW9yZSB2YnRuIj4nICsgZS5pMThuLnQoIm1vcmUiKSArICc8L2J1dHRvbj48L2Rpdj48ZGl2IGNsYXNzPSJ2cG93ZXIgdHh0LXJpZ2h0Ij5Qb3dlcmVkIEJ5IDxhIGhyZWY9Imh0dHBzOi8vdmFsaW5lLmpzLm9yZyIgdGFyZ2V0PSJfYmxhbmsiPlZhbGluZTwvYT48YnI+dicgKyBoLlZFUlNJT04gKyAiPC9kaXY+IjsKICAgICAgICAgIGUuJGVsLmh0bWwoZyksIGUuJGVsLmZpbmQoIi5jYW5jZWwtcmVwbHkiKS5vbigiY2xpY2siLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICBlLnJlc2V0KCk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBtID0gZS4kZWwuZmluZCgiLnZlbXB0eSIpOwogICAgICAgICAgZS4kbm9kYXRhID0gewogICAgICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KHQpIHsKICAgICAgICAgICAgICByZXR1cm4gbS5odG1sKHQgfHwgZS5pMThuLnQoInNvZmEiKSkuc2hvdygpLCBlOwogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlOiBmdW5jdGlvbiBoaWRlKCkgewogICAgICAgICAgICAgIHJldHVybiBtLmhpZGUoKSwgZTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICAgIHZhciBiID0gZS4kZWwuZmluZCgiLnZsb2FkLWJvdHRvbSIpLAogICAgICAgICAgICAgIHcgPSBlLiRlbC5maW5kKCIudmxvYWQtdG9wIik7CiAgICAgICAgICBlLiRsb2FkaW5nID0gewogICAgICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KHQpIHsKICAgICAgICAgICAgICByZXR1cm4gdCAmJiB3LnNob3coKSB8fCBiLnNob3coKSwgZS4kbm9kYXRhLmhpZGUoKSwgZTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGlkZTogZnVuY3Rpb24gaGlkZSgpIHsKICAgICAgICAgICAgICByZXR1cm4gdy5oaWRlKCksIGIuaGlkZSgpLCAwID09PSBlLiRlbC5maW5kKCIudmNhcmQiKS5sZW5ndGggJiYgZS4kbm9kYXRhLnNob3coKSwgZTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgICgwLCBrWyJkZWZhdWx0Il0pKGUuY29uZmlnLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgdmFyIG4gPSAoMCwgeVsiZGVmYXVsdCJdKSgiLnZhbGluZS1jb21tZW50LWNvdW50IiksCiAgICAgICAgICAgICAgciA9IDA7CiAgICAgICAgICAhZnVuY3Rpb24gdChuKSB7CiAgICAgICAgICAgIHZhciBvID0gbltyKytdOwoKICAgICAgICAgICAgaWYgKG8pIHsKICAgICAgICAgICAgICB2YXIgaSA9ICgwLCB5WyJkZWZhdWx0Il0pKG8pLmF0dHIoImRhdGEteGlkIik7CiAgICAgICAgICAgICAgISFpICYmIGUuUShpKS5jb3VudCgpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIG8uaW5uZXJUZXh0ID0gZSwgdChuKTsKICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgby5pbm5lclRleHQgPSAwOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KG4pLCBpICYmIEkuYWRkKEFWLk9iamVjdC5leHRlbmQoIkNvdW50ZXIiKSwgZS5jb25maWcucGF0aCksIGUuJGVsICYmIGUuYmluZCgpOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgKDAsICRbImRlZmF1bHQiXSkoZSwgdCwgImluaXQiKTsKICAgICAgfQogICAgfTsKCiAgICB2YXIgQyA9IGZ1bmN0aW9uIEMoZSwgdCkgewogICAgICB2YXIgbiA9IG5ldyBlKCksCiAgICAgICAgICByID0gbmV3IEFWLkFDTCgpOwogICAgICByLnNldFB1YmxpY1JlYWRBY2Nlc3MoITApLCByLnNldFB1YmxpY1dyaXRlQWNjZXNzKCEwKSwgbi5zZXRBQ0wociksIG4uc2V0KCJ1cmwiLCB0LnVybCksIG4uc2V0KCJ4aWQiLCB0LnhpZCksIG4uc2V0KCJ0aXRsZSIsIHQudGl0bGUpLCBuLnNldCgidGltZSIsIDEpLCBuLnNhdmUoKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgKDAsIHlbImRlZmF1bHQiXSkodC5lbCkuZmluZCgiLmxlYW5jbG91ZC12aXNpdG9ycy1jb3VudCIpLnRleHQoMSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlKSB7fSk7CiAgICB9LAogICAgICAgIEkgPSB7CiAgICAgIGFkZDogZnVuY3Rpb24gYWRkKGUsIHQpIHsKICAgICAgICB2YXIgbiA9IHRoaXMsCiAgICAgICAgICAgIHIgPSAoMCwgeVsiZGVmYXVsdCJdKSgiLmxlYW5jbG91ZF92aXNpdG9ycywubGVhbmNsb3VkLXZpc2l0b3JzIik7CgogICAgICAgIGlmICgxID09PSByLmxlbmd0aCkgewogICAgICAgICAgdmFyIG8gPSByWzBdLAogICAgICAgICAgICAgIGkgPSBkZWNvZGVVUkkoKDAsIHlbImRlZmF1bHQiXSkobykuYXR0cigiaWQiKSksCiAgICAgICAgICAgICAgYSA9ICgwLCB5WyJkZWZhdWx0Il0pKG8pLmF0dHIoImRhdGEtZmxhZy10aXRsZSIpLAogICAgICAgICAgICAgIHMgPSBlbmNvZGVVUkkoaSksCiAgICAgICAgICAgICAgbCA9IHsKICAgICAgICAgICAgZWw6IG8sCiAgICAgICAgICAgIHVybDogaSwKICAgICAgICAgICAgeGlkOiBzLAogICAgICAgICAgICB0aXRsZTogYQogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAoZGVjb2RlVVJJKGkpID09PSBkZWNvZGVVUkkodCkpIHsKICAgICAgICAgICAgdmFyIGMgPSBuZXcgQVYuUXVlcnkoZSk7CiAgICAgICAgICAgIGMuZXF1YWxUbygidXJsIiwgaSksIGMuZmluZCgpLnRoZW4oZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpZiAodC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHRbMF07CiAgICAgICAgICAgICAgICBuLmluY3JlbWVudCgidGltZSIpLCBuLnNhdmUoKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICgwLCB5WyJkZWZhdWx0Il0pKG8pLmZpbmQoIi5sZWFuY2xvdWQtdmlzaXRvcnMtY291bnQiKS50ZXh0KGUuZ2V0KCJ0aW1lIikpOwogICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGUpIHt9KTsKICAgICAgICAgICAgICB9IGVsc2UgQyhlLCBsKTsKICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAxMDEgPT0gdC5jb2RlID8gQyhlLCBsKSA6ICgwLCAkWyJkZWZhdWx0Il0pKG4sIHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSBJLnNob3coZSwgcik7CiAgICAgICAgfSBlbHNlIEkuc2hvdyhlLCByKTsKICAgICAgfSwKICAgICAgc2hvdzogZnVuY3Rpb24gc2hvdyhlLCB0KSB7CiAgICAgICAgdmFyIG4gPSBbXTsKCiAgICAgICAgaWYgKHQuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgdmFyIHQgPSAoMCwgeVsiZGVmYXVsdCJdKShlKS5maW5kKCIubGVhbmNsb3VkLXZpc2l0b3JzLWNvdW50Iik7CiAgICAgICAgICB0ICYmIHQudGV4dCgiMCIpLCBuLnB1c2goL1wlLy50ZXN0KCgwLCB5WyJkZWZhdWx0Il0pKGUpLmF0dHIoImlkIikpID8gZGVjb2RlVVJJKCgwLCB5WyJkZWZhdWx0Il0pKGUpLmF0dHIoImlkIikpIDogKDAsIHlbImRlZmF1bHQiXSkoZSkuYXR0cigiaWQiKSk7CiAgICAgICAgfSksIG4ubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgciA9IG5ldyBBVi5RdWVyeShlKTsKICAgICAgICAgIHIuY29udGFpbmVkSW4oInVybCIsIG4pLCByLmZpbmQoKS50aGVuKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGUubGVuZ3RoID4gMCAmJiB0LmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBlLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIHZhciBuID0gZS5nZXQoInhpZCIpIHx8IGVuY29kZVVSSShlLmdldCgidXJsIikpLAogICAgICAgICAgICAgICAgICAgIHIgPSBlLmdldCgidGltZSIpLAogICAgICAgICAgICAgICAgICAgIG8gPSAoMCwgeVsiZGVmYXVsdCJdKSh0KSwKICAgICAgICAgICAgICAgICAgICBpID0gby5hdHRyKCJpZCIpOwoKICAgICAgICAgICAgICAgIGlmICgoL1wlLy50ZXN0KGkpID8gaSA6IGVuY29kZVVSSShpKSkgPT0gbikgewogICAgICAgICAgICAgICAgICB2YXIgYSA9IG8uZmluZCgiLmxlYW5jbG91ZC12aXNpdG9ycy1jb3VudCIpOwogICAgICAgICAgICAgICAgICBhICYmIGEudGV4dChyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZSkge30pOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBvLnByb3RvdHlwZS5RID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgbiA9IGFyZ3VtZW50cy5sZW5ndGgsCiAgICAgICAgICByID0gdC5jb25maWcuY2xhenpOYW1lOwoKICAgICAgaWYgKDEgPT0gbikgewogICAgICAgIHZhciBvID0gbmV3IEFWLlF1ZXJ5KHIpOwogICAgICAgIG8uZG9lc05vdEV4aXN0KCJyaWQiKTsKICAgICAgICB2YXIgaSA9IG5ldyBBVi5RdWVyeShyKTsKICAgICAgICBpLmVxdWFsVG8oInJpZCIsICIiKTsKICAgICAgICB2YXIgYSA9IEFWLlF1ZXJ5Lm9yKG8sIGkpOwogICAgICAgIHJldHVybiAiKiIgPT09IGUgPyBhLmV4aXN0cygidXJsIikgOiBhLmVxdWFsVG8oInVybCIsIGRlY29kZVVSSShlKSksIGEuYWRkRGVzY2VuZGluZygiY3JlYXRlZEF0IiksIGEuYWRkRGVzY2VuZGluZygiaW5zZXJ0ZWRBdCIpLCBhOwogICAgICB9CgogICAgICB2YXIgcyA9IEpTT04uc3RyaW5naWZ5KGFyZ3VtZW50c1sxXSkucmVwbGFjZSgvKFxbfFxdKS9nLCAiIiksCiAgICAgICAgICBsID0gInNlbGVjdCAqIGZyb20gIiArIHIgKyAiIHdoZXJlIHJpZCBpbiAoIiArIHMgKyAiKSBvcmRlciBieSAtY3JlYXRlZEF0LC1jcmVhdGVkQXQiOwogICAgICByZXR1cm4gQVYuUXVlcnkuZG9DbG91ZFF1ZXJ5KGwpOwogICAgfSwgby5wcm90b3R5cGUuaW5zdGFsbExvY2FsZSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHZhciBuID0gdGhpczsKICAgICAgcmV0dXJuIG4uaTE4bihlLCB0KSwgbjsKICAgIH0sIG8ucHJvdG90eXBlLnNldFBhdGggPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gdGhpcy5jb25maWcucGF0aCA9IGUsIHRoaXM7CiAgICB9LCBvLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKCkgewogICAgICB2YXIgZSA9IHRoaXMsCiAgICAgICAgICB0ID0gZS4kZWwuZmluZCgiLnZlbW9qaXMiKSwKICAgICAgICAgIG4gPSBlLiRlbC5maW5kKCIudnByZXZpZXciKSwKICAgICAgICAgIHIgPSBlLiRlbC5maW5kKCIudmVtb2ppLWJ0biIpLAogICAgICAgICAgbyA9IGUuJGVsLmZpbmQoIi52cHJldmlldy1idG4iKSwKICAgICAgICAgIGkgPSBlLiRlbC5maW5kKCIudmVkaXRvciIpLAogICAgICAgICAgYSA9IGZbImRlZmF1bHQiXS5tYXBzLAogICAgICAgICAgbCA9ICExLAogICAgICAgICAgdSA9IGZ1bmN0aW9uIHUoZSkgewogICAgICAgIHZhciBuID0gW107CgogICAgICAgIGZvciAodmFyIHIgaW4gYSkgewogICAgICAgICAgYS5oYXNPd25Qcm9wZXJ0eShyKSAmJiAhIWZbImRlZmF1bHQiXS5idWlsZChyKSAmJiBuLnB1c2goJzxpIHRpdGxlPSInICsgciArICciID4nICsgZlsiZGVmYXVsdCJdLmJ1aWxkKHIpICsgIjwvaT4iKTsKICAgICAgICB9CgogICAgICAgIHQuaHRtbChuLmpvaW4oIiIpKSwgbCA9ICEwLCB0LmZpbmQoImkiKS5vbigiY2xpY2siLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpLCB4KGlbMF0sICIgOiIgKyAoMCwgeVsiZGVmYXVsdCJdKSh0aGlzKS5hdHRyKCJ0aXRsZSIpICsgIjoiKTsKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIGUuJGVtb2ppID0gewogICAgICAgIHNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgICAgICByZXR1cm4gIWwgJiYgdSgpLCBlLiRwcmV2aWV3LmhpZGUoKSwgdC5zaG93KCksIHIuYWRkQ2xhc3MoImFjdGl2ZWQiKSwgZS4kZW1vamk7CiAgICAgICAgfSwKICAgICAgICBoaWRlOiBmdW5jdGlvbiBoaWRlKCkgewogICAgICAgICAgcmV0dXJuIHIucmVtb3ZlQ2xhc3MoImFjdGl2ZWQiKSwgdC5oaWRlKCksIGUuJGVtb2ppOwogICAgICAgIH0KICAgICAgfSwgZS4kcHJldmlldyA9IHsKICAgICAgICBzaG93OiBmdW5jdGlvbiBzaG93KCkgewogICAgICAgICAgcmV0dXJuIGogPyAoZS4kZW1vamkuaGlkZSgpLCBvLmFkZENsYXNzKCJhY3RpdmVkIiksIG4uaHRtbChqKS5zaG93KCksIE0oKSkgOiBlLiRwcmV2aWV3LmhpZGUoKSwgZS4kcHJldmlldzsKICAgICAgICB9LAogICAgICAgIGhpZGU6IGZ1bmN0aW9uIGhpZGUoKSB7CiAgICAgICAgICByZXR1cm4gby5yZW1vdmVDbGFzcygiYWN0aXZlZCIpLCBuLmhpZGUoKS5odG1sKCIiKSwgZS4kcHJldmlldzsKICAgICAgICB9CiAgICAgIH07CgogICAgICB2YXIgZCA9IGZ1bmN0aW9uIGQodCkgewogICAgICAgIHZhciByID0gKDAsIHdbImRlZmF1bHQiXSkodC52YWwoKSB8fCAiIik7CiAgICAgICAgciB8fCBlLiRwcmV2aWV3LmhpZGUoKSwgaiAhPSByICYmIChqID0gciwgby5oYXNDbGFzcygiYWN0aXZlZCIpID4gLTEgJiYgaiAhPSBuLmh0bWwoKSAmJiBuLmh0bWwoaiksICgwLCBjWyJkZWZhdWx0Il0pKHRbMF0pLCBNKCkpOwogICAgICB9OwoKICAgICAgci5vbigiY2xpY2siLCBmdW5jdGlvbiAodCkgewogICAgICAgIHIuaGFzQ2xhc3MoImFjdGl2ZWQiKSA/IGUuJGVtb2ppLmhpZGUoKSA6IGUuJGVtb2ppLnNob3coKTsKICAgICAgfSksIG8ub24oImNsaWNrIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICBvLmhhc0NsYXNzKCJhY3RpdmVkIikgPyBlLiRwcmV2aWV3LmhpZGUoKSA6IGUuJHByZXZpZXcuc2hvdygpOwogICAgICB9KTsKICAgICAgdmFyIHAgPSBlLmNvbmZpZy5tZXRhLAogICAgICAgICAgdiA9IHt9LAogICAgICAgICAgbSA9IHsKICAgICAgICB2ZWRpdG9yOiAiY29tbWVudCIKICAgICAgfTsKICAgICAgcC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgbVsidiIgKyBlXSA9IGU7CiAgICAgIH0pOwoKICAgICAgZm9yICh2YXIgYiBpbiBtKSB7CiAgICAgICAgbS5oYXNPd25Qcm9wZXJ0eShiKSAmJiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgdCA9IG1bYl0sCiAgICAgICAgICAgICAgbiA9IGUuJGVsLmZpbmQoIi4iICsgYik7CiAgICAgICAgICB2W3RdID0gbiwgbi5vbigiaW5wdXQgY2hhbmdlIGJsdXIgcHJvcGVydHljaGFuZ2UiLCBmdW5jdGlvbiAocikgewogICAgICAgICAgICBlLmNvbmZpZy5lbmFibGVRUSAmJiAiYmx1ciIgPT09IHIudHlwZSAmJiAibmljayIgPT09IHQgJiYgKGlzTmFOKG4udmFsKCkpID8geVsiZGVmYXVsdCJdLnN0b3JlLmdldChoLlFRQ2FjaGVLZXkpICYmIHlbImRlZmF1bHQiXS5zdG9yZS5nZXQoaC5RUUNhY2hlS2V5KS5uaWNrICE9IG4udmFsKCkgJiYgKHlbImRlZmF1bHQiXS5zdG9yZS5yZW1vdmUoaC5RUUNhY2hlS2V5KSwgRS5uaWNrID0gbi52YWwoKSwgRS5tYWlsID0gIiIsIEUuUVFBdmF0YXIgPSAiIikgOiAoMCwgXy5mZXRjaFFRRm4pKG4udmFsKCksIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgdmFyIHQgPSBlLm5pY2sgfHwgbi52YWwoKSwKICAgICAgICAgICAgICAgICAgciA9IGUucXEgKyAiQHFxLmNvbSI7CiAgICAgICAgICAgICAgKDAsIHlbImRlZmF1bHQiXSkoIi52bmljayIpLnZhbCh0KSwgKDAsIHlbImRlZmF1bHQiXSkoIi52bWFpbCIpLnZhbChyKSwgRS5uaWNrID0gdCwgRS5tYWlsID0gciwgRS5RUUF2YXRhciA9IGUucGljOwogICAgICAgICAgICB9KSksICJjb21tZW50IiA9PT0gdCA/IGQobikgOiBFW3RdID0geVsiZGVmYXVsdCJdLmVzY2FwZShuLnZhbCgpLnJlcGxhY2UoLyheXHMqKXwoXHMqJCkvZywgIiIpKS5zdWJzdHJpbmcoMCwgNDApOwogICAgICAgICAgfSk7CiAgICAgICAgfSgpOwogICAgICB9CgogICAgICB2YXIgeCA9IGZ1bmN0aW9uIHgoZSwgdCkgewogICAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHsKICAgICAgICAgIGUuZm9jdXMoKTsKICAgICAgICAgIGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLnRleHQgPSB0LCBlLmZvY3VzKCk7CiAgICAgICAgfSBlbHNlIGlmIChlLnNlbGVjdGlvblN0YXJ0IHx8ICIwIiA9PSBlLnNlbGVjdGlvblN0YXJ0KSB7CiAgICAgICAgICB2YXIgbiA9IGUuc2VsZWN0aW9uU3RhcnQsCiAgICAgICAgICAgICAgciA9IGUuc2VsZWN0aW9uRW5kLAogICAgICAgICAgICAgIG8gPSBlLnNjcm9sbFRvcDsKICAgICAgICAgIGUudmFsdWUgPSBlLnZhbHVlLnN1YnN0cmluZygwLCBuKSArIHQgKyBlLnZhbHVlLnN1YnN0cmluZyhyLCBlLnZhbHVlLmxlbmd0aCksIGUuZm9jdXMoKSwgZS5zZWxlY3Rpb25TdGFydCA9IG4gKyB0Lmxlbmd0aCwgZS5zZWxlY3Rpb25FbmQgPSBuICsgdC5sZW5ndGgsIGUuc2Nyb2xsVG9wID0gbzsKICAgICAgICB9IGVsc2UgZS5mb2N1cygpLCBlLnZhbHVlICs9IHQ7CgogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIGQoKDAsIHlbImRlZmF1bHQiXSkoZSkpOwogICAgICAgIH0sIDEwMCk7CiAgICAgIH0sCiAgICAgICAgICBrID0gewogICAgICAgIG5vOiAxLAogICAgICAgIHNpemU6IGUuY29uZmlnLnBhZ2VTaXplLAogICAgICAgIHNraXA6IGUuY29uZmlnLnBhZ2VTaXplCiAgICAgIH0sCiAgICAgICAgICBBID0gZS4kZWwuZmluZCgiLnZwYWdlIik7CgogICAgICBBLm9uKCJjbGljayIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgQS5oaWRlKCksIGsubm8rKywgTygpOwogICAgICB9KTsKCiAgICAgIHZhciBPID0gZnVuY3Rpb24gTygpIHsKICAgICAgICB2YXIgdCA9IGsuc2l6ZSwKICAgICAgICAgICAgbiA9IGsubm8sCiAgICAgICAgICAgIHIgPSBOdW1iZXIoZS4kZWwuZmluZCgiLnZudW0iKS50ZXh0KCkpOwogICAgICAgIGUuJGxvYWRpbmcuc2hvdygpOwogICAgICAgIHZhciBvID0gZS5RKGUuY29uZmlnLnBhdGgpOwogICAgICAgIG8ubGltaXQodCksIG8uc2tpcCgobiAtIDEpICogdCksIG8uZmluZCgpLnRoZW4oZnVuY3Rpb24gKG8pIHsKICAgICAgICAgIGlmIChrLnNraXAgPSBrLnNpemUsIG8gJiYgby5sZW5ndGgpIHsKICAgICAgICAgICAgdmFyIGkgPSBbXTsKICAgICAgICAgICAgby5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgaS5wdXNoKHQuaWQpLCBDKHQsIGUuJGVsLmZpbmQoIi52Y2FyZHMiKSwgITApOwogICAgICAgICAgICB9KSwgZS5RKGUuY29uZmlnLnBhdGgsIGkpLnRoZW4oZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAoZSAmJiBlLnJlc3VsdHMgfHwgW10pLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIEMoZSwgKDAsIHlbImRlZmF1bHQiXSkoJy52cXVvdGVbZGF0YS1zZWxmLWlkPSInICsgZS5nZXQoInJpZCIpICsgJyJdJykpOwogICAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlKSB7fSk7CiAgICAgICAgICAgIH0pLCB0ICogbiA8IHIgPyBBLnNob3coKSA6IEEuaGlkZSgpOwogICAgICAgICAgfSBlbHNlIGUuJG5vZGF0YS5zaG93KCk7CgogICAgICAgICAgZS4kbG9hZGluZy5oaWRlKCk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIGUuJGxvYWRpbmcuaGlkZSgpLCAoMCwgJFsiZGVmYXVsdCJdKShlLCB0LCAicXVlcnkiKTsKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIGUuUShlLmNvbmZpZy5wYXRoKS5jb3VudCgpLnRoZW4oZnVuY3Rpb24gKHQpIHsKICAgICAgICB0ID4gMCA/IChlLiRlbC5maW5kKCIudmNvdW50Iikuc2hvdygpLmZpbmQoIi52bnVtIikudGV4dCh0KSwgTygpKSA6IGUuJGxvYWRpbmcuaGlkZSgpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAodCkgewogICAgICAgICgwLCAkWyJkZWZhdWx0Il0pKGUsIHQsICJjb3VudCIpOwogICAgICB9KTsKCiAgICAgIHZhciBDID0gZnVuY3Rpb24gQyh0LCBuLCByKSB7CiAgICAgICAgdmFyIG8gPSAoMCwgeVsiZGVmYXVsdCJdKSgnPGRpdiBjbGFzcz0idmNhcmQiIGlkPSInICsgdC5pZCArICciPjwvZGl2PicpLAogICAgICAgICAgICBpID0gdC5nZXQoInVhIiksCiAgICAgICAgICAgIGEgPSAiIjsKICAgICAgICBpICYmICEvamEvLnRlc3QoZS5jb25maWcubGFuZykgJiYgKGkgPSB5WyJkZWZhdWx0Il0uZGV0ZWN0KGkpLCBhID0gJzxzcGFuIGNsYXNzPSJ2c3lzIj4nICsgaS5icm93c2VyICsgIiAiICsgaS52ZXJzaW9uICsgJzwvc3Bhbj4gPHNwYW4gY2xhc3M9InZzeXMiPicgKyBpLm9zICsgIiAiICsgaS5vc1ZlcnNpb24gKyAiPC9zcGFuPiIpLCAiKiIgPT09IGUuY29uZmlnLnBhdGggJiYgKGEgPSAnPGEgaHJlZj0iJyArIHQuZ2V0KCJ1cmwiKSArICciIGNsYXNzPSJ2c3lzIj4nICsgdC5nZXQoInVybCIpICsgIjwvYT4iKTsKICAgICAgICB2YXIgbCA9IHQuZ2V0KCJsaW5rIikgPyAvXmh0dHBzP1w6XC9cLy8udGVzdCh0LmdldCgibGluayIpKSA/IHQuZ2V0KCJsaW5rIikgOiAiaHR0cDovLyIgKyB0LmdldCgibGluayIpIDogIiIsCiAgICAgICAgICAgIGMgPSBsID8gJzxhIGNsYXNzPSJ2bmljayIgcmVsPSJub2ZvbGxvdyIgaHJlZj0iJyArIGwgKyAnIiB0YXJnZXQ9Il9ibGFuayIgPicgKyB0LmdldCgibmljayIpICsgIjwvYT4iIDogJzxzcGFuIGNsYXNzPSJ2bmljayI+JyArIHQuZ2V0KCJuaWNrIikgKyAiPC9zcGFuPiIsCiAgICAgICAgICAgIHUgPSBULmhpZGUgPyAiIiA6IGUuY29uZmlnLmVuYWJsZVFRICYmIHQuZ2V0KCJRUUF2YXRhciIpID8gJzxpbWcgY2xhc3M9InZpbWciIHNyYz0iJyArIHQuZ2V0KCJRUUF2YXRhciIpICsgJyIgcmVmZXJyZXJQb2xpY3k9Im5vLXJlZmVycmVyIi8+JyA6ICc8aW1nIGNsYXNzPSJ2aW1nIiBzcmM9IicgKyAoVC5jZG4gKyAoMCwgc1siZGVmYXVsdCJdKSh0LmdldCgibWFpbCIpKSArIFQucGFyYW1zKSArICciPicsCiAgICAgICAgICAgIGQgPSB1ICsgJzxkaXYgY2xhc3M9InZoIj48ZGl2IGNsYXNzPSJ2aGVhZCI+JyArIGMgKyAiICIgKyBhICsgJzwvZGl2PjxkaXYgY2xhc3M9InZtZXRhIj48c3BhbiBjbGFzcz0idnRpbWUiID4nICsgKDAsIGdbImRlZmF1bHQiXSkodC5nZXQoImluc2VydGVkQXQiKSwgZS5pMThuKSArICc8L3NwYW4+PHNwYW4gY2xhc3M9InZhdCIgZGF0YS12bS1pZD0iJyArICh0LmdldCgicmlkIikgfHwgdC5pZCkgKyAnIiBkYXRhLXNlbGYtaWQ9IicgKyB0LmlkICsgJyI+JyArIGUuaTE4bi50KCJyZXBseSIpICsgJzwvc3Bhbj48L2Rpdj48ZGl2IGNsYXNzPSJ2Y29udGVudCIgZGF0YS1leHBhbmQ9IicgKyBlLmkxOG4udCgiZXhwYW5kIikgKyAnIj4nICsgKDAsIFNbImRlZmF1bHQiXSkodC5nZXQoImNvbW1lbnQiKSkgKyAnPC9kaXY+PGRpdiBjbGFzcz0idnJlcGx5LXdyYXBwZXIiIGRhdGEtc2VsZi1pZD0iJyArIHQuaWQgKyAnIj48L2Rpdj48ZGl2IGNsYXNzPSJ2cXVvdGUiIGRhdGEtc2VsZi1pZD0iJyArIHQuaWQgKyAnIj48L2Rpdj48L2Rpdj4nOwogICAgICAgIG8uaHRtbChkKTsKICAgICAgICB2YXIgcCA9IG8uZmluZCgiLnZhdCIpOwogICAgICAgIG8uZmluZCgiYSIpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUgJiYgISgwLCB5WyJkZWZhdWx0Il0pKGUpLmhhc0NsYXNzKCJhdCIpICYmICgwLCB5WyJkZWZhdWx0Il0pKGUpLmF0dHIoewogICAgICAgICAgICB0YXJnZXQ6ICJfYmxhbmsiLAogICAgICAgICAgICByZWw6ICJub2ZvbGxvdyIKICAgICAgICAgIH0pOwogICAgICAgIH0pLCByID8gbi5hcHBlbmQobykgOiBuLnByZXBlbmQobyk7CiAgICAgICAgdmFyIGYgPSBvLmZpbmQoIi52Y29udGVudCIpOwogICAgICAgIGYgJiYgUihmKSwgcCAmJiBQKHAsIHQpLCBNKCk7CiAgICAgIH0sCiAgICAgICAgICBJID0ge30sCiAgICAgICAgICBQID0gZnVuY3Rpb24gUCh0LCBuKSB7CiAgICAgICAgdC5vbigiY2xpY2siLCBmdW5jdGlvbiAocikgewogICAgICAgICAgdmFyIG8gPSB0LmF0dHIoImRhdGEtdm0taWQiKSwKICAgICAgICAgICAgICBpID0gdC5hdHRyKCJkYXRhLXNlbGYtaWQiKSwKICAgICAgICAgICAgICBhID0gZS4kZWwuZmluZCgiLnZ3cmFwIiksCiAgICAgICAgICAgICAgcyA9ICJAIiArIHlbImRlZmF1bHQiXS5lc2NhcGUobi5nZXQoIm5pY2siKSk7CiAgICAgICAgICAoMCwgeVsiZGVmYXVsdCJdKSgnLnZyZXBseS13cmFwcGVyW2RhdGEtc2VsZi1pZD0iJyArIGkgKyAnIl0nKS5hcHBlbmQoYSkuZmluZCgiLmNhbmNlbC1yZXBseSIpLnNob3coKSwgSSA9IHsKICAgICAgICAgICAgYXQ6IHlbImRlZmF1bHQiXS5lc2NhcGUocykgKyAiICIsCiAgICAgICAgICAgIHJpZDogbywKICAgICAgICAgICAgcGlkOiBpLAogICAgICAgICAgICBybWFpbDogbi5nZXQoIm1haWwiKQogICAgICAgICAgfSwgdi5jb21tZW50LmF0dHIoewogICAgICAgICAgICBwbGFjZWhvbGRlcjogcwogICAgICAgICAgfSlbMF0uZm9jdXMoKTsKICAgICAgICB9KTsKICAgICAgfSwKICAgICAgICAgIE0gPSBmdW5jdGlvbiBNKCkgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgIk1hdGhKYXgiIGluIHdpbmRvdyAmJiAidmVyc2lvbiIgaW4gd2luZG93Lk1hdGhKYXggJiYgKC9eMy4qLy50ZXN0KHdpbmRvdy5NYXRoSmF4LnZlcnNpb24pICYmIE1hdGhKYXgudHlwZXNldCgpIHx8IE1hdGhKYXguSHViLlF1ZXVlKFsiVHlwZXNldCIsIE1hdGhKYXguSHViLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIudiIpXSkpLCAicmVuZGVyTWF0aEluRWxlbWVudCIgaW4gd2luZG93ICYmIHJlbmRlck1hdGhJbkVsZW1lbnQoKDAsIHlbImRlZmF1bHQiXSkoIi52IilbMF0sIHsKICAgICAgICAgICAgICBkZWxpbWl0ZXJzOiBbewogICAgICAgICAgICAgICAgbGVmdDogIiQkIiwKICAgICAgICAgICAgICAgIHJpZ2h0OiAiJCQiLAogICAgICAgICAgICAgICAgZGlzcGxheTogITAKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBsZWZ0OiAiJCIsCiAgICAgICAgICAgICAgICByaWdodDogIiQiLAogICAgICAgICAgICAgICAgZGlzcGxheTogITEKICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgICAgfSwgMTAwKTsKICAgICAgfSwKICAgICAgICAgIFIgPSBmdW5jdGlvbiBSKGUpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGVbMF0ub2Zmc2V0SGVpZ2h0ID4gMjAwICYmIChlLmFkZENsYXNzKCJleHBhbmQiKSwgZS5vbigiY2xpY2siLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICBlLnJlbW92ZUNsYXNzKCJleHBhbmQiKTsKICAgICAgICAgIH0pKTsKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgICFmdW5jdGlvbiAodCkgewogICAgICAgIGlmICh0ID0geVsiZGVmYXVsdCJdLnN0b3JlLmdldChoLk1ldGFDYWNoZUtleSkgfHwgdCkgZm9yICh2YXIgbiBpbiBwKSB7CiAgICAgICAgICB2YXIgciA9IHBbbl07CiAgICAgICAgICBlLiRlbC5maW5kKCIudiIgKyByKS52YWwoeVsiZGVmYXVsdCJdLnVuZXNjYXBlKHRbcl0pKSwgRVtyXSA9IHRbcl07CiAgICAgICAgfQogICAgICAgIHZhciBvID0geVsiZGVmYXVsdCJdLnN0b3JlLmdldChoLlFRQ2FjaGVLZXkpOwogICAgICAgIEUuUVFBdmF0YXIgPSBlLmNvbmZpZy5lbmFibGVRUSAmJiAhIW8gJiYgby5waWMgfHwgIiI7CiAgICAgIH0oKSwgZS5yZXNldCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBFLmNvbW1lbnQgPSAiIiwgdi5jb21tZW50LnZhbCgiIiksIGQodi5jb21tZW50KSwgdi5jb21tZW50LmF0dHIoInBsYWNlaG9sZGVyIiwgZS5jb25maWcucGxhY2Vob2xkZXIpLCBJID0ge30sIGUuJHByZXZpZXcuaGlkZSgpLCBlLiRlbC5maW5kKCIudnBhbmVsIikuYXBwZW5kKGUuJGVsLmZpbmQoIi52d3JhcCIpKSwgZS4kZWwuZmluZCgiLmNhbmNlbC1yZXBseSIpLmhpZGUoKSwgaiA9ICIiOwogICAgICB9OwoKICAgICAgdmFyIHogPSBlLiRlbC5maW5kKCIudnN1Ym1pdCIpLAogICAgICAgICAgTCA9IGZ1bmN0aW9uIEwodCkgewogICAgICAgIGlmIChlLmNvbmZpZy5yZXF1aXJlZEZpZWxkcy5pbmRleE9mKCJuaWNrIikgPiAtMSAmJiBFLm5pY2subGVuZ3RoIDwgMykgcmV0dXJuIHYubmlja1swXS5mb2N1cygpLCB2b2lkIGUuJGVsLmZpbmQoIi5zdGF0dXMtYmFyIikudGV4dCgiIiArIGUuaTE4bi50KCJuaWNrRmFpbCIpKS5lbXB0eSgzZTMpOwogICAgICAgIGlmIChlLmNvbmZpZy5yZXF1aXJlZEZpZWxkcy5pbmRleE9mKCJtYWlsIikgPiAtMSAmJiAhL1tcdy1cLl0rQChbXHctXStcLikrW2Etel17MiwzfS8udGVzdChFLm1haWwpKSByZXR1cm4gdi5tYWlsWzBdLmZvY3VzKCksIHZvaWQgZS4kZWwuZmluZCgiLnN0YXR1cy1iYXIiKS50ZXh0KCIiICsgZS5pMThuLnQoIm1haWxGYWlsIikpLmVtcHR5KDNlMyk7CiAgICAgICAgaWYgKCIiID09IGopIHJldHVybiB2b2lkIHYuY29tbWVudFswXS5mb2N1cygpOwogICAgICAgIEUuY29tbWVudCA9IGosIEUubmljayA9IEUubmljayB8fCAiQW5vbnltb3VzIjsKICAgICAgICB2YXIgbiA9IHlbImRlZmF1bHQiXS5zdG9yZS5nZXQoInZseCIpOwoKICAgICAgICBpZiAobikgewogICAgICAgICAgaWYgKERhdGUubm93KCkgLyAxZTMgLSBuIC8gMWUzIDwgMjApIHJldHVybiB2b2lkIGUuJGVsLmZpbmQoIi5zdGF0dXMtYmFyIikudGV4dChlLmkxOG4udCgiYnVzeSIpKS5lbXB0eSgzZTMpOwogICAgICAgIH0KCiAgICAgICAgVSgpOwogICAgICB9LAogICAgICAgICAgRiA9IGZ1bmN0aW9uIEYoKSB7CiAgICAgICAgdmFyIGUgPSBuZXcgQVYuQUNMKCk7CiAgICAgICAgcmV0dXJuIGUuc2V0UHVibGljUmVhZEFjY2VzcyghMCksIGUuc2V0UHVibGljV3JpdGVBY2Nlc3MoITEpLCBlOwogICAgICB9LAogICAgICAgICAgVSA9IGZ1bmN0aW9uIFUoKSB7CiAgICAgICAgeVsiZGVmYXVsdCJdLnN0b3JlLnNldCgidmx4IiwgRGF0ZS5ub3coKSksIHouYXR0cih7CiAgICAgICAgICBkaXNhYmxlZDogITAKICAgICAgICB9KSwgZS4kbG9hZGluZy5zaG93KCEwKTsKICAgICAgICB2YXIgdCA9IEFWLk9iamVjdC5leHRlbmQoZS5jb25maWcuY2xhenpOYW1lIHx8ICJDb21tZW50IiksCiAgICAgICAgICAgIG4gPSBuZXcgdCgpOwoKICAgICAgICBpZiAoRS51cmwgPSBkZWNvZGVVUkkoZS5jb25maWcucGF0aCksIEUuaW5zZXJ0ZWRBdCA9IG5ldyBEYXRlKCksIEkucmlkKSB7CiAgICAgICAgICB2YXIgciA9IEkucGlkIHx8IEkucmlkOwogICAgICAgICAgbi5zZXQoInJpZCIsIEkucmlkKSwgbi5zZXQoInBpZCIsIHIpLCBFLmNvbW1lbnQgPSBqLnJlcGxhY2UoIjxwPiIsICc8cD48YSBjbGFzcz0iYXQiIGhyZWY9IiMnICsgciArICciPicgKyBJLmF0ICsgIjwvYT4gLCAiKTsKICAgICAgICB9CgogICAgICAgIGZvciAodmFyIG8gaW4gRSkgewogICAgICAgICAgaWYgKEUuaGFzT3duUHJvcGVydHkobykpIHsKICAgICAgICAgICAgdmFyIGkgPSBFW29dOwogICAgICAgICAgICBuLnNldChvLCBpKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIG4uc2V0QUNMKEYoKSksIG4uc2F2ZSgpLnRoZW4oZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICJBbm9ueW1vdXMiICE9IEUubmljayAmJiB5WyJkZWZhdWx0Il0uc3RvcmUuc2V0KGguTWV0YUNhY2hlS2V5LCB7CiAgICAgICAgICAgIG5pY2s6IEUubmljaywKICAgICAgICAgICAgbGluazogRS5saW5rLAogICAgICAgICAgICBtYWlsOiBFLm1haWwKICAgICAgICAgIH0pOwogICAgICAgICAgdmFyIG4gPSBlLiRlbC5maW5kKCIudm51bSIpOwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIEkucmlkID8gQyh0LCAoMCwgeVsiZGVmYXVsdCJdKSgnLnZxdW90ZVtkYXRhLXNlbGYtaWQ9IicgKyBJLnJpZCArICciXScpLCAhMCkgOiAoTnVtYmVyKG4udGV4dCgpKSA/IG4udGV4dChOdW1iZXIobi50ZXh0KCkpICsgMSkgOiBlLiRlbC5maW5kKCIudmNvdW50Iikuc2hvdygpLmZpbmQoIi52bnVtIikudGV4dChOdW1iZXIobi50ZXh0KCkpICsgMSksIEModCwgZS4kZWwuZmluZCgiLnZjYXJkcyIpKSwgay5za2lwKyspLCB6LnJlbW92ZUF0dHIoImRpc2FibGVkIiksIGUuJGxvYWRpbmcuaGlkZSgpLCBlLnJlc2V0KCk7CiAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICgwLCAkWyJkZWZhdWx0Il0pKGUsIHQsICJzYXZlIik7CiAgICAgICAgICB9CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICgwLCAkWyJkZWZhdWx0Il0pKGUsIHQsICJjb21taXRFdnQiKTsKICAgICAgICB9KTsKICAgICAgfTsKCiAgICAgIHoub24oImNsaWNrIiwgTCksICgwLCB5WyJkZWZhdWx0Il0pKGRvY3VtZW50KS5vbigia2V5ZG93biIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgZSA9IGV2ZW50IHx8IGU7CiAgICAgICAgdmFyIHQgPSBlLmtleUNvZGUgfHwgZS53aGljaCB8fCBlLmNoYXJDb2RlOwogICAgICAgICgoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgMTMgPT09IHQgJiYgTCgpLCA5ID09PSB0KSAmJiAidmVkaXRvciIgPT0gKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuaWQgfHwgIiIpICYmIChlLnByZXZlbnREZWZhdWx0KCksIHgoaVswXSwgIiAgICAiKSk7CiAgICAgIH0pLm9uKCJwYXN0ZSIsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdmFyIHQgPSAiY2xpcGJvYXJkRGF0YSIgaW4gZSA/IGUuY2xpcGJvYXJkRGF0YSA6IGUub3JpZ2luYWxFdmVudCAmJiBlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YSB8fCB3aW5kb3cuY2xpcGJvYXJkRGF0YTsKICAgICAgICB0ICYmIEIodC5pdGVtcywgITApOwogICAgICB9KSwgaS5vbigiZHJhZ2VudGVyIGRyYWdsZWF2ZSBkcmFnb3ZlciBkcm9wIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpLCBlLnByZXZlbnREZWZhdWx0KCksICJkcm9wIiA9PT0gZS50eXBlICYmIEIoZS5kYXRhVHJhbnNmZXIuaXRlbXMpOwogICAgICB9KTsKCiAgICAgIHZhciBCID0gZnVuY3Rpb24gQihlLCB0KSB7CiAgICAgICAgZm9yICh2YXIgbiA9IFtdLCByID0gMCwgbyA9IGUubGVuZ3RoOyByIDwgbzsgcisrKSB7CiAgICAgICAgICB2YXIgYSA9IGVbcl07CiAgICAgICAgICBpZiAoInN0cmluZyIgPT09IGEua2luZCAmJiBhLnR5cGUubWF0Y2goIl50ZXh0L2h0bWwiKSkgIXQgJiYgYS5nZXRBc1N0cmluZyhmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlICYmIHgoaVswXSwgZS5yZXBsYWNlKC88W14+XSs+L2csICIiKSk7CiAgICAgICAgICB9KTtlbHNlIGlmICgtMSAhPT0gYS50eXBlLmluZGV4T2YoImltYWdlIikpIHsKICAgICAgICAgICAgbi5wdXNoKGEuZ2V0QXNGaWxlKCkpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIE4obik7CiAgICAgIH0sCiAgICAgICAgICBOID0gZnVuY3Rpb24gdChuLCByKSB7CiAgICAgICAgciA9IHIgfHwgMDsKICAgICAgICB2YXIgbyA9IG4ubGVuZ3RoOwoKICAgICAgICBpZiAobyA+IDApIHsKICAgICAgICAgIHZhciBhID0gbltyXTsKICAgICAgICAgIHouYXR0cih7CiAgICAgICAgICAgIGRpc2FibGVkOiAhMAogICAgICAgICAgfSk7CiAgICAgICAgICB2YXIgcyA9ICIhW1VwbG9hZGluZyAiICsgYS5uYW1lICsgIi4uLl0oKSI7CiAgICAgICAgICB4KGlbMF0sIHMpLCBRKGEsIGZ1bmN0aW9uIChsKSB7CiAgICAgICAgICAgIDUwMCAhPSBsLmNvZGUgPyAoaS52YWwoaS52YWwoKS5yZXBsYWNlKHMsICIhWyIgKyBhLm5hbWUgKyAiXSgiICsgbC5kYXRhLnVybCArICIpXHJcbiIpKSwgKDAsIGNbImRlZmF1bHQiXSkoaVswXSksICsrciA8IG8gPyB0KG4sIHIpIDogei5yZW1vdmVBdHRyKCJkaXNhYmxlZCIpKSA6IChpLnZhbChpLnZhbCgpLnJlcGxhY2UocywgIiIpKSwgKDAsIGNbImRlZmF1bHQiXSkoaVswXSksIGUuJGVsLmZpbmQoIi5zdGF0dXMtYmFyIikudGV4dChsLm1zZykuZW1wdHkoM2UzKSwgei5yZW1vdmVBdHRyKCJkaXNhYmxlZCIpKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgICAgIFEgPSBmdW5jdGlvbiBRKGUsIHQpIHsKICAgICAgICB2YXIgbiA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIG4uYXBwZW5kKCJpbWFnZSIsIGUpLCB5WyJkZWZhdWx0Il0uYWpheCh7CiAgICAgICAgICB0eXBlOiAicG9zdCIsCiAgICAgICAgICB1cmw6ICJodHRwczovL3BpYy5hbGV4aGNodS5jb20vYXBpL3VwbG9hZCIsCiAgICAgICAgICBkYXRhOiBuLAogICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhlKSB7CiAgICAgICAgICAgIHQgJiYgdChlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfTsKICAgIH0sIGUuZXhwb3J0cyA9IGksIGUuZXhwb3J0c1siZGVmYXVsdCJdID0gaTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwOwoKICAgIHZhciByID0gbigwKSwKICAgICAgICBvID0gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsKICAgICAgICAiZGVmYXVsdCI6IGUKICAgICAgfTsKICAgIH0ociksCiAgICAgICAgaSA9ICExOwoKICAgIHRbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIGlmICgiQVYiIGluIHdpbmRvdykgewogICAgICAgIHZhciBuID0gd2luZG93LkFWLnZlcnNpb24gfHwgd2luZG93LkFWLlZFUlNJT047CiAgICAgICAgcGFyc2VJbnQobi5zcGxpdCgiLiIpWzBdKSA+IDIgPyBpID0gISFBVi5hcHBsaWNhdGlvbklkICYmICEhQVYuYXBwbGljYXRpb25LZXkgOiBvWyJkZWZhdWx0Il0uZGVsZXRlSW5XaW4oIkFWIiwgMCk7CiAgICAgIH0KCiAgICAgIGkgPyB0ICYmIHQoKSA6IG9bImRlZmF1bHQiXS5zZGtMb2FkZXIoIi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbGVhbmNsb3VkLXN0b3JhZ2VAMy9kaXN0L2F2LW1pbi5qcyIsICJBViIsIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgdmFyIHIgPSAiaHR0cHM6Ly8iLAogICAgICAgICAgICBvID0gIiIsCiAgICAgICAgICAgIGEgPSBlLmFwcF9pZCB8fCBlLmFwcElkLAogICAgICAgICAgICBzID0gZS5hcHBfa2V5IHx8IGUuYXBwS2V5OwogICAgICAgIGlmICghZS5zZXJ2ZXJVUkxzKSBzd2l0Y2ggKGEuc2xpY2UoLTkpKSB7CiAgICAgICAgICBjYXNlICItOU5oOWowVmEiOgogICAgICAgICAgICByICs9ICJ0YWIuIjsKICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgY2FzZSAiLU1kWVhiTU1JIjoKICAgICAgICAgICAgciArPSAidXMuIjsKICAgICAgICB9CiAgICAgICAgbyA9IGUuc2VydmVyVVJMcyB8fCByICsgImF2b3NjbG91ZC5jb20iLCBBVi5pbml0KHsKICAgICAgICAgIGFwcElkOiBhLAogICAgICAgICAgYXBwS2V5OiBzLAogICAgICAgICAgc2VydmVyVVJMczogbwogICAgICAgIH0pLCBpID0gITAsIHQgJiYgdCgpOwogICAgICB9KTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuIGUgJiYgZS5fX2VzTW9kdWxlID8gZSA6IHsKICAgICAgICAiZGVmYXVsdCI6IGUKICAgICAgfTsKICAgIH0KCiAgICB0Ll9fZXNNb2R1bGUgPSAhMDsKICAgIHZhciBvID0gbigzNyksCiAgICAgICAgaSA9IHIobyksCiAgICAgICAgYSA9IG4oNTYpLAogICAgICAgIHMgPSByKGEpLAogICAgICAgIGwgPSBuKDU3KSwKICAgICAgICBjID0gcihsKSwKICAgICAgICB1ID0gbig1NCksCiAgICAgICAgZCA9IHIodSksCiAgICAgICAgcCA9IG4oNTUpLAogICAgICAgIGYgPSByKHApLAogICAgICAgIGggPSB7CiAgICAgIHpoOiBzWyJkZWZhdWx0Il0sCiAgICAgICJ6aC1jbiI6IHNbImRlZmF1bHQiXSwKICAgICAgInpoLUNOIjogc1siZGVmYXVsdCJdLAogICAgICAiemgtVFciOiBjWyJkZWZhdWx0Il0sCiAgICAgIGVuOiBkWyJkZWZhdWx0Il0sCiAgICAgICJlbi1VUyI6IGRbImRlZmF1bHQiXSwKICAgICAgamE6IGZbImRlZmF1bHQiXSwKICAgICAgImphLUpQIjogZlsiZGVmYXVsdCJdCiAgICB9OwoKICAgIHRbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHJldHVybiAhaFtlXSAmJiBlICYmIHQgJiYgKGhbZV0gPSB0KSwgbmV3IGlbImRlZmF1bHQiXSh7CiAgICAgICAgcGhyYXNlczogaFtlIHx8ICJ6aCJdLAogICAgICAgIGxvY2FsZTogZQogICAgICB9KTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB0Ll9fZXNNb2R1bGUgPSAhMCwgdFsiZGVmYXVsdCJdID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgaWYgKGUuJGVsICYmIGUuJGxvYWRpbmcuaGlkZSgpLiRub2RhdGEuaGlkZSgpLCAiW29iamVjdCBFcnJvcl0iID09PSB7fS50b1N0cmluZy5jYWxsKHQpKSB7CiAgICAgICAgdmFyIG4gPSB0LmNvZGUgfHwgdC5tZXNzYWdlIHx8IHQuZXJyb3IgfHwgIiI7CiAgICAgICAgaWYgKGlzTmFOKG4pKSBlLiRlbCAmJiBlLiRub2RhdGEuc2hvdygnPHByZSBzdHlsZT0idGV4dC1hbGlnbjpsZWZ0OyI+ICcgKyBKU09OLnN0cmluZ2lmeSh0KSArICI8L3ByZT4iKTtlbHNlIHsKICAgICAgICAgIHZhciByID0gZS5pMThuLnQoImNvZGUtIiArIG4pLAogICAgICAgICAgICAgIG8gPSAociA9PSAiY29kZS0iICsgbiA/IHZvaWQgMCA6IHIpIHx8IHQubWVzc2FnZSB8fCB0LmVycm9yIHx8ICIiOwogICAgICAgICAgMTAxID09IG4gfHwgLTEgPT0gbiA/IGUuJG5vZGF0YS5zaG93KCkgOiBlLiRlbCAmJiBlLiRub2RhdGEuc2hvdygnPHByZSBzdHlsZT0idGV4dC1hbGlnbjpsZWZ0OyI+Q29kZSAnICsgbiArICI6ICIgKyBvICsgIjwvcHJlPiIpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGUuJGVsICYmIGUuJG5vZGF0YS5zaG93KCc8cHJlIHN0eWxlPSJ0ZXh0LWFsaWduOmxlZnQ7Ij4nICsgSlNPTi5zdHJpbmdpZnkodCkgKyAiPC9wcmU+Iik7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7CiAgICAgICAgImRlZmF1bHQiOiBlCiAgICAgIH07CiAgICB9CgogICAgdC5fX2VzTW9kdWxlID0gITA7CiAgICB2YXIgbyA9IG4oMzYpLAogICAgICAgIGkgPSByKG8pLAogICAgICAgIGEgPSBuKDApLAogICAgICAgIHMgPSByKGEpLAogICAgICAgIGwgPSBuKDYpLAogICAgICAgIGMgPSByKGwpLAogICAgICAgIHUgPSBuKDMzKSwKICAgICAgICBkID0gbmV3IG8uUmVuZGVyZXIoKTsKICAgIGQuY29kZSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHJldHVybiAnPHByZT48Y29kZSBjbGFzcz0iaGxqcyBsYW5ndWFnZS0nICsgdCArICciPicgKyAoIXQgfHwgIWhsanMuZ2V0TGFuZ3VhZ2UodCkgPyBzWyJkZWZhdWx0Il0uZXNjYXBlKGUpIDogaGxqcy5oaWdobGlnaHQodCwgZSkudmFsdWUpICsgIjwvY29kZT48L3ByZT4iOwogICAgfSwgaVsiZGVmYXVsdCJdLnNldE9wdGlvbnMoewogICAgICByZW5kZXJlcjogImhsanMiIGluIHdpbmRvdyA/IGQgOiBuZXcgby5SZW5kZXJlcigpLAogICAgICBoaWdobGlnaHQ6IGZ1bmN0aW9uIGhpZ2hsaWdodChlLCB0KSB7CiAgICAgICAgcmV0dXJuICJobGpzIiBpbiB3aW5kb3cgPyB0ICYmIGhsanMuZ2V0TGFuZ3VhZ2UodCkgJiYgaGxqcy5oaWdobGlnaHQodCwgZSwgITApLnZhbHVlIHx8IGhsanMuaGlnaGxpZ2h0QXV0byhlKS52YWx1ZSA6IHUoZSk7CiAgICAgIH0sCiAgICAgIGdmbTogITAsCiAgICAgIHRhYmxlczogITAsCiAgICAgIGJyZWFrczogITAsCiAgICAgIHBlZGFudGljOiAhMSwKICAgICAgc2FuaXRpemU6ICEwLAogICAgICBzbWFydExpc3RzOiAhMCwKICAgICAgc21hcnR5cGFudHM6ICEwLAogICAgICBoZWFkZXJQcmVmaTogInYtIgogICAgfSksIHRbImRlZmF1bHQiXSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBjWyJkZWZhdWx0Il0ucGFyc2UoKDAsIGlbImRlZmF1bHQiXSkoZSkpOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHQuX19lc01vZHVsZSA9ICEwLCB0LnJlY29yZElQRm4gPSB0LmZldGNoUVFGbiA9IHZvaWQgMDsKCiAgICB2YXIgciA9IG4oMCksCiAgICAgICAgbyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBlICYmIGUuX19lc01vZHVsZSA/IGUgOiB7CiAgICAgICAgImRlZmF1bHQiOiBlCiAgICAgIH07CiAgICB9KHIpLAogICAgICAgIGkgPSBuKDIpLAogICAgICAgIGEgPSBmdW5jdGlvbiBhKGUsIHQpIHsKICAgICAgdmFyIG4gPSBvWyJkZWZhdWx0Il0uc3RvcmUuZ2V0KGkuUVFDYWNoZUtleSk7CiAgICAgIG4gJiYgbi5xcSA9PSBlID8gdCAmJiB0KG4pIDogb1siZGVmYXVsdCJdLmFqYXgoewogICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICB1cmw6ICIvL3ZhbGluZS5hcGkuaW9saXUuY24vZ2V0cXFpbmZvIiwKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBxcTogZQogICAgICAgIH0sCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhlKSB7CiAgICAgICAgICBlLmVycm1zZyB8fCAob1siZGVmYXVsdCJdLnN0b3JlLnNldChpLlFRQ2FjaGVLZXksIGUpLCB0ICYmIHQoZSkpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgICAgIHMgPSBmdW5jdGlvbiBzKGUpIHsKICAgICAgb1siZGVmYXVsdCJdLnNka0xvYWRlcigiLy9hcGkuaXAuc2IvanNvbmlwP2NhbGxiYWNrPWdldElQIiwgImdldElQIiksIHdpbmRvdy5nZXRJUCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgZSAmJiBlKHQuaXApLCBvWyJkZWZhdWx0Il0uZGVsZXRlSW5XaW4oImdldElQIik7CiAgICAgIH07CiAgICB9OwoKICAgIHQuZmV0Y2hRUUZuID0gYSwgdC5yZWNvcmRJUEZuID0gczsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gZnVuY3Rpb24gcihlLCB0KSB7CiAgICAgIGlmICghZSkgcmV0dXJuICIiOwoKICAgICAgdHJ5IHsKICAgICAgICB2YXIgbiA9IGkoZSkuZ2V0VGltZSgpLAogICAgICAgICAgICByID0gbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICAgIGEgPSByIC0gbiwKICAgICAgICAgICAgcyA9IE1hdGguZmxvb3IoYSAvIDg2NGU1KTsKCiAgICAgICAgaWYgKDAgPT09IHMpIHsKICAgICAgICAgIHZhciBsID0gYSAlIDg2NGU1LAogICAgICAgICAgICAgIGMgPSBNYXRoLmZsb29yKGwgLyAzNmU1KTsKCiAgICAgICAgICBpZiAoMCA9PT0gYykgewogICAgICAgICAgICB2YXIgdSA9IGwgJSAzNmU1LAogICAgICAgICAgICAgICAgZCA9IE1hdGguZmxvb3IodSAvIDZlNCk7CgogICAgICAgICAgICBpZiAoMCA9PT0gZCkgewogICAgICAgICAgICAgIHZhciBwID0gdSAlIDZlNDsKICAgICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChwIC8gMWUzKSArICIgIiArIHQudCgic2Vjb25kcyIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZCArICIgIiArIHQudCgibWludXRlcyIpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBjICsgIiAiICsgdC50KCJob3VycyIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHMgPCAwID8gdC50KCJub3ciKSA6IHMgPCA4ID8gcyArICIgIiArIHQudCgiZGF5cyIpIDogbyhlKTsKICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0sCiAgICAgICAgbyA9IGZ1bmN0aW9uIG8oZSkgewogICAgICB2YXIgdCA9IGEoZS5nZXREYXRlKCksIDIpLAogICAgICAgICAgbiA9IGEoZS5nZXRNb250aCgpICsgMSwgMik7CiAgICAgIHJldHVybiBhKGUuZ2V0RnVsbFllYXIoKSwgMikgKyAiLSIgKyBuICsgIi0iICsgdDsKICAgIH0sCiAgICAgICAgaSA9IGZ1bmN0aW9uIGUodCkgewogICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIERhdGUgPyB0IDogIWlzTmFOKHQpIHx8IC9eXGQrJC8udGVzdCh0KSA/IG5ldyBEYXRlKHBhcnNlSW50KHQpKSA6IC9HTVQvLnRlc3QodCB8fCAiIikgPyBlKG5ldyBEYXRlKHQpLmdldFRpbWUoKSkgOiAodCA9ICh0IHx8ICIiKS5yZXBsYWNlKC8oXlxzKil8KFxzKiQpL2csICIiKS5yZXBsYWNlKC9cLlxkKy8sICIiKS5yZXBsYWNlKC8tLywgIi8iKS5yZXBsYWNlKC8tLywgIi8iKS5yZXBsYWNlKC8oXGQpVChcZCkvLCAiJDEgJDIiKS5yZXBsYWNlKC9aLywgIiBVVEMiKS5yZXBsYWNlKC8oWystXVxkXGQpOj8oXGRcZCkvLCAiICQxJDIiKSwgbmV3IERhdGUodCkpOwogICAgfSwKICAgICAgICBhID0gZnVuY3Rpb24gYShlLCB0KSB7CiAgICAgIGZvciAodmFyIG4gPSBlLnRvU3RyaW5nKCk7IG4ubGVuZ3RoIDwgdDspIHsKICAgICAgICBuID0gIjAiICsgbjsKICAgICAgfQoKICAgICAgcmV0dXJuIG47CiAgICB9OwoKICAgIGUuZXhwb3J0cyA9IHI7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB0Ll9fZXNNb2R1bGUgPSAhMDsKCiAgICB2YXIgciA9IG4oNTEpLAogICAgICAgIG8gPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZSAmJiBlLl9fZXNNb2R1bGUgPyBlIDogewogICAgICAgICJkZWZhdWx0IjogZQogICAgICB9OwogICAgfShyKTsKCiAgICB0WyJkZWZhdWx0Il0gPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gKDAsIG9bImRlZmF1bHQiXSkoZSwgewogICAgICAgIG9uVGFnQXR0cjogZnVuY3Rpb24gb25UYWdBdHRyKGUsIHQsIG4sIHIpIHsKICAgICAgICAgIHJldHVybiBpKGUsIHQsIG4sIHIpOwogICAgICAgIH0sCiAgICAgICAgb25JZ25vcmVUYWdBdHRyOiBmdW5jdGlvbiBvbklnbm9yZVRhZ0F0dHIoZSwgdCwgbiwgcikgewogICAgICAgICAgcmV0dXJuIGkoZSwgdCwgbiwgcik7CiAgICAgICAgfQogICAgICB9KS5yZXBsYWNlKC9cPFwvP2Rpdlw+L2dpLCAiIik7CiAgICB9OwoKICAgIHZhciBpID0gZnVuY3Rpb24gaShlLCB0LCBuLCByKSB7CiAgICAgIGlmICgvY29kZXxwcmV8c3Bhbi9naS50ZXN0KGUpKSB7CiAgICAgICAgaWYgKCJzdHlsZSIgPT0gdCkgcmV0dXJuIHQgKyAnPSInICsgKC9eY29sb3IvZ2kudGVzdChuKSA/IG4gOiAiIikucmVwbGFjZSgvKGNvbG9yOlsjMC05YS1mQS1GXXsxLDZ9Oz8pLisvZ2ksICIkMSIpICsgJyInOwogICAgICAgIGlmICgiY2xhc3MiID09IHQpIHJldHVybiB0ICsgIj0nIiArIG9bImRlZmF1bHQiXS5lc2NhcGVBdHRyVmFsdWUobikgKyAiJyI7CiAgICAgIH0KCiAgICAgIGlmICgiaW1nIiA9PT0gZSAmJiBbInNyYyIsICJjbGFzcyJdLmluZGV4T2YodCkgPiAtMSkgcmV0dXJuIHQgKyAnPSInICsgb1siZGVmYXVsdCJdLmVzY2FwZUF0dHJWYWx1ZShuKSArICciIHJlZmVycmVyUG9saWN5PSJuby1yZWZlcnJlciIgJzsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIHZhciByOwogICAgIWZ1bmN0aW9uIChvKSB7CiAgICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAgIGZ1bmN0aW9uIGkoZSwgdCkgewogICAgICAgIHZhciBuID0gKDY1NTM1ICYgZSkgKyAoNjU1MzUgJiB0KTsKICAgICAgICByZXR1cm4gKGUgPj4gMTYpICsgKHQgPj4gMTYpICsgKG4gPj4gMTYpIDw8IDE2IHwgNjU1MzUgJiBuOwogICAgICB9CgogICAgICBmdW5jdGlvbiBhKGUsIHQpIHsKICAgICAgICByZXR1cm4gZSA8PCB0IHwgZSA+Pj4gMzIgLSB0OwogICAgICB9CgogICAgICBmdW5jdGlvbiBzKGUsIHQsIG4sIHIsIG8sIHMpIHsKICAgICAgICByZXR1cm4gaShhKGkoaSh0LCBlKSwgaShyLCBzKSksIG8pLCBuKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbChlLCB0LCBuLCByLCBvLCBpLCBhKSB7CiAgICAgICAgcmV0dXJuIHModCAmIG4gfCB+dCAmIHIsIGUsIHQsIG8sIGksIGEpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBjKGUsIHQsIG4sIHIsIG8sIGksIGEpIHsKICAgICAgICByZXR1cm4gcyh0ICYgciB8IG4gJiB+ciwgZSwgdCwgbywgaSwgYSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHUoZSwgdCwgbiwgciwgbywgaSwgYSkgewogICAgICAgIHJldHVybiBzKHQgXiBuIF4gciwgZSwgdCwgbywgaSwgYSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGQoZSwgdCwgbiwgciwgbywgaSwgYSkgewogICAgICAgIHJldHVybiBzKG4gXiAodCB8IH5yKSwgZSwgdCwgbywgaSwgYSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHAoZSwgdCkgewogICAgICAgIGVbdCA+PiA1XSB8PSAxMjggPDwgdCAlIDMyLCBlWzE0ICsgKHQgKyA2NCA+Pj4gOSA8PCA0KV0gPSB0OwogICAgICAgIHZhciBuLAogICAgICAgICAgICByLAogICAgICAgICAgICBvLAogICAgICAgICAgICBhLAogICAgICAgICAgICBzLAogICAgICAgICAgICBwID0gMTczMjU4NDE5MywKICAgICAgICAgICAgZiA9IC0yNzE3MzM4NzksCiAgICAgICAgICAgIGggPSAtMTczMjU4NDE5NCwKICAgICAgICAgICAgdiA9IDI3MTczMzg3ODsKCiAgICAgICAgZm9yIChuID0gMDsgbiA8IGUubGVuZ3RoOyBuICs9IDE2KSB7CiAgICAgICAgICByID0gcCwgbyA9IGYsIGEgPSBoLCBzID0gdiwgcCA9IGwocCwgZiwgaCwgdiwgZVtuXSwgNywgLTY4MDg3NjkzNiksIHYgPSBsKHYsIHAsIGYsIGgsIGVbbiArIDFdLCAxMiwgLTM4OTU2NDU4NiksIGggPSBsKGgsIHYsIHAsIGYsIGVbbiArIDJdLCAxNywgNjA2MTA1ODE5KSwgZiA9IGwoZiwgaCwgdiwgcCwgZVtuICsgM10sIDIyLCAtMTA0NDUyNTMzMCksIHAgPSBsKHAsIGYsIGgsIHYsIGVbbiArIDRdLCA3LCAtMTc2NDE4ODk3KSwgdiA9IGwodiwgcCwgZiwgaCwgZVtuICsgNV0sIDEyLCAxMjAwMDgwNDI2KSwgaCA9IGwoaCwgdiwgcCwgZiwgZVtuICsgNl0sIDE3LCAtMTQ3MzIzMTM0MSksIGYgPSBsKGYsIGgsIHYsIHAsIGVbbiArIDddLCAyMiwgLTQ1NzA1OTgzKSwgcCA9IGwocCwgZiwgaCwgdiwgZVtuICsgOF0sIDcsIDE3NzAwMzU0MTYpLCB2ID0gbCh2LCBwLCBmLCBoLCBlW24gKyA5XSwgMTIsIC0xOTU4NDE0NDE3KSwgaCA9IGwoaCwgdiwgcCwgZiwgZVtuICsgMTBdLCAxNywgLTQyMDYzKSwgZiA9IGwoZiwgaCwgdiwgcCwgZVtuICsgMTFdLCAyMiwgLTE5OTA0MDQxNjIpLCBwID0gbChwLCBmLCBoLCB2LCBlW24gKyAxMl0sIDcsIDE4MDQ2MDM2ODIpLCB2ID0gbCh2LCBwLCBmLCBoLCBlW24gKyAxM10sIDEyLCAtNDAzNDExMDEpLCBoID0gbChoLCB2LCBwLCBmLCBlW24gKyAxNF0sIDE3LCAtMTUwMjAwMjI5MCksIGYgPSBsKGYsIGgsIHYsIHAsIGVbbiArIDE1XSwgMjIsIDEyMzY1MzUzMjkpLCBwID0gYyhwLCBmLCBoLCB2LCBlW24gKyAxXSwgNSwgLTE2NTc5NjUxMCksIHYgPSBjKHYsIHAsIGYsIGgsIGVbbiArIDZdLCA5LCAtMTA2OTUwMTYzMiksIGggPSBjKGgsIHYsIHAsIGYsIGVbbiArIDExXSwgMTQsIDY0MzcxNzcxMyksIGYgPSBjKGYsIGgsIHYsIHAsIGVbbl0sIDIwLCAtMzczODk3MzAyKSwgcCA9IGMocCwgZiwgaCwgdiwgZVtuICsgNV0sIDUsIC03MDE1NTg2OTEpLCB2ID0gYyh2LCBwLCBmLCBoLCBlW24gKyAxMF0sIDksIDM4MDE2MDgzKSwgaCA9IGMoaCwgdiwgcCwgZiwgZVtuICsgMTVdLCAxNCwgLTY2MDQ3ODMzNSksIGYgPSBjKGYsIGgsIHYsIHAsIGVbbiArIDRdLCAyMCwgLTQwNTUzNzg0OCksIHAgPSBjKHAsIGYsIGgsIHYsIGVbbiArIDldLCA1LCA1Njg0NDY0MzgpLCB2ID0gYyh2LCBwLCBmLCBoLCBlW24gKyAxNF0sIDksIC0xMDE5ODAzNjkwKSwgaCA9IGMoaCwgdiwgcCwgZiwgZVtuICsgM10sIDE0LCAtMTg3MzYzOTYxKSwgZiA9IGMoZiwgaCwgdiwgcCwgZVtuICsgOF0sIDIwLCAxMTYzNTMxNTAxKSwgcCA9IGMocCwgZiwgaCwgdiwgZVtuICsgMTNdLCA1LCAtMTQ0NDY4MTQ2NyksIHYgPSBjKHYsIHAsIGYsIGgsIGVbbiArIDJdLCA5LCAtNTE0MDM3ODQpLCBoID0gYyhoLCB2LCBwLCBmLCBlW24gKyA3XSwgMTQsIDE3MzUzMjg0NzMpLCBmID0gYyhmLCBoLCB2LCBwLCBlW24gKyAxMl0sIDIwLCAtMTkyNjYwNzczNCksIHAgPSB1KHAsIGYsIGgsIHYsIGVbbiArIDVdLCA0LCAtMzc4NTU4KSwgdiA9IHUodiwgcCwgZiwgaCwgZVtuICsgOF0sIDExLCAtMjAyMjU3NDQ2MyksIGggPSB1KGgsIHYsIHAsIGYsIGVbbiArIDExXSwgMTYsIDE4MzkwMzA1NjIpLCBmID0gdShmLCBoLCB2LCBwLCBlW24gKyAxNF0sIDIzLCAtMzUzMDk1NTYpLCBwID0gdShwLCBmLCBoLCB2LCBlW24gKyAxXSwgNCwgLTE1MzA5OTIwNjApLCB2ID0gdSh2LCBwLCBmLCBoLCBlW24gKyA0XSwgMTEsIDEyNzI4OTMzNTMpLCBoID0gdShoLCB2LCBwLCBmLCBlW24gKyA3XSwgMTYsIC0xNTU0OTc2MzIpLCBmID0gdShmLCBoLCB2LCBwLCBlW24gKyAxMF0sIDIzLCAtMTA5NDczMDY0MCksIHAgPSB1KHAsIGYsIGgsIHYsIGVbbiArIDEzXSwgNCwgNjgxMjc5MTc0KSwgdiA9IHUodiwgcCwgZiwgaCwgZVtuXSwgMTEsIC0zNTg1MzcyMjIpLCBoID0gdShoLCB2LCBwLCBmLCBlW24gKyAzXSwgMTYsIC03MjI1MjE5NzkpLCBmID0gdShmLCBoLCB2LCBwLCBlW24gKyA2XSwgMjMsIDc2MDI5MTg5KSwgcCA9IHUocCwgZiwgaCwgdiwgZVtuICsgOV0sIDQsIC02NDAzNjQ0ODcpLCB2ID0gdSh2LCBwLCBmLCBoLCBlW24gKyAxMl0sIDExLCAtNDIxODE1ODM1KSwgaCA9IHUoaCwgdiwgcCwgZiwgZVtuICsgMTVdLCAxNiwgNTMwNzQyNTIwKSwgZiA9IHUoZiwgaCwgdiwgcCwgZVtuICsgMl0sIDIzLCAtOTk1MzM4NjUxKSwgcCA9IGQocCwgZiwgaCwgdiwgZVtuXSwgNiwgLTE5ODYzMDg0NCksIHYgPSBkKHYsIHAsIGYsIGgsIGVbbiArIDddLCAxMCwgMTEyNjg5MTQxNSksIGggPSBkKGgsIHYsIHAsIGYsIGVbbiArIDE0XSwgMTUsIC0xNDE2MzU0OTA1KSwgZiA9IGQoZiwgaCwgdiwgcCwgZVtuICsgNV0sIDIxLCAtNTc0MzQwNTUpLCBwID0gZChwLCBmLCBoLCB2LCBlW24gKyAxMl0sIDYsIDE3MDA0ODU1NzEpLCB2ID0gZCh2LCBwLCBmLCBoLCBlW24gKyAzXSwgMTAsIC0xODk0OTg2NjA2KSwgaCA9IGQoaCwgdiwgcCwgZiwgZVtuICsgMTBdLCAxNSwgLTEwNTE1MjMpLCBmID0gZChmLCBoLCB2LCBwLCBlW24gKyAxXSwgMjEsIC0yMDU0OTIyNzk5KSwgcCA9IGQocCwgZiwgaCwgdiwgZVtuICsgOF0sIDYsIDE4NzMzMTMzNTkpLCB2ID0gZCh2LCBwLCBmLCBoLCBlW24gKyAxNV0sIDEwLCAtMzA2MTE3NDQpLCBoID0gZChoLCB2LCBwLCBmLCBlW24gKyA2XSwgMTUsIC0xNTYwMTk4MzgwKSwgZiA9IGQoZiwgaCwgdiwgcCwgZVtuICsgMTNdLCAyMSwgMTMwOTE1MTY0OSksIHAgPSBkKHAsIGYsIGgsIHYsIGVbbiArIDRdLCA2LCAtMTQ1NTIzMDcwKSwgdiA9IGQodiwgcCwgZiwgaCwgZVtuICsgMTFdLCAxMCwgLTExMjAyMTAzNzkpLCBoID0gZChoLCB2LCBwLCBmLCBlW24gKyAyXSwgMTUsIDcxODc4NzI1OSksIGYgPSBkKGYsIGgsIHYsIHAsIGVbbiArIDldLCAyMSwgLTM0MzQ4NTU1MSksIHAgPSBpKHAsIHIpLCBmID0gaShmLCBvKSwgaCA9IGkoaCwgYSksIHYgPSBpKHYsIHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIFtwLCBmLCBoLCB2XTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZihlKSB7CiAgICAgICAgdmFyIHQsCiAgICAgICAgICAgIG4gPSAiIiwKICAgICAgICAgICAgciA9IDMyICogZS5sZW5ndGg7CgogICAgICAgIGZvciAodCA9IDA7IHQgPCByOyB0ICs9IDgpIHsKICAgICAgICAgIG4gKz0gU3RyaW5nLmZyb21DaGFyQ29kZShlW3QgPj4gNV0gPj4+IHQgJSAzMiAmIDI1NSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbjsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gaChlKSB7CiAgICAgICAgdmFyIHQsCiAgICAgICAgICAgIG4gPSBbXTsKCiAgICAgICAgZm9yIChuWyhlLmxlbmd0aCA+PiAyKSAtIDFdID0gdm9pZCAwLCB0ID0gMDsgdCA8IG4ubGVuZ3RoOyB0ICs9IDEpIHsKICAgICAgICAgIG5bdF0gPSAwOwogICAgICAgIH0KCiAgICAgICAgdmFyIHIgPSA4ICogZS5sZW5ndGg7CgogICAgICAgIGZvciAodCA9IDA7IHQgPCByOyB0ICs9IDgpIHsKICAgICAgICAgIG5bdCA+PiA1XSB8PSAoMjU1ICYgZS5jaGFyQ29kZUF0KHQgLyA4KSkgPDwgdCAlIDMyOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG47CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHYoZSkgewogICAgICAgIHJldHVybiBmKHAoaChlKSwgOCAqIGUubGVuZ3RoKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGcoZSwgdCkgewogICAgICAgIHZhciBuLAogICAgICAgICAgICByLAogICAgICAgICAgICBvID0gaChlKSwKICAgICAgICAgICAgaSA9IFtdLAogICAgICAgICAgICBhID0gW107CgogICAgICAgIGZvciAoaVsxNV0gPSBhWzE1XSA9IHZvaWQgMCwgby5sZW5ndGggPiAxNiAmJiAobyA9IHAobywgOCAqIGUubGVuZ3RoKSksIG4gPSAwOyBuIDwgMTY7IG4gKz0gMSkgewogICAgICAgICAgaVtuXSA9IDkwOTUyMjQ4NiBeIG9bbl0sIGFbbl0gPSAxNTQ5NTU2ODI4IF4gb1tuXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByID0gcChpLmNvbmNhdChoKHQpKSwgNTEyICsgOCAqIHQubGVuZ3RoKSwgZihwKGEuY29uY2F0KHIpLCA2NDApKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gbShlKSB7CiAgICAgICAgdmFyIHQsCiAgICAgICAgICAgIG4sCiAgICAgICAgICAgIHIgPSAiMDEyMzQ1Njc4OWFiY2RlZiIsCiAgICAgICAgICAgIG8gPSAiIjsKCiAgICAgICAgZm9yIChuID0gMDsgbiA8IGUubGVuZ3RoOyBuICs9IDEpIHsKICAgICAgICAgIHQgPSBlLmNoYXJDb2RlQXQobiksIG8gKz0gci5jaGFyQXQodCA+Pj4gNCAmIDE1KSArIHIuY2hhckF0KDE1ICYgdCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbzsKICAgICAgfQoKICAgICAgZnVuY3Rpb24geShlKSB7CiAgICAgICAgcmV0dXJuIHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChlKSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGIoZSkgewogICAgICAgIHJldHVybiB2KHkoZSkpOwogICAgICB9CgogICAgICBmdW5jdGlvbiB3KGUpIHsKICAgICAgICByZXR1cm4gbShiKGUpKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24geChlLCB0KSB7CiAgICAgICAgcmV0dXJuIGcoeShlKSwgeSh0KSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGsoZSwgdCkgewogICAgICAgIHJldHVybiBtKHgoZSwgdCkpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBfKGUsIHQsIG4pIHsKICAgICAgICByZXR1cm4gdCA/IG4gPyB4KHQsIGUpIDogayh0LCBlKSA6IG4gPyBiKGUpIDogdyhlKTsKICAgICAgfQoKICAgICAgdm9pZCAwICE9PSAociA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gXzsKICAgICAgfS5jYWxsKHQsIG4sIHQsIGUpKSAmJiAoZS5leHBvcnRzID0gcik7CiAgICB9KCk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB0Ll9fZXNNb2R1bGUgPSAhMDsKCiAgICB2YXIgciA9IGZ1bmN0aW9uIHIoZSkgewogICAgICBlID0gZSB8fCBuYXZpZ2F0b3IudXNlckFnZW50OwogICAgICB2YXIgdCA9IHt9LAogICAgICAgICAgbiA9IHsKICAgICAgICBUcmlkZW50OiBlLmluZGV4T2YoIlRyaWRlbnQiKSA+IC0xIHx8IGUuaW5kZXhPZigiTkVUIENMUiIpID4gLTEsCiAgICAgICAgUHJlc3RvOiBlLmluZGV4T2YoIlByZXN0byIpID4gLTEsCiAgICAgICAgV2ViS2l0OiBlLmluZGV4T2YoIkFwcGxlV2ViS2l0IikgPiAtMSwKICAgICAgICBHZWNrbzogZS5pbmRleE9mKCJHZWNrby8iKSA+IC0xLAogICAgICAgIFNhZmFyaTogZS5pbmRleE9mKCJTYWZhcmkiKSA+IC0xLAogICAgICAgIEVkZ2U6IGUuaW5kZXhPZigiRWRnZSIpID4gLTEgfHwgZS5pbmRleE9mKCJFZGciKSA+IC0xLAogICAgICAgIENocm9tZTogZS5pbmRleE9mKCJDaHJvbWUiKSA+IC0xIHx8IGUuaW5kZXhPZigiQ3JpT1MiKSA+IC0xLAogICAgICAgIElFOiBlLmluZGV4T2YoIk1TSUUiKSA+IC0xIHx8IGUuaW5kZXhPZigiVHJpZGVudCIpID4gLTEsCiAgICAgICAgRmlyZWZveDogZS5pbmRleE9mKCJGaXJlZm94IikgPiAtMSB8fCBlLmluZGV4T2YoIkZ4aU9TIikgPiAtMSwKICAgICAgICAiRmlyZWZveCBGb2N1cyI6IGUuaW5kZXhPZigiRm9jdXMiKSA+IC0xLAogICAgICAgIENocm9taXVtOiBlLmluZGV4T2YoIkNocm9taXVtIikgPiAtMSwKICAgICAgICBPcGVyYTogZS5pbmRleE9mKCJPcGVyYSIpID4gLTEgfHwgZS5pbmRleE9mKCJPUFIiKSA+IC0xLAogICAgICAgIFZpdmFsZGk6IGUuaW5kZXhPZigiVml2YWxkaSIpID4gLTEsCiAgICAgICAgWWFuZGV4OiBlLmluZGV4T2YoIllhQnJvd3NlciIpID4gLTEsCiAgICAgICAgS2luZGxlOiBlLmluZGV4T2YoIktpbmRsZSIpID4gLTEgfHwgZS5pbmRleE9mKCJTaWxrLyIpID4gLTEsCiAgICAgICAgMzYwOiBlLmluZGV4T2YoIjM2MEVFIikgPiAtMSB8fCBlLmluZGV4T2YoIjM2MFNFIikgPiAtMSwKICAgICAgICBVQzogZS5pbmRleE9mKCJVQyIpID4gLTEgfHwgZS5pbmRleE9mKCIgVUJyb3dzZXIiKSA+IC0xLAogICAgICAgIFFRQnJvd3NlcjogZS5pbmRleE9mKCJRUUJyb3dzZXIiKSA+IC0xLAogICAgICAgIFFROiBlLmluZGV4T2YoIlFRLyIpID4gLTEsCiAgICAgICAgQmFpZHU6IGUuaW5kZXhPZigiQmFpZHUiKSA+IC0xIHx8IGUuaW5kZXhPZigiQklEVUJyb3dzZXIiKSA+IC0xLAogICAgICAgIE1heHRob246IGUuaW5kZXhPZigiTWF4dGhvbiIpID4gLTEsCiAgICAgICAgU29nb3U6IGUuaW5kZXhPZigiTWV0YVNyIikgPiAtMSB8fCBlLmluZGV4T2YoIlNvZ291IikgPiAtMSwKICAgICAgICBMQkJST1dTRVI6IGUuaW5kZXhPZigiTEJCUk9XU0VSIikgPiAtMSwKICAgICAgICAiMjM0NUV4cGxvcmVyIjogZS5pbmRleE9mKCIyMzQ1RXhwbG9yZXIiKSA+IC0xLAogICAgICAgIFRoZVdvcmxkOiBlLmluZGV4T2YoIlRoZVdvcmxkIikgPiAtMSwKICAgICAgICBYaWFvTWk6IGUuaW5kZXhPZigiTWl1aUJyb3dzZXIiKSA+IC0xLAogICAgICAgIFF1YXJrOiBlLmluZGV4T2YoIlF1YXJrIikgPiAtMSwKICAgICAgICBRaXl1OiBlLmluZGV4T2YoIlFpeXUiKSA+IC0xLAogICAgICAgIFdlY2hhdDogZS5pbmRleE9mKCJNaWNyb01lc3NlbmdlciIpID4gLTEsCiAgICAgICAgVGFvYmFvOiBlLmluZGV4T2YoIkFsaUFwcChUQiIpID4gLTEsCiAgICAgICAgQWxpcGF5OiBlLmluZGV4T2YoIkFsaUFwcChBUCIpID4gLTEsCiAgICAgICAgV2VpYm86IGUuaW5kZXhPZigiV2VpYm8iKSA+IC0xLAogICAgICAgIERvdWJhbjogZS5pbmRleE9mKCJjb20uZG91YmFuLmZyb2RvIikgPiAtMSwKICAgICAgICBTdW5pbmc6IGUuaW5kZXhPZigiU05FQlVZLUFQUCIpID4gLTEsCiAgICAgICAgaVFpWWk6IGUuaW5kZXhPZigiSXFpeWlBcHAiKSA+IC0xLAogICAgICAgIFdpbmRvd3M6IGUuaW5kZXhPZigiV2luZG93cyIpID4gLTEsCiAgICAgICAgTGludXg6IGUuaW5kZXhPZigiTGludXgiKSA+IC0xIHx8IGUuaW5kZXhPZigiWDExIikgPiAtMSwKICAgICAgICBtYWNPUzogZS5pbmRleE9mKCJNYWNpbnRvc2giKSA+IC0xLAogICAgICAgIEFuZHJvaWQ6IGUuaW5kZXhPZigiQW5kcm9pZCIpID4gLTEgfHwgZS5pbmRleE9mKCJBZHIiKSA+IC0xLAogICAgICAgIFVidW50dTogZS5pbmRleE9mKCJVYnVudHUiKSA+IC0xLAogICAgICAgIEZyZWVCU0Q6IGUuaW5kZXhPZigiRnJlZUJTRCIpID4gLTEsCiAgICAgICAgRGViaWFuOiBlLmluZGV4T2YoIkRlYmlhbiIpID4gLTEsCiAgICAgICAgIldpbmRvd3MgUGhvbmUiOiBlLmluZGV4T2YoIklFTW9iaWxlIikgPiAtMSB8fCBlLmluZGV4T2YoIldpbmRvd3MgUGhvbmUiKSA+IC0xLAogICAgICAgIEJsYWNrQmVycnk6IGUuaW5kZXhPZigiQmxhY2tCZXJyeSIpID4gLTEgfHwgZS5pbmRleE9mKCJSSU0iKSA+IC0xIHx8IGUuaW5kZXhPZigiQkIxMCIpID4gLTEsCiAgICAgICAgTWVlR286IGUuaW5kZXhPZigiTWVlR28iKSA+IC0xLAogICAgICAgIFN5bWJpYW46IGUuaW5kZXhPZigiU3ltYmlhbiIpID4gLTEsCiAgICAgICAgaU9TOiBlLmluZGV4T2YoImxpa2UgTWFjIE9TIFgiKSA+IC0xLAogICAgICAgICJDaHJvbWUgT1MiOiBlLmluZGV4T2YoIkNyT1MiKSA+IC0xLAogICAgICAgIFdlYk9TOiBlLmluZGV4T2YoImhwd09TIikgPiAtMSwKICAgICAgICBNb2JpbGU6IGUuaW5kZXhPZigiTW9iaSIpID4gLTEgfHwgZS5pbmRleE9mKCJpUGgiKSA+IC0xIHx8IGUuaW5kZXhPZigiNDgwIikgPiAtMSwKICAgICAgICBUYWJsZXQ6IGUuaW5kZXhPZigiVGFibGV0IikgPiAtMSB8fCBlLmluZGV4T2YoIlBhZCIpID4gLTEgfHwgZS5pbmRleE9mKCJOZXh1cyA3IikgPiAtMQogICAgICB9OwogICAgICBuLk1vYmlsZSAmJiAobi5Nb2JpbGUgPSAhKGUuaW5kZXhPZigiaVBhZCIpID4gLTEpKTsKICAgICAgdmFyIHIgPSB7CiAgICAgICAgYnJvd3NlcjogWyJTYWZhcmkiLCAiQ2hyb21lIiwgIkVkZ2UiLCAiSUUiLCAiRmlyZWZveCIsICJGaXJlZm94IEZvY3VzIiwgIkNocm9taXVtIiwgIk9wZXJhIiwgIlZpdmFsZGkiLCAiWWFuZGV4IiwgIktpbmRsZSIsICIzNjAiLCAiVUMiLCAiUVFCcm93c2VyIiwgIlFRIiwgIkJhaWR1IiwgIk1heHRob24iLCAiU29nb3UiLCAiTEJCUk9XU0VSIiwgIjIzNDVFeHBsb3JlciIsICJUaGVXb3JsZCIsICJYaWFvTWkiLCAiUXVhcmsiLCAiUWl5dSIsICJXZWNoYXQiLCAiVGFvYmFvIiwgIkFsaXBheSIsICJXZWlibyIsICJEb3ViYW4iLCAiU3VuaW5nIiwgImlRaVlpIl0sCiAgICAgICAgb3M6IFsiV2luZG93cyIsICJMaW51eCIsICJNYWMgT1MiLCAibWFjT1MiLCAiQW5kcm9pZCIsICJVYnVudHUiLCAiRnJlZUJTRCIsICJEZWJpYW4iLCAiaU9TIiwgIldpbmRvd3MgUGhvbmUiLCAiQmxhY2tCZXJyeSIsICJNZWVHbyIsICJTeW1iaWFuIiwgIkNocm9tZSBPUyIsICJXZWJPUyJdCiAgICAgIH07CgogICAgICBmb3IgKHZhciBvIGluIHIpIHsKICAgICAgICBpZiAoci5oYXNPd25Qcm9wZXJ0eShvKSkgZm9yICh2YXIgaSA9IDAsIGEgPSByW29dLmxlbmd0aDsgaSA8IGE7IGkrKykgewogICAgICAgICAgdmFyIHMgPSByW29dW2ldOwogICAgICAgICAgbltzXSAmJiAodFtvXSA9IHMpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGwgPSB7CiAgICAgICAgV2luZG93czogZnVuY3Rpb24gV2luZG93cygpIHsKICAgICAgICAgIHZhciB0ID0gZS5yZXBsYWNlKC9eLipXaW5kb3dzIE5UIChbXGQuXSspLiokLywgIiQxIik7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICA2LjQ6ICIxMCIsCiAgICAgICAgICAgIDYuMzogIjguMSIsCiAgICAgICAgICAgIDYuMjogIjgiLAogICAgICAgICAgICA2LjE6ICI3IiwKICAgICAgICAgICAgIjYuMCI6ICJWaXN0YSIsCiAgICAgICAgICAgIDUuMjogIlhQIiwKICAgICAgICAgICAgNS4xOiAiWFAiLAogICAgICAgICAgICAiNS4wIjogIjIwMDAiCiAgICAgICAgICB9W3RdIHx8IHQ7CiAgICAgICAgfSwKICAgICAgICBBbmRyb2lkOiBlLnJlcGxhY2UoL14uKkFuZHJvaWQgKFtcZC5dKyk7LiokLywgIiQxIiksCiAgICAgICAgaU9TOiBlLnJlcGxhY2UoL14uKk9TIChbXGRfXSspIGxpa2UuKiQvLCAiJDEiKS5yZXBsYWNlKC9fL2csICIuIiksCiAgICAgICAgRGViaWFuOiBlLnJlcGxhY2UoL14uKkRlYmlhblwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICAiV2luZG93cyBQaG9uZSI6IGUucmVwbGFjZSgvXi4qV2luZG93cyBQaG9uZSggT1MpPyAoW1xkLl0rKTsuKiQvLCAiJDIiKSwKICAgICAgICBtYWNPUzogZS5yZXBsYWNlKC9eLipNYWMgT1MgWCAoW1xkX10rKS4qJC8sICIkMSIpLnJlcGxhY2UoL18vZywgIi4iKSwKICAgICAgICBXZWJPUzogZS5yZXBsYWNlKC9eLipocHdPU1wvKFtcZC5dKyk7LiokLywgIiQxIiksCiAgICAgICAgQmxhY2tCZXJyeTogZS5yZXBsYWNlKC9eLipCQihbXGQuXSspOyokLywgIiQxIikKICAgICAgfTsKICAgICAgdC5vc1ZlcnNpb24gPSAiIjsKICAgICAgdmFyIGMgPSBsW3Qub3NdOwogICAgICBjICYmICh0Lm9zVmVyc2lvbiA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGMgPyBjKCkgOiBjID09IGUgPyAiIiA6IGMpOwogICAgICB2YXIgdSA9IHsKICAgICAgICBTYWZhcmk6IGUucmVwbGFjZSgvXi4qVmVyc2lvblwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBDaHJvbWU6IGUucmVwbGFjZSgvXi4qQ2hyb21lXC8oW1xkLl0rKS4qJC8sICIkMSIpLnJlcGxhY2UoL14uKkNyaU9TXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIElFOiBlLnJlcGxhY2UoL14uKk1TSUUgKFtcZC5dKykuKiQvLCAiJDEiKS5yZXBsYWNlKC9eLipydjooW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIEVkZ2U6IGUucmVwbGFjZSgvXi4qRWRnZT9cLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgRmlyZWZveDogZS5yZXBsYWNlKC9eLipGaXJlZm94XC8oW1xkLl0rKS4qJC8sICIkMSIpLnJlcGxhY2UoL14uKkZ4aU9TXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgICJGaXJlZm94IEZvY3VzIjogZS5yZXBsYWNlKC9eLipGb2N1c1wvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBDaHJvbWl1bTogZS5yZXBsYWNlKC9eLipDaHJvbWl1bVwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBPcGVyYTogZS5yZXBsYWNlKC9eLipPcGVyYVwvKFtcZC5dKykuKiQvLCAiJDEiKS5yZXBsYWNlKC9eLipPUFJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgVml2YWxkaTogZS5yZXBsYWNlKC9eLipWaXZhbGRpXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFlhbmRleDogZS5yZXBsYWNlKC9eLipZYUJyb3dzZXJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgS2luZGxlOiBlLnJlcGxhY2UoL14uKlZlcnNpb25cLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgTWF4dGhvbjogZS5yZXBsYWNlKC9eLipNYXh0aG9uXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFFRQnJvd3NlcjogZS5yZXBsYWNlKC9eLipRUUJyb3dzZXJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgUVE6IGUucmVwbGFjZSgvXi4qUVFcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgQmFpZHU6IGUucmVwbGFjZSgvXi4qQklEVUJyb3dzZXJbXHNcL10oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFVDOiBlLnJlcGxhY2UoL14uKlVDP0Jyb3dzZXJcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgU29nb3U6IGUucmVwbGFjZSgvXi4qU0UgKFtcZC5YXSspLiokLywgIiQxIikucmVwbGFjZSgvXi4qU29nb3VNb2JpbGVCcm93c2VyXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgICIyMzQ1RXhwbG9yZXIiOiBlLnJlcGxhY2UoL14uKjIzNDVFeHBsb3JlclwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBUaGVXb3JsZDogZS5yZXBsYWNlKC9eLipUaGVXb3JsZCAoW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFhpYW9NaTogZS5yZXBsYWNlKC9eLipNaXVpQnJvd3NlclwvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBRdWFyazogZS5yZXBsYWNlKC9eLipRdWFya1wvKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBRaXl1OiBlLnJlcGxhY2UoL14uKlFpeXVcLyhbXGQuXSspLiokLywgIiQxIiksCiAgICAgICAgV2VjaGF0OiBlLnJlcGxhY2UoL14uKk1pY3JvTWVzc2VuZ2VyXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFRhb2JhbzogZS5yZXBsYWNlKC9eLipBbGlBcHBcKFRCXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIEFsaXBheTogZS5yZXBsYWNlKC9eLipBbGlBcHBcKEFQXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFdlaWJvOiBlLnJlcGxhY2UoL14uKndlaWJvX18oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIERvdWJhbjogZS5yZXBsYWNlKC9eLipjb20uZG91YmFuLmZyb2RvXC8oW1xkLl0rKS4qJC8sICIkMSIpLAogICAgICAgIFN1bmluZzogZS5yZXBsYWNlKC9eLipTTkVCVVktQVBQKFtcZC5dKykuKiQvLCAiJDEiKSwKICAgICAgICBpUWlZaTogZS5yZXBsYWNlKC9eLipJcWl5aVZlcnNpb25cLyhbXGQuXSspLiokLywgIiQxIikKICAgICAgfTsKICAgICAgdC52ZXJzaW9uID0gIiI7CiAgICAgIHZhciBkID0gdVt0LmJyb3dzZXJdOwogICAgICByZXR1cm4gZCAmJiAodC52ZXJzaW9uID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgZCA/IGQoKSA6IGQgPT0gZSA/ICIiIDogZCksIHZvaWQgMCA9PSB0LmJyb3dzZXIgJiYgKHQuYnJvd3NlciA9ICJVbmtub3cgQXBwIiksIHQ7CiAgICB9OwoKICAgIHRbImRlZmF1bHQiXSA9IHI7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIHZhciByLCBvOwogICAgIWZ1bmN0aW9uIChuLCBpKSB7CiAgICAgIHZhciBpID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgICBmdW5jdGlvbiByKG8sIGksIGEpIHsKICAgICAgICAgIHJldHVybiBhID0gT2JqZWN0LmNyZWF0ZShyLmZuKSwgbyAmJiBhLnB1c2guYXBwbHkoYSwgb1t0XSA/IFtvXSA6ICIiICsgbyA9PT0gbyA/IC88Ly50ZXN0KG8pID8gKChpID0gZS5jcmVhdGVFbGVtZW50KGkpKS5pbm5lckhUTUwgPSBvLCBpLmNoaWxkcmVuKSA6IGkgPyAoaSA9IHIoaSlbMF0pID8gaVtuXShvKSA6IGEgOiBlW25dKG8pIDogbyksIGE7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gci5mbiA9IFtdLCByLm9uZSA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICByZXR1cm4gcihlLCB0KVswXSB8fCBudWxsOwogICAgICAgIH0sIHI7CiAgICAgIH0oZG9jdW1lbnQsICJhZGRFdmVudExpc3RlbmVyIiwgInF1ZXJ5U2VsZWN0b3JBbGwiKTsKCiAgICAgIHIgPSBbXSwgdm9pZCAwICE9PSAobyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gaTsKICAgICAgfS5hcHBseSh0LCByKSkgJiYgKGUuZXhwb3J0cyA9IG8pOwogICAgfSgpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gZSB8fCBudWxsID09PSBlOwogICAgfQoKICAgIGZ1bmN0aW9uIG8oZSkgewogICAgICB2YXIgdCA9IHt9OwoKICAgICAgZm9yICh2YXIgbiBpbiBlKSB7CiAgICAgICAgdFtuXSA9IGVbbl07CiAgICAgIH0KCiAgICAgIHJldHVybiB0OwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSkgewogICAgICBlID0gbyhlIHx8IHt9KSwgZS53aGl0ZUxpc3QgPSBlLndoaXRlTGlzdCB8fCBhLndoaXRlTGlzdCwgZS5vbkF0dHIgPSBlLm9uQXR0ciB8fCBhLm9uQXR0ciwgZS5vbklnbm9yZUF0dHIgPSBlLm9uSWdub3JlQXR0ciB8fCBhLm9uSWdub3JlQXR0ciwgZS5zYWZlQXR0clZhbHVlID0gZS5zYWZlQXR0clZhbHVlIHx8IGEuc2FmZUF0dHJWYWx1ZSwgdGhpcy5vcHRpb25zID0gZTsKICAgIH0KCiAgICB2YXIgYSA9IG4oNyksCiAgICAgICAgcyA9IG4oMzApOwogICAgbig4KTsKICAgIGkucHJvdG90eXBlLnByb2Nlc3MgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoZSA9IGUgfHwgIiIsICEoZSA9IGUudG9TdHJpbmcoKSkpIHJldHVybiAiIjsKICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgbiA9IHQub3B0aW9ucywKICAgICAgICAgIG8gPSBuLndoaXRlTGlzdCwKICAgICAgICAgIGkgPSBuLm9uQXR0ciwKICAgICAgICAgIGEgPSBuLm9uSWdub3JlQXR0ciwKICAgICAgICAgIGwgPSBuLnNhZmVBdHRyVmFsdWU7CiAgICAgIHJldHVybiBzKGUsIGZ1bmN0aW9uIChlLCB0LCBuLCBzLCBjKSB7CiAgICAgICAgdmFyIHUgPSBvW25dLAogICAgICAgICAgICBkID0gITE7CgogICAgICAgIGlmICghMCA9PT0gdSA/IGQgPSB1IDogImZ1bmN0aW9uIiA9PSB0eXBlb2YgdSA/IGQgPSB1KHMpIDogdSBpbnN0YW5jZW9mIFJlZ0V4cCAmJiAoZCA9IHUudGVzdChzKSksICEwICE9PSBkICYmIChkID0gITEpLCBzID0gbChuLCBzKSkgewogICAgICAgICAgdmFyIHAgPSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiB0LAogICAgICAgICAgICBzb3VyY2VQb3NpdGlvbjogZSwKICAgICAgICAgICAgc291cmNlOiBjLAogICAgICAgICAgICBpc1doaXRlOiBkCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChkKSB7CiAgICAgICAgICAgIHZhciBmID0gaShuLCBzLCBwKTsKICAgICAgICAgICAgcmV0dXJuIHIoZikgPyBuICsgIjoiICsgcyA6IGY7CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGYgPSBhKG4sIHMsIHApOwogICAgICAgICAgcmV0dXJuIHIoZikgPyB2b2lkIDAgOiBmOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LCBlLmV4cG9ydHMgPSBpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICBmdW5jdGlvbiByKGUsIHQpIHsKICAgICAgZnVuY3Rpb24gbigpIHsKICAgICAgICBpZiAoIWkpIHsKICAgICAgICAgIHZhciBuID0gby50cmltKGUuc2xpY2UoYSwgcykpLAogICAgICAgICAgICAgIHIgPSBuLmluZGV4T2YoIjoiKTsKCiAgICAgICAgICBpZiAoLTEgIT09IHIpIHsKICAgICAgICAgICAgdmFyIGMgPSBvLnRyaW0obi5zbGljZSgwLCByKSksCiAgICAgICAgICAgICAgICB1ID0gby50cmltKG4uc2xpY2UociArIDEpKTsKCiAgICAgICAgICAgIGlmIChjKSB7CiAgICAgICAgICAgICAgdmFyIGQgPSB0KGEsIGwubGVuZ3RoLCBjLCB1LCBuKTsKICAgICAgICAgICAgICBkICYmIChsICs9IGQgKyAiOyAiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYSA9IHMgKyAxOwogICAgICB9CgogICAgICBlID0gby50cmltUmlnaHQoZSksICI7IiAhPT0gZVtlLmxlbmd0aCAtIDFdICYmIChlICs9ICI7Iik7CgogICAgICBmb3IgKHZhciByID0gZS5sZW5ndGgsIGkgPSAhMSwgYSA9IDAsIHMgPSAwLCBsID0gIiI7IHMgPCByOyBzKyspIHsKICAgICAgICB2YXIgYyA9IGVbc107CgogICAgICAgIGlmICgiLyIgPT09IGMgJiYgIioiID09PSBlW3MgKyAxXSkgewogICAgICAgICAgdmFyIHUgPSBlLmluZGV4T2YoIiovIiwgcyArIDIpOwogICAgICAgICAgaWYgKC0xID09PSB1KSBicmVhazsKICAgICAgICAgIHMgPSB1ICsgMSwgYSA9IHMgKyAxLCBpID0gITE7CiAgICAgICAgfSBlbHNlICIoIiA9PT0gYyA/IGkgPSAhMCA6ICIpIiA9PT0gYyA/IGkgPSAhMSA6ICI7IiA9PT0gYyA/IGkgfHwgbigpIDogIlxuIiA9PT0gYyAmJiBuKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBvLnRyaW0obCk7CiAgICB9CgogICAgdmFyIG8gPSBuKDgpOwogICAgZS5leHBvcnRzID0gcjsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gbigzNSksCiAgICAgICAgbyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsCiAgICAgICAgaSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksCiAgICAgICAgYSA9IGZ1bmN0aW9uIGEoZSwgdCwgbikgewogICAgICBmb3IgKHZhciByID0gMCwgbyA9IGUubGVuZ3RoOyByIDwgbzsgcisrKSB7CiAgICAgICAgaS5jYWxsKGUsIHIpICYmIChudWxsID09IG4gPyB0KGVbcl0sIHIsIGUpIDogdC5jYWxsKG4sIGVbcl0sIHIsIGUpKTsKICAgICAgfQogICAgfSwKICAgICAgICBzID0gZnVuY3Rpb24gcyhlLCB0LCBuKSB7CiAgICAgIGZvciAodmFyIHIgPSAwLCBvID0gZS5sZW5ndGg7IHIgPCBvOyByKyspIHsKICAgICAgICBudWxsID09IG4gPyB0KGUuY2hhckF0KHIpLCByLCBlKSA6IHQuY2FsbChuLCBlLmNoYXJBdChyKSwgciwgZSk7CiAgICAgIH0KICAgIH0sCiAgICAgICAgbCA9IGZ1bmN0aW9uIGwoZSwgdCwgbikgewogICAgICBmb3IgKHZhciByIGluIGUpIHsKICAgICAgICBpLmNhbGwoZSwgcikgJiYgKG51bGwgPT0gbiA/IHQoZVtyXSwgciwgZSkgOiB0LmNhbGwobiwgZVtyXSwgciwgZSkpOwogICAgICB9CiAgICB9LAogICAgICAgIGMgPSBmdW5jdGlvbiBjKGUsIHQsIG4pIHsKICAgICAgaWYgKCFyKHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJpdGVyYXRvciBtdXN0IGJlIGEgZnVuY3Rpb24iKTsKICAgICAgdmFyIGk7CiAgICAgIGFyZ3VtZW50cy5sZW5ndGggPj0gMyAmJiAoaSA9IG4pLCAiW29iamVjdCBBcnJheV0iID09PSBvLmNhbGwoZSkgPyBhKGUsIHQsIGkpIDogInN0cmluZyIgPT0gdHlwZW9mIGUgPyBzKGUsIHQsIGkpIDogbChlLCB0LCBpKTsKICAgIH07CgogICAgZS5leHBvcnRzID0gYzsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLAogICAgICAgIG8gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0ID0gdGhpczsKICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIHQgfHwgIltvYmplY3QgRnVuY3Rpb25dIiAhPT0gby5jYWxsKHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJGdW5jdGlvbi5wcm90b3R5cGUuYmluZCBjYWxsZWQgb24gaW5jb21wYXRpYmxlICIgKyB0KTsKCiAgICAgIGZvciAodmFyIG4sIGkgPSByLmNhbGwoYXJndW1lbnRzLCAxKSwgYSA9IGZ1bmN0aW9uIGEoKSB7CiAgICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBuKSB7CiAgICAgICAgICB2YXIgbyA9IHQuYXBwbHkodGhpcywgaS5jb25jYXQoci5jYWxsKGFyZ3VtZW50cykpKTsKICAgICAgICAgIHJldHVybiBPYmplY3QobykgPT09IG8gPyBvIDogdGhpczsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0LmFwcGx5KGUsIGkuY29uY2F0KHIuY2FsbChhcmd1bWVudHMpKSk7CiAgICAgIH0sIHMgPSBNYXRoLm1heCgwLCB0Lmxlbmd0aCAtIGkubGVuZ3RoKSwgbCA9IFtdLCBjID0gMDsgYyA8IHM7IGMrKykgewogICAgICAgIGwucHVzaCgiJCIgKyBjKTsKICAgICAgfQoKICAgICAgaWYgKG4gPSBGdW5jdGlvbigiYmluZGVyIiwgInJldHVybiBmdW5jdGlvbiAoIiArIGwuam9pbigiLCIpICsgIil7IHJldHVybiBiaW5kZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpOyB9IikoYSksIHQucHJvdG90eXBlKSB7CiAgICAgICAgdmFyIHUgPSBmdW5jdGlvbiB1KCkge307CgogICAgICAgIHUucHJvdG90eXBlID0gdC5wcm90b3R5cGUsIG4ucHJvdG90eXBlID0gbmV3IHUoKSwgdS5wcm90b3R5cGUgPSBudWxsOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICFmdW5jdGlvbiAodCwgbikgewogICAgICBlLmV4cG9ydHMgPSBuKCk7CiAgICB9KDAsIGZ1bmN0aW9uICgpIHsKICAgICAgInVzZSBzdHJpY3QiOwoKICAgICAgZnVuY3Rpb24gZShlKSB7CiAgICAgICAgcmV0dXJuICc8c3BhbiBzdHlsZT0iY29sb3I6IHNsYXRlZ3JheSI+JyArIGUgKyAiPC9zcGFuPiI7CiAgICAgIH0KCiAgICAgIHZhciB0ID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICByZXR1cm4gdCA9IHsKICAgICAgICAgIGV4cG9ydHM6IHt9CiAgICAgICAgfSwgZSh0LCB0LmV4cG9ydHMpLCB0LmV4cG9ydHM7CiAgICAgIH0oZnVuY3Rpb24gKGUpIHsKICAgICAgICB2YXIgdCA9IGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKCIoPzoiICsgdC5saW5lKCkuc291cmNlICsgIil8KD86IiArIHQuYmxvY2soKS5zb3VyY2UgKyAiKSIsICJnbSIpOwogICAgICAgIH07CgogICAgICAgIHQubGluZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAvKD86XnxccylcL1wvKC4rPykkL2dtOwogICAgICAgIH0sIHQuYmxvY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gL1wvXCooW1xTXHNdKj8pXCpcLy9nbTsKICAgICAgICB9OwogICAgICB9KSwKICAgICAgICAgIG4gPSBbIjIzQUM2OSIsICI5MUMxMzIiLCAiRjE5NzI2IiwgIkU4NTUyRCIsICIxQUFCOEUiLCAiRTExNDdGIiwgIjI5ODBDMSIsICIxQkExRTYiLCAiOUZBMEEwIiwgIkYxOTcyNiIsICJFMzBCMjAiLCAiRTMwQjIwIiwgIkEzMzM4QiJdOwoKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChyLCBvKSB7CiAgICAgICAgdm9pZCAwID09PSBvICYmIChvID0ge30pOwogICAgICAgIHZhciBpID0gby5jb2xvcnM7CiAgICAgICAgdm9pZCAwID09PSBpICYmIChpID0gbik7CiAgICAgICAgdmFyIGEgPSAwLAogICAgICAgICAgICBzID0ge30sCiAgICAgICAgICAgIGwgPSAvW1x1NEUwMC1cdTlGRkZcdTM0MDAtXHU0ZGJmXHVmOTAwLVx1ZmFmZlx1MzA0MC1cdTMwOWZcdWFjMDAtXHVkN2FmXHUwNDAwLVx1MDRGRl0rfFx3Ky8sCiAgICAgICAgICAgIGMgPSAvPC8sCiAgICAgICAgICAgIHUgPSBuZXcgUmVnRXhwKCIoIiArIGwuc291cmNlICsgInwiICsgYy5zb3VyY2UgKyAiKXwoIiArIHQoKS5zb3VyY2UgKyAiKSIsICJnbWkiKTsKICAgICAgICByZXR1cm4gci5yZXBsYWNlKHUsIGZ1bmN0aW9uICh0LCBuLCByKSB7CiAgICAgICAgICBpZiAocikgcmV0dXJuIGUocik7CiAgICAgICAgICBpZiAoIjwiID09PSBuKSByZXR1cm4gIiZsdDsiOwogICAgICAgICAgdmFyIG87CiAgICAgICAgICBzW25dID8gbyA9IHNbbl0gOiAobyA9IGlbYV0sIHNbbl0gPSBvKTsKICAgICAgICAgIHZhciBsID0gJzxzcGFuIHN0eWxlPSJjb2xvcjogIycgKyBvICsgJyI+JyArIG4gKyAiPC9zcGFuPiI7CiAgICAgICAgICByZXR1cm4gYSA9ICsrYSAlIGkubGVuZ3RoLCBsOwogICAgICAgIH0pOwogICAgICB9OwogICAgfSk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oNCk7CiAgICBlLmV4cG9ydHMgPSByLmNhbGwoRnVuY3Rpb24uY2FsbCwgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IEZ1bmN0aW9uLnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICBvID0gL15ccypjbGFzc1xiLywKICAgICAgICBpID0gZnVuY3Rpb24gaShlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdmFyIHQgPSByLmNhbGwoZSk7CiAgICAgICAgcmV0dXJuIG8udGVzdCh0KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiAhMTsKICAgICAgfQogICAgfSwKICAgICAgICBhID0gZnVuY3Rpb24gYShlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgcmV0dXJuICFpKGUpICYmIChyLmNhbGwoZSksICEwKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiAhMTsKICAgICAgfQogICAgfSwKICAgICAgICBzID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICBsID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmICJzeW1ib2wiID09IF90eXBlb2YoU3ltYm9sLnRvU3RyaW5nVGFnKTsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICBpZiAoIWUpIHJldHVybiAhMTsKICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUgJiYgIm9iamVjdCIgIT0gX3R5cGVvZihlKSkgcmV0dXJuICExOwogICAgICBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSAmJiAhZS5wcm90b3R5cGUpIHJldHVybiAhMDsKICAgICAgaWYgKGwpIHJldHVybiBhKGUpOwogICAgICBpZiAoaShlKSkgcmV0dXJuICExOwogICAgICB2YXIgdCA9IHMuY2FsbChlKTsKICAgICAgcmV0dXJuICJbb2JqZWN0IEZ1bmN0aW9uXSIgPT09IHQgfHwgIltvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dIiA9PT0gdDsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIChmdW5jdGlvbiAodCkgewogICAgICAhZnVuY3Rpb24gKHQpIHsKICAgICAgICAidXNlIHN0cmljdCI7CgogICAgICAgIGZ1bmN0aW9uIG4oZSkgewogICAgICAgICAgdGhpcy50b2tlbnMgPSBbXSwgdGhpcy50b2tlbnMubGlua3MgPSB7fSwgdGhpcy5vcHRpb25zID0gZSB8fCBoLmRlZmF1bHRzLCB0aGlzLnJ1bGVzID0gdi5ub3JtYWwsIHRoaXMub3B0aW9ucy5wZWRhbnRpYyA/IHRoaXMucnVsZXMgPSB2LnBlZGFudGljIDogdGhpcy5vcHRpb25zLmdmbSAmJiAodGhpcy5vcHRpb25zLnRhYmxlcyA/IHRoaXMucnVsZXMgPSB2LnRhYmxlcyA6IHRoaXMucnVsZXMgPSB2LmdmbSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiByKGUsIHQpIHsKICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMgPSB0IHx8IGguZGVmYXVsdHMsIHRoaXMubGlua3MgPSBlLCB0aGlzLnJ1bGVzID0gZy5ub3JtYWwsIHRoaXMucmVuZGVyZXIgPSB0aGlzLm9wdGlvbnMucmVuZGVyZXIgfHwgbmV3IG8oKSwgdGhpcy5yZW5kZXJlci5vcHRpb25zID0gdGhpcy5vcHRpb25zLCAhdGhpcy5saW5rcykgdGhyb3cgbmV3IEVycm9yKCJUb2tlbnMgYXJyYXkgcmVxdWlyZXMgYSBgbGlua3NgIHByb3BlcnR5LiIpOwogICAgICAgICAgdGhpcy5vcHRpb25zLnBlZGFudGljID8gdGhpcy5ydWxlcyA9IGcucGVkYW50aWMgOiB0aGlzLm9wdGlvbnMuZ2ZtICYmICh0aGlzLm9wdGlvbnMuYnJlYWtzID8gdGhpcy5ydWxlcyA9IGcuYnJlYWtzIDogdGhpcy5ydWxlcyA9IGcuZ2ZtKTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIG8oZSkgewogICAgICAgICAgdGhpcy5vcHRpb25zID0gZSB8fCBoLmRlZmF1bHRzOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gaSgpIHt9CgogICAgICAgIGZ1bmN0aW9uIGEoZSkgewogICAgICAgICAgdGhpcy50b2tlbnMgPSBbXSwgdGhpcy50b2tlbiA9IG51bGwsIHRoaXMub3B0aW9ucyA9IGUgfHwgaC5kZWZhdWx0cywgdGhpcy5vcHRpb25zLnJlbmRlcmVyID0gdGhpcy5vcHRpb25zLnJlbmRlcmVyIHx8IG5ldyBvKCksIHRoaXMucmVuZGVyZXIgPSB0aGlzLm9wdGlvbnMucmVuZGVyZXIsIHRoaXMucmVuZGVyZXIub3B0aW9ucyA9IHRoaXMub3B0aW9uczsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHMoZSwgdCkgewogICAgICAgICAgcmV0dXJuIGUucmVwbGFjZSh0ID8gLyYvZyA6IC8mKD8hIz9cdys7KS9nLCAiJmFtcDsiKS5yZXBsYWNlKC88L2csICImbHQ7IikucmVwbGFjZSgvPi9nLCAiJmd0OyIpLnJlcGxhY2UoLyIvZywgIiZxdW90OyIpLnJlcGxhY2UoLycvZywgIiYjMzk7Iik7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBsKGUpIHsKICAgICAgICAgIHJldHVybiBlLnJlcGxhY2UoLyYoIyg/OlxkKyl8KD86I3hbMC05QS1GYS1mXSspfCg/Olx3KykpOz8vZ2ksIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICAgIHJldHVybiB0ID0gdC50b0xvd2VyQ2FzZSgpLCAiY29sb24iID09PSB0ID8gIjoiIDogIiMiID09PSB0LmNoYXJBdCgwKSA/ICJ4IiA9PT0gdC5jaGFyQXQoMSkgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KHQuc3Vic3RyaW5nKDIpLCAxNikpIDogU3RyaW5nLmZyb21DaGFyQ29kZSgrdC5zdWJzdHJpbmcoMSkpIDogIiI7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICAgICAgcmV0dXJuIGUgPSBlLnNvdXJjZSB8fCBlLCB0ID0gdCB8fCAiIiwgewogICAgICAgICAgICByZXBsYWNlOiBmdW5jdGlvbiByZXBsYWNlKHQsIG4pIHsKICAgICAgICAgICAgICByZXR1cm4gbiA9IG4uc291cmNlIHx8IG4sIG4gPSBuLnJlcGxhY2UoLyhefFteXFtdKVxeL2csICIkMSIpLCBlID0gZS5yZXBsYWNlKHQsIG4pLCB0aGlzOwogICAgICAgICAgICB9LAogICAgICAgICAgICBnZXRSZWdleDogZnVuY3Rpb24gZ2V0UmVnZXgoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoZSwgdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB1KGUsIHQpIHsKICAgICAgICAgIHJldHVybiBtWyIgIiArIGVdIHx8ICgvXlteOl0rOlwvKlteL10qJC8udGVzdChlKSA/IG1bIiAiICsgZV0gPSBlICsgIi8iIDogbVsiICIgKyBlXSA9IGUucmVwbGFjZSgvW14vXSokLywgIiIpKSwgZSA9IG1bIiAiICsgZV0sICIvLyIgPT09IHQuc2xpY2UoMCwgMikgPyBlLnJlcGxhY2UoLzpbXHNcU10qLywgIjoiKSArIHQgOiAiLyIgPT09IHQuY2hhckF0KDApID8gZS5yZXBsYWNlKC8oOlwvKlteL10qKVtcc1xTXSovLCAiJDEiKSArIHQgOiBlICsgdDsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGQoKSB7fQoKICAgICAgICBmdW5jdGlvbiBwKGUpIHsKICAgICAgICAgIGZvciAodmFyIHQsIG4sIHIgPSAxOyByIDwgYXJndW1lbnRzLmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgIHQgPSBhcmd1bWVudHNbcl07CgogICAgICAgICAgICBmb3IgKG4gaW4gdCkgewogICAgICAgICAgICAgIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBuKSAmJiAoZVtuXSA9IHRbbl0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBmKGUsIHQpIHsKICAgICAgICAgIHZhciBuID0gZS5yZXBsYWNlKC8oW15cXF0pXHwvZywgIiQxIHwiKS5zcGxpdCgvICtcfCAqLyksCiAgICAgICAgICAgICAgciA9IDA7CiAgICAgICAgICBpZiAobi5sZW5ndGggPiB0KSBuLnNwbGljZSh0KTtlbHNlIGZvciAoOyBuLmxlbmd0aCA8IHQ7KSB7CiAgICAgICAgICAgIG4ucHVzaCgiIik7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yICg7IHIgPCBuLmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgIG5bcl0gPSBuW3JdLnJlcGxhY2UoL1xcXHwvZywgInwiKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbjsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGgoZSwgdCwgcikgewogICAgICAgICAgaWYgKHZvaWQgMCA9PT0gZSB8fCBudWxsID09PSBlKSB0aHJvdyBuZXcgRXJyb3IoIm1hcmtlZCgpOiBpbnB1dCBwYXJhbWV0ZXIgaXMgdW5kZWZpbmVkIG9yIG51bGwiKTsKICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgZSkgdGhyb3cgbmV3IEVycm9yKCJtYXJrZWQoKTogaW5wdXQgcGFyYW1ldGVyIGlzIG9mIHR5cGUgIiArIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKSArICIsIHN0cmluZyBleHBlY3RlZCIpOwoKICAgICAgICAgIGlmIChyIHx8ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQpIHsKICAgICAgICAgICAgciB8fCAociA9IHQsIHQgPSBudWxsKSwgdCA9IHAoe30sIGguZGVmYXVsdHMsIHQgfHwge30pOwogICAgICAgICAgICB2YXIgbywKICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICBsID0gdC5oaWdobGlnaHQsCiAgICAgICAgICAgICAgICBjID0gMDsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgbyA9IG4ubGV4KGUsIHQpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHIoZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGkgPSBvLmxlbmd0aDsKCiAgICAgICAgICAgIHZhciB1ID0gZnVuY3Rpb24gdShlKSB7CiAgICAgICAgICAgICAgaWYgKGUpIHJldHVybiB0LmhpZ2hsaWdodCA9IGwsIHIoZSk7CiAgICAgICAgICAgICAgdmFyIG47CgogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBuID0gYS5wYXJzZShvLCB0KTsKICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICBlID0gdDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiB0LmhpZ2hsaWdodCA9IGwsIGUgPyByKGUpIDogcihudWxsLCBuKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGlmICghbCB8fCBsLmxlbmd0aCA8IDMpIHJldHVybiB1KCk7CiAgICAgICAgICAgIGlmIChkZWxldGUgdC5oaWdobGlnaHQsICFpKSByZXR1cm4gdSgpOwoKICAgICAgICAgICAgZm9yICg7IGMgPCBvLmxlbmd0aDsgYysrKSB7CiAgICAgICAgICAgICAgIWZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAiY29kZSIgIT09IGUudHlwZSA/IC0taSB8fCB1KCkgOiBsKGUudGV4dCwgZS5sYW5nLCBmdW5jdGlvbiAodCwgbikgewogICAgICAgICAgICAgICAgICByZXR1cm4gdCA/IHUodCkgOiBudWxsID09IG4gfHwgbiA9PT0gZS50ZXh0ID8gLS1pIHx8IHUoKSA6IChlLnRleHQgPSBuLCBlLmVzY2FwZWQgPSAhMCwgdm9pZCAoLS1pIHx8IHUoKSkpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfShvW2NdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHRyeSB7CiAgICAgICAgICAgIHJldHVybiB0ICYmICh0ID0gcCh7fSwgaC5kZWZhdWx0cywgdCkpLCBhLnBhcnNlKG4ubGV4KGUsIHQpLCB0KTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgaWYgKGUubWVzc2FnZSArPSAiXG5QbGVhc2UgcmVwb3J0IHRoaXMgdG8gaHR0cHM6Ly9naXRodWIuY29tL21hcmtlZGpzL21hcmtlZC4iLCAodCB8fCBoLmRlZmF1bHRzKS5zaWxlbnQpIHJldHVybiAiPHA+QW4gZXJyb3Igb2NjdXJyZWQ6PC9wPjxwcmU+IiArIHMoZS5tZXNzYWdlICsgIiIsICEwKSArICI8L3ByZT4iOwogICAgICAgICAgICB0aHJvdyBlOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIHYgPSB7CiAgICAgICAgICBuZXdsaW5lOiAvXlxuKy8sCiAgICAgICAgICBjb2RlOiAvXiggezR9W15cbl0rXG4qKSsvLAogICAgICAgICAgZmVuY2VzOiBkLAogICAgICAgICAgaHI6IC9eIHswLDN9KCg/Oi0gKil7Myx9fCg/Ol8gKil7Myx9fCg/OlwqICopezMsfSkoPzpcbit8JCkvLAogICAgICAgICAgaGVhZGluZzogL14gKigjezEsNn0pICooW15cbl0rPykgKig/OiMrICopPyg/OlxuK3wkKS8sCiAgICAgICAgICBucHRhYmxlOiBkLAogICAgICAgICAgYmxvY2txdW90ZTogL14oIHswLDN9PiA/KHBhcmFncmFwaHxbXlxuXSopKD86XG58JCkpKy8sCiAgICAgICAgICBsaXN0OiAvXiggKikoYnVsbCkgW1xzXFNdKz8oPzpocnxkZWZ8XG57Mix9KD8hICkoPyFcMWJ1bGwgKVxuKnxccyokKS8sCiAgICAgICAgICBodG1sOiAiXiB7MCwzfSg/Ojwoc2NyaXB0fHByZXxzdHlsZSlbXFxzPl1bXFxzXFxTXSo/KD86PC9cXDE+W15cXG5dKlxcbit8JCl8Y29tbWVudFteXFxuXSooXFxuK3wkKXw8XFw/W1xcc1xcU10qP1xcPz5cXG4qfDwhW0EtWl1bXFxzXFxTXSo/Plxcbip8PCFcXFtDREFUQVxcW1tcXHNcXFNdKj9cXF1cXF0+XFxuKnw8Lz8odGFnKSg/OiArfFxcbnwvPz4pW1xcc1xcU10qPyg/OlxcbnsyLH18JCl8PCg/IXNjcmlwdHxwcmV8c3R5bGUpKFthLXpdW1xcdy1dKikoPzphdHRyaWJ1dGUpKj8gKi8/Pig/PVxcaCpcXG4pW1xcc1xcU10qPyg/OlxcbnsyLH18JCl8PC8oPyFzY3JpcHR8cHJlfHN0eWxlKVthLXpdW1xcdy1dKlxccyo+KD89XFxoKlxcbilbXFxzXFxTXSo/KD86XFxuezIsfXwkKSkiLAogICAgICAgICAgZGVmOiAvXiB7MCwzfVxbKGxhYmVsKVxdOiAqXG4/ICo8PyhbXlxzPl0rKT4/KD86KD86ICtcbj8gKnwgKlxuICopKHRpdGxlKSk/ICooPzpcbit8JCkvLAogICAgICAgICAgdGFibGU6IGQsCiAgICAgICAgICBsaGVhZGluZzogL14oW15cbl0rKVxuICooPXwtKXsyLH0gKig/OlxuK3wkKS8sCiAgICAgICAgICBwYXJhZ3JhcGg6IC9eKFteXG5dKyg/OlxuKD8haHJ8aGVhZGluZ3xsaGVhZGluZ3wgezAsM30+fDxcLz8oPzp0YWcpKD86ICt8XG58XC8/Pil8PCg/OnNjcmlwdHxwcmV8c3R5bGV8IS0tKSlbXlxuXSspKikvLAogICAgICAgICAgdGV4dDogL15bXlxuXSsvCiAgICAgICAgfTsKICAgICAgICB2Ll9sYWJlbCA9IC8oPyFccypcXSkoPzpcXFtcW1xdXXxbXlxbXF1dKSsvLCB2Ll90aXRsZSA9IC8oPzoiKD86XFwiP3xbXiJcXF0pKiJ8J1teJ1xuXSooPzpcblteJ1xuXSspKlxuPyd8XChbXigpXSpcKSkvLCB2LmRlZiA9IGModi5kZWYpLnJlcGxhY2UoImxhYmVsIiwgdi5fbGFiZWwpLnJlcGxhY2UoInRpdGxlIiwgdi5fdGl0bGUpLmdldFJlZ2V4KCksIHYuYnVsbGV0ID0gLyg/OlsqKy1dfFxkK1wuKS8sIHYuaXRlbSA9IC9eKCAqKShidWxsKSBbXlxuXSooPzpcbig/IVwxYnVsbCApW15cbl0qKSovLCB2Lml0ZW0gPSBjKHYuaXRlbSwgImdtIikucmVwbGFjZSgvYnVsbC9nLCB2LmJ1bGxldCkuZ2V0UmVnZXgoKSwgdi5saXN0ID0gYyh2Lmxpc3QpLnJlcGxhY2UoL2J1bGwvZywgdi5idWxsZXQpLnJlcGxhY2UoImhyIiwgIlxcbisoPz1cXDE/KD86KD86LSAqKXszLH18KD86XyAqKXszLH18KD86XFwqICopezMsfSkoPzpcXG4rfCQpKSIpLnJlcGxhY2UoImRlZiIsICJcXG4rKD89IiArIHYuZGVmLnNvdXJjZSArICIpIikuZ2V0UmVnZXgoKSwgdi5fdGFnID0gImFkZHJlc3N8YXJ0aWNsZXxhc2lkZXxiYXNlfGJhc2Vmb250fGJsb2NrcXVvdGV8Ym9keXxjYXB0aW9ufGNlbnRlcnxjb2x8Y29sZ3JvdXB8ZGR8ZGV0YWlsc3xkaWFsb2d8ZGlyfGRpdnxkbHxkdHxmaWVsZHNldHxmaWdjYXB0aW9ufGZpZ3VyZXxmb290ZXJ8Zm9ybXxmcmFtZXxmcmFtZXNldHxoWzEtNl18aGVhZHxoZWFkZXJ8aHJ8aHRtbHxpZnJhbWV8bGVnZW5kfGxpfGxpbmt8bWFpbnxtZW51fG1lbnVpdGVtfG1ldGF8bmF2fG5vZnJhbWVzfG9sfG9wdGdyb3VwfG9wdGlvbnxwfHBhcmFtfHNlY3Rpb258c291cmNlfHN1bW1hcnl8dGFibGV8dGJvZHl8dGR8dGZvb3R8dGh8dGhlYWR8dGl0bGV8dHJ8dHJhY2t8dWwiLCB2Ll9jb21tZW50ID0gLzwhLS0oPyEtPz4pW1xzXFNdKj8tLT4vLCB2Lmh0bWwgPSBjKHYuaHRtbCwgImkiKS5yZXBsYWNlKCJjb21tZW50Iiwgdi5fY29tbWVudCkucmVwbGFjZSgidGFnIiwgdi5fdGFnKS5yZXBsYWNlKCJhdHRyaWJ1dGUiLCAvICtbYS16QS1aOl9dW1x3LjotXSooPzogKj0gKiJbXiJcbl0qInwgKj0gKidbXidcbl0qJ3wgKj0gKlteXHMiJz08PmBdKyk/LykuZ2V0UmVnZXgoKSwgdi5wYXJhZ3JhcGggPSBjKHYucGFyYWdyYXBoKS5yZXBsYWNlKCJociIsIHYuaHIpLnJlcGxhY2UoImhlYWRpbmciLCB2LmhlYWRpbmcpLnJlcGxhY2UoImxoZWFkaW5nIiwgdi5saGVhZGluZykucmVwbGFjZSgidGFnIiwgdi5fdGFnKS5nZXRSZWdleCgpLCB2LmJsb2NrcXVvdGUgPSBjKHYuYmxvY2txdW90ZSkucmVwbGFjZSgicGFyYWdyYXBoIiwgdi5wYXJhZ3JhcGgpLmdldFJlZ2V4KCksIHYubm9ybWFsID0gcCh7fSwgdiksIHYuZ2ZtID0gcCh7fSwgdi5ub3JtYWwsIHsKICAgICAgICAgIGZlbmNlczogL14gKihgezMsfXx+ezMsfSlbIFwuXSooXFMrKT8gKlxuKFtcc1xTXSo/KVxuPyAqXDEgKig/OlxuK3wkKS8sCiAgICAgICAgICBwYXJhZ3JhcGg6IC9eLywKICAgICAgICAgIGhlYWRpbmc6IC9eICooI3sxLDZ9KSArKFteXG5dKz8pICojKiAqKD86XG4rfCQpLwogICAgICAgIH0pLCB2LmdmbS5wYXJhZ3JhcGggPSBjKHYucGFyYWdyYXBoKS5yZXBsYWNlKCIoPyEiLCAiKD8hIiArIHYuZ2ZtLmZlbmNlcy5zb3VyY2UucmVwbGFjZSgiXFwxIiwgIlxcMiIpICsgInwiICsgdi5saXN0LnNvdXJjZS5yZXBsYWNlKCJcXDEiLCAiXFwzIikgKyAifCIpLmdldFJlZ2V4KCksIHYudGFibGVzID0gcCh7fSwgdi5nZm0sIHsKICAgICAgICAgIG5wdGFibGU6IC9eICooW158XG4gXS4qXHwuKilcbiAqKFstOl0rICpcfFstfCA6XSopKD86XG4oKD86LipbXj5cbiBdLiooPzpcbnwkKSkqKVxuKnwkKS8sCiAgICAgICAgICB0YWJsZTogL14gKlx8KC4rKVxuICpcfD8oICpbLTpdK1stfCA6XSopKD86XG4oKD86ICpbXj5cbiBdLiooPzpcbnwkKSkqKVxuKnwkKS8KICAgICAgICB9KSwgdi5wZWRhbnRpYyA9IHAoe30sIHYubm9ybWFsLCB7CiAgICAgICAgICBodG1sOiBjKCJeICooPzpjb21tZW50ICooPzpcXG58XFxzKiQpfDwodGFnKVtcXHNcXFNdKz88L1xcMT4gKig/OlxcbnsyLH18XFxzKiQpfDx0YWcoPzpcIlteXCJdKlwifCdbXiddKid8XFxzW14nXCIvPlxcc10qKSo/Lz8+ICooPzpcXG57Mix9fFxccyokKSkiKS5yZXBsYWNlKCJjb21tZW50Iiwgdi5fY29tbWVudCkucmVwbGFjZSgvdGFnL2csICIoPyEoPzphfGVtfHN0cm9uZ3xzbWFsbHxzfGNpdGV8cXxkZm58YWJicnxkYXRhfHRpbWV8Y29kZXx2YXJ8c2FtcHxrYmR8c3VifHN1cHxpfGJ8dXxtYXJrfHJ1Ynl8cnR8cnB8YmRpfGJkb3xzcGFufGJyfHdicnxpbnN8ZGVsfGltZylcXGIpXFx3Kyg/ITp8W15cXHdcXHNAXSpAKVxcYiIpLmdldFJlZ2V4KCksCiAgICAgICAgICBkZWY6IC9eICpcWyhbXlxdXSspXF06ICo8PyhbXlxzPl0rKT4/KD86ICsoWyIoXVteXG5dK1siKV0pKT8gKig/OlxuK3wkKS8KICAgICAgICB9KSwgbi5ydWxlcyA9IHYsIG4ubGV4ID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIHJldHVybiBuZXcgbih0KS5sZXgoZSk7CiAgICAgICAgfSwgbi5wcm90b3R5cGUubGV4ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBlID0gZS5yZXBsYWNlKC9cclxufFxyL2csICJcbiIpLnJlcGxhY2UoL1x0L2csICIgICAgIikucmVwbGFjZSgvXHUwMGEwL2csICIgIikucmVwbGFjZSgvXHUyNDI0L2csICJcbiIpLCB0aGlzLnRva2VuKGUsICEwKTsKICAgICAgICB9LCBuLnByb3RvdHlwZS50b2tlbiA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgICBlID0gZS5yZXBsYWNlKC9eICskL2dtLCAiIik7CgogICAgICAgICAgZm9yICh2YXIgbiwgciwgbywgaSwgYSwgcywgbCwgYywgdSwgZCwgcCwgaCwgZzsgZTspIHsKICAgICAgICAgICAgaWYgKChvID0gdGhpcy5ydWxlcy5uZXdsaW5lLmV4ZWMoZSkpICYmIChlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCBvWzBdLmxlbmd0aCA+IDEgJiYgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogInNwYWNlIgogICAgICAgICAgICB9KSksIG8gPSB0aGlzLnJ1bGVzLmNvZGUuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgbyA9IG9bMF0ucmVwbGFjZSgvXiB7NH0vZ20sICIiKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogImNvZGUiLAogICAgICAgICAgICAgIHRleHQ6IHRoaXMub3B0aW9ucy5wZWRhbnRpYyA/IG8gOiBvLnJlcGxhY2UoL1xuKyQvLCAiIikKICAgICAgICAgICAgfSk7ZWxzZSBpZiAobyA9IHRoaXMucnVsZXMuZmVuY2VzLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgIHR5cGU6ICJjb2RlIiwKICAgICAgICAgICAgICBsYW5nOiBvWzJdLAogICAgICAgICAgICAgIHRleHQ6IG9bM10gfHwgIiIKICAgICAgICAgICAgfSk7ZWxzZSBpZiAobyA9IHRoaXMucnVsZXMuaGVhZGluZy5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAiaGVhZGluZyIsCiAgICAgICAgICAgICAgZGVwdGg6IG9bMV0ubGVuZ3RoLAogICAgICAgICAgICAgIHRleHQ6IG9bMl0KICAgICAgICAgICAgfSk7ZWxzZSBpZiAodCAmJiAobyA9IHRoaXMucnVsZXMubnB0YWJsZS5leGVjKGUpKSAmJiAocyA9IHsKICAgICAgICAgICAgICB0eXBlOiAidGFibGUiLAogICAgICAgICAgICAgIGhlYWRlcjogZihvWzFdLnJlcGxhY2UoL14gKnwgKlx8ICokL2csICIiKSksCiAgICAgICAgICAgICAgYWxpZ246IG9bMl0ucmVwbGFjZSgvXiAqfFx8ICokL2csICIiKS5zcGxpdCgvICpcfCAqLyksCiAgICAgICAgICAgICAgY2VsbHM6IG9bM10gPyBvWzNdLnJlcGxhY2UoL1xuJC8sICIiKS5zcGxpdCgiXG4iKSA6IFtdCiAgICAgICAgICAgIH0sIHMuaGVhZGVyLmxlbmd0aCA9PT0gcy5hbGlnbi5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgZm9yIChlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCBjID0gMDsgYyA8IHMuYWxpZ24ubGVuZ3RoOyBjKyspIHsKICAgICAgICAgICAgICAgIC9eICotKzogKiQvLnRlc3Qocy5hbGlnbltjXSkgPyBzLmFsaWduW2NdID0gInJpZ2h0IiA6IC9eICo6LSs6ICokLy50ZXN0KHMuYWxpZ25bY10pID8gcy5hbGlnbltjXSA9ICJjZW50ZXIiIDogL14gKjotKyAqJC8udGVzdChzLmFsaWduW2NdKSA/IHMuYWxpZ25bY10gPSAibGVmdCIgOiBzLmFsaWduW2NdID0gbnVsbDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvciAoYyA9IDA7IGMgPCBzLmNlbGxzLmxlbmd0aDsgYysrKSB7CiAgICAgICAgICAgICAgICBzLmNlbGxzW2NdID0gZihzLmNlbGxzW2NdLCBzLmhlYWRlci5sZW5ndGgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy50b2tlbnMucHVzaChzKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvID0gdGhpcy5ydWxlcy5oci5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiAiaHIiCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKG8gPSB0aGlzLnJ1bGVzLmJsb2NrcXVvdGUuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogImJsb2NrcXVvdGVfc3RhcnQiCiAgICAgICAgICAgIH0pLCBvID0gb1swXS5yZXBsYWNlKC9eICo+ID8vZ20sICIiKSwgdGhpcy50b2tlbihvLCB0KSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogImJsb2NrcXVvdGVfZW5kIgogICAgICAgICAgICB9KTtlbHNlIGlmIChvID0gdGhpcy5ydWxlcy5saXN0LmV4ZWMoZSkpIHsKICAgICAgICAgICAgICBmb3IgKGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIGkgPSBvWzJdLCBwID0gaS5sZW5ndGggPiAxLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICAgIHR5cGU6ICJsaXN0X3N0YXJ0IiwKICAgICAgICAgICAgICAgIG9yZGVyZWQ6IHAsCiAgICAgICAgICAgICAgICBzdGFydDogcCA/ICtpIDogIiIKICAgICAgICAgICAgICB9KSwgbyA9IG9bMF0ubWF0Y2godGhpcy5ydWxlcy5pdGVtKSwgbiA9ICExLCBkID0gby5sZW5ndGgsIGMgPSAwOyBjIDwgZDsgYysrKSB7CiAgICAgICAgICAgICAgICBzID0gb1tjXSwgbCA9IHMubGVuZ3RoLCBzID0gcy5yZXBsYWNlKC9eICooWyorLV18XGQrXC4pICsvLCAiIiksIH5zLmluZGV4T2YoIlxuICIpICYmIChsIC09IHMubGVuZ3RoLCBzID0gdGhpcy5vcHRpb25zLnBlZGFudGljID8gcy5yZXBsYWNlKC9eIHsxLDR9L2dtLCAiIikgOiBzLnJlcGxhY2UobmV3IFJlZ0V4cCgiXiB7MSwiICsgbCArICJ9IiwgImdtIiksICIiKSksIHRoaXMub3B0aW9ucy5zbWFydExpc3RzICYmIGMgIT09IGQgLSAxICYmIChhID0gdi5idWxsZXQuZXhlYyhvW2MgKyAxXSlbMF0sIGkgPT09IGEgfHwgaS5sZW5ndGggPiAxICYmIGEubGVuZ3RoID4gMSB8fCAoZSA9IG8uc2xpY2UoYyArIDEpLmpvaW4oIlxuIikgKyBlLCBjID0gZCAtIDEpKSwgciA9IG4gfHwgL1xuXG4oPyFccyokKS8udGVzdChzKSwgYyAhPT0gZCAtIDEgJiYgKG4gPSAiXG4iID09PSBzLmNoYXJBdChzLmxlbmd0aCAtIDEpLCByIHx8IChyID0gbikpLCBoID0gL15cW1sgeFhdXF0gLy50ZXN0KHMpLCBnID0gdm9pZCAwLCBoICYmIChnID0gIiAiICE9PSBzWzFdLCBzID0gcy5yZXBsYWNlKC9eXFtbIHhYXVxdICsvLCAiIikpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICAgICAgdHlwZTogciA/ICJsb29zZV9pdGVtX3N0YXJ0IiA6ICJsaXN0X2l0ZW1fc3RhcnQiLAogICAgICAgICAgICAgICAgICB0YXNrOiBoLAogICAgICAgICAgICAgICAgICBjaGVja2VkOiBnCiAgICAgICAgICAgICAgICB9KSwgdGhpcy50b2tlbihzLCAhMSksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgICAgICB0eXBlOiAibGlzdF9pdGVtX2VuZCIKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgICB0eXBlOiAibGlzdF9lbmQiCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobyA9IHRoaXMucnVsZXMuaHRtbC5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcob1swXS5sZW5ndGgpLCB0aGlzLnRva2Vucy5wdXNoKHsKICAgICAgICAgICAgICB0eXBlOiB0aGlzLm9wdGlvbnMuc2FuaXRpemUgPyAicGFyYWdyYXBoIiA6ICJodG1sIiwKICAgICAgICAgICAgICBwcmU6ICF0aGlzLm9wdGlvbnMuc2FuaXRpemVyICYmICgicHJlIiA9PT0gb1sxXSB8fCAic2NyaXB0IiA9PT0gb1sxXSB8fCAic3R5bGUiID09PSBvWzFdKSwKICAgICAgICAgICAgICB0ZXh0OiBvWzBdCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKHQgJiYgKG8gPSB0aGlzLnJ1bGVzLmRlZi5leGVjKGUpKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgb1szXSAmJiAob1szXSA9IG9bM10uc3Vic3RyaW5nKDEsIG9bM10ubGVuZ3RoIC0gMSkpLCB1ID0gb1sxXS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzKy9nLCAiICIpLCB0aGlzLnRva2Vucy5saW5rc1t1XSB8fCAodGhpcy50b2tlbnMubGlua3NbdV0gPSB7CiAgICAgICAgICAgICAgaHJlZjogb1syXSwKICAgICAgICAgICAgICB0aXRsZTogb1szXQogICAgICAgICAgICB9KTtlbHNlIGlmICh0ICYmIChvID0gdGhpcy5ydWxlcy50YWJsZS5leGVjKGUpKSAmJiAocyA9IHsKICAgICAgICAgICAgICB0eXBlOiAidGFibGUiLAogICAgICAgICAgICAgIGhlYWRlcjogZihvWzFdLnJlcGxhY2UoL14gKnwgKlx8ICokL2csICIiKSksCiAgICAgICAgICAgICAgYWxpZ246IG9bMl0ucmVwbGFjZSgvXiAqfFx8ICokL2csICIiKS5zcGxpdCgvICpcfCAqLyksCiAgICAgICAgICAgICAgY2VsbHM6IG9bM10gPyBvWzNdLnJlcGxhY2UoLyg/OiAqXHwgKik/XG4kLywgIiIpLnNwbGl0KCJcbiIpIDogW10KICAgICAgICAgICAgfSwgcy5oZWFkZXIubGVuZ3RoID09PSBzLmFsaWduLmxlbmd0aCkpIHsKICAgICAgICAgICAgICBmb3IgKGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIGMgPSAwOyBjIDwgcy5hbGlnbi5sZW5ndGg7IGMrKykgewogICAgICAgICAgICAgICAgL14gKi0rOiAqJC8udGVzdChzLmFsaWduW2NdKSA/IHMuYWxpZ25bY10gPSAicmlnaHQiIDogL14gKjotKzogKiQvLnRlc3Qocy5hbGlnbltjXSkgPyBzLmFsaWduW2NdID0gImNlbnRlciIgOiAvXiAqOi0rICokLy50ZXN0KHMuYWxpZ25bY10pID8gcy5hbGlnbltjXSA9ICJsZWZ0IiA6IHMuYWxpZ25bY10gPSBudWxsOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm9yIChjID0gMDsgYyA8IHMuY2VsbHMubGVuZ3RoOyBjKyspIHsKICAgICAgICAgICAgICAgIHMuY2VsbHNbY10gPSBmKHMuY2VsbHNbY10ucmVwbGFjZSgvXiAqXHwgKnwgKlx8ICokL2csICIiKSwgcy5oZWFkZXIubGVuZ3RoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRoaXMudG9rZW5zLnB1c2gocyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobyA9IHRoaXMucnVsZXMubGhlYWRpbmcuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogImhlYWRpbmciLAogICAgICAgICAgICAgIGRlcHRoOiAiPSIgPT09IG9bMl0gPyAxIDogMiwKICAgICAgICAgICAgICB0ZXh0OiBvWzFdCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKHQgJiYgKG8gPSB0aGlzLnJ1bGVzLnBhcmFncmFwaC5leGVjKGUpKSkgZSA9IGUuc3Vic3RyaW5nKG9bMF0ubGVuZ3RoKSwgdGhpcy50b2tlbnMucHVzaCh7CiAgICAgICAgICAgICAgdHlwZTogInBhcmFncmFwaCIsCiAgICAgICAgICAgICAgdGV4dDogIlxuIiA9PT0gb1sxXS5jaGFyQXQob1sxXS5sZW5ndGggLSAxKSA/IG9bMV0uc2xpY2UoMCwgLTEpIDogb1sxXQogICAgICAgICAgICB9KTtlbHNlIGlmIChvID0gdGhpcy5ydWxlcy50ZXh0LmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhvWzBdLmxlbmd0aCksIHRoaXMudG9rZW5zLnB1c2goewogICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgICB0ZXh0OiBvWzBdCiAgICAgICAgICAgIH0pO2Vsc2UgaWYgKGUpIHRocm93IG5ldyBFcnJvcigiSW5maW5pdGUgbG9vcCBvbiBieXRlOiAiICsgZS5jaGFyQ29kZUF0KDApKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdGhpcy50b2tlbnM7CiAgICAgICAgfTsKICAgICAgICB2YXIgZyA9IHsKICAgICAgICAgIGVzY2FwZTogL15cXChbISIjJCUmJygpKissXC0uLzo7PD0+P0BcW1xdXFxeX2B7fH1+XSkvLAogICAgICAgICAgYXV0b2xpbms6IC9ePChzY2hlbWU6W15cc1x4MDAtXHgxZjw+XSp8ZW1haWwpPi8sCiAgICAgICAgICB1cmw6IGQsCiAgICAgICAgICB0YWc6ICJeY29tbWVudHxePC9bYS16QS1aXVtcXHc6LV0qXFxzKj58XjxbYS16QS1aXVtcXHctXSooPzphdHRyaWJ1dGUpKj9cXHMqLz8+fF48XFw/W1xcc1xcU10qP1xcPz58XjwhW2EtekEtWl0rXFxzW1xcc1xcU10qPz58XjwhXFxbQ0RBVEFcXFtbXFxzXFxTXSo/XFxdXFxdPiIsCiAgICAgICAgICBsaW5rOiAvXiE/XFsobGFiZWwpXF1cKGhyZWYoPzpccysodGl0bGUpKT9ccypcKS8sCiAgICAgICAgICByZWZsaW5rOiAvXiE/XFsobGFiZWwpXF1cWyg/IVxzKlxdKSgoPzpcXFtcW1xdXT98W15cW1xdXFxdKSspXF0vLAogICAgICAgICAgbm9saW5rOiAvXiE/XFsoPyFccypcXSkoKD86XFtbXlxbXF1dKlxdfFxcW1xbXF1dfFteXFtcXV0pKilcXSg/OlxbXF0pPy8sCiAgICAgICAgICBzdHJvbmc6IC9eX18oW15cc11bXHNcU10qP1teXHNdKV9fKD8hXyl8XlwqXCooW15cc11bXHNcU10qP1teXHNdKVwqXCooPyFcKil8Xl9fKFteXHNdKV9fKD8hXyl8XlwqXCooW15cc10pXCpcKig/IVwqKS8sCiAgICAgICAgICBlbTogL15fKFteXHNdW1xzXFNdKj9bXlxzX10pXyg/IV8pfF5fKFteXHNfXVtcc1xTXSo/W15cc10pXyg/IV8pfF5cKihbXlxzXVtcc1xTXSo/W15ccypdKVwqKD8hXCopfF5cKihbXlxzKl1bXHNcU10qP1teXHNdKVwqKD8hXCopfF5fKFteXHNfXSlfKD8hXyl8XlwqKFteXHMqXSlcKig/IVwqKS8sCiAgICAgICAgICBjb2RlOiAvXihgKylccyooW1xzXFNdKj9bXmBdPylccypcMSg/IWApLywKICAgICAgICAgIGJyOiAvXiB7Mix9XG4oPyFccyokKS8sCiAgICAgICAgICBkZWw6IGQsCiAgICAgICAgICB0ZXh0OiAvXltcc1xTXSs/KD89W1xcPCFcW2AqXXxcYl98IHsyLH1cbnwkKS8KICAgICAgICB9OwogICAgICAgIGcuX2VzY2FwZXMgPSAvXFwoWyEiIyQlJicoKSorLFwtLi86Ozw9Pj9AXFtcXVxcXl9ge3x9fl0pL2csIGcuX3NjaGVtZSA9IC9bYS16QS1aXVthLXpBLVowLTkrLi1dezEsMzF9LywgZy5fZW1haWwgPSAvW2EtekEtWjAtOS4hIyQlJicqKy89P15fYHt8fX4tXSsoQClbYS16QS1aMC05XSg/OlthLXpBLVowLTktXXswLDYxfVthLXpBLVowLTldKT8oPzpcLlthLXpBLVowLTldKD86W2EtekEtWjAtOS1dezAsNjF9W2EtekEtWjAtOV0pPykrKD8hWy1fXSkvLCBnLmF1dG9saW5rID0gYyhnLmF1dG9saW5rKS5yZXBsYWNlKCJzY2hlbWUiLCBnLl9zY2hlbWUpLnJlcGxhY2UoImVtYWlsIiwgZy5fZW1haWwpLmdldFJlZ2V4KCksIGcuX2F0dHJpYnV0ZSA9IC9ccytbYS16QS1aOl9dW1x3LjotXSooPzpccyo9XHMqIlteIl0qInxccyo9XHMqJ1teJ10qJ3xccyo9XHMqW15ccyInPTw+YF0rKT8vLCBnLnRhZyA9IGMoZy50YWcpLnJlcGxhY2UoImNvbW1lbnQiLCB2Ll9jb21tZW50KS5yZXBsYWNlKCJhdHRyaWJ1dGUiLCBnLl9hdHRyaWJ1dGUpLmdldFJlZ2V4KCksIGcuX2xhYmVsID0gLyg/OlxbW15cW1xdXSpcXXxcXFtcW1xdXT98YFteYF0qYHxbXlxbXF1cXF0pKj8vLCBnLl9ocmVmID0gL1xzKig8KD86XFxbPD5dP3xbXlxzPD5cXF0pKj58KD86XFxbKCldP3xcKFteXHNceDAwLVx4MWYoKVxcXSpcKXxbXlxzXHgwMC1ceDFmKClcXF0pKj8pLywgZy5fdGl0bGUgPSAvIig/OlxcIj98W14iXFxdKSoifCcoPzpcXCc/fFteJ1xcXSkqJ3xcKCg/OlxcXCk/fFteKVxcXSkqXCkvLCBnLmxpbmsgPSBjKGcubGluaykucmVwbGFjZSgibGFiZWwiLCBnLl9sYWJlbCkucmVwbGFjZSgiaHJlZiIsIGcuX2hyZWYpLnJlcGxhY2UoInRpdGxlIiwgZy5fdGl0bGUpLmdldFJlZ2V4KCksIGcucmVmbGluayA9IGMoZy5yZWZsaW5rKS5yZXBsYWNlKCJsYWJlbCIsIGcuX2xhYmVsKS5nZXRSZWdleCgpLCBnLm5vcm1hbCA9IHAoe30sIGcpLCBnLnBlZGFudGljID0gcCh7fSwgZy5ub3JtYWwsIHsKICAgICAgICAgIHN0cm9uZzogL15fXyg/PVxTKShbXHNcU10qP1xTKV9fKD8hXyl8XlwqXCooPz1cUykoW1xzXFNdKj9cUylcKlwqKD8hXCopLywKICAgICAgICAgIGVtOiAvXl8oPz1cUykoW1xzXFNdKj9cUylfKD8hXyl8XlwqKD89XFMpKFtcc1xTXSo/XFMpXCooPyFcKikvLAogICAgICAgICAgbGluazogYygvXiE/XFsobGFiZWwpXF1cKCguKj8pXCkvKS5yZXBsYWNlKCJsYWJlbCIsIGcuX2xhYmVsKS5nZXRSZWdleCgpLAogICAgICAgICAgcmVmbGluazogYygvXiE/XFsobGFiZWwpXF1ccypcWyhbXlxdXSopXF0vKS5yZXBsYWNlKCJsYWJlbCIsIGcuX2xhYmVsKS5nZXRSZWdleCgpCiAgICAgICAgfSksIGcuZ2ZtID0gcCh7fSwgZy5ub3JtYWwsIHsKICAgICAgICAgIGVzY2FwZTogYyhnLmVzY2FwZSkucmVwbGFjZSgiXSkiLCAifnxdKSIpLmdldFJlZ2V4KCksCiAgICAgICAgICB1cmw6IGMoL14oKD86ZnRwfGh0dHBzPyk6XC9cL3x3d3dcLikoPzpbYS16QS1aMC05XC1dK1wuPykrW15cczxdKnxeZW1haWwvKS5yZXBsYWNlKCJlbWFpbCIsIGcuX2VtYWlsKS5nZXRSZWdleCgpLAogICAgICAgICAgX2JhY2twZWRhbDogLyg/OltePyEuLDo7Kl9+KCkmXSt8XChbXildKlwpfCYoPyFbYS16QS1aMC05XSs7JCl8Wz8hLiw6OypffildKyg/ISQpKSsvLAogICAgICAgICAgZGVsOiAvXn5+KD89XFMpKFtcc1xTXSo/XFMpfn4vLAogICAgICAgICAgdGV4dDogYyhnLnRleHQpLnJlcGxhY2UoIl18IiwgIn5dfCIpLnJlcGxhY2UoInwiLCAifGh0dHBzPzovL3xmdHA6Ly98d3d3XFwufFthLXpBLVowLTkuISMkJSYnKisvPT9eX2B7XFx8fX4tXStAfCIpLmdldFJlZ2V4KCkKICAgICAgICB9KSwgZy5icmVha3MgPSBwKHt9LCBnLmdmbSwgewogICAgICAgICAgYnI6IGMoZy5icikucmVwbGFjZSgiezIsfSIsICIqIikuZ2V0UmVnZXgoKSwKICAgICAgICAgIHRleHQ6IGMoZy5nZm0udGV4dCkucmVwbGFjZSgiezIsfSIsICIqIikuZ2V0UmVnZXgoKQogICAgICAgIH0pLCByLnJ1bGVzID0gZywgci5vdXRwdXQgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgcmV0dXJuIG5ldyByKHQsIG4pLm91dHB1dChlKTsKICAgICAgICB9LCByLnByb3RvdHlwZS5vdXRwdXQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgZm9yICh2YXIgdCwgbiwgbywgaSwgYSwgbCA9ICIiOyBlOykgewogICAgICAgICAgICBpZiAoYSA9IHRoaXMucnVsZXMuZXNjYXBlLmV4ZWMoZSkpIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksIGwgKz0gYVsxXTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5hdXRvbGluay5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCAiQCIgPT09IGFbMl0gPyAobiA9IHModGhpcy5tYW5nbGUoYVsxXSkpLCBvID0gIm1haWx0bzoiICsgbikgOiAobiA9IHMoYVsxXSksIG8gPSBuKSwgbCArPSB0aGlzLnJlbmRlcmVyLmxpbmsobywgbnVsbCwgbik7ZWxzZSBpZiAodGhpcy5pbkxpbmsgfHwgIShhID0gdGhpcy5ydWxlcy51cmwuZXhlYyhlKSkpIHsKICAgICAgICAgICAgICBpZiAoYSA9IHRoaXMucnVsZXMudGFnLmV4ZWMoZSkpICF0aGlzLmluTGluayAmJiAvXjxhIC9pLnRlc3QoYVswXSkgPyB0aGlzLmluTGluayA9ICEwIDogdGhpcy5pbkxpbmsgJiYgL148XC9hPi9pLnRlc3QoYVswXSkgJiYgKHRoaXMuaW5MaW5rID0gITEpLCBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMub3B0aW9ucy5zYW5pdGl6ZSA/IHRoaXMub3B0aW9ucy5zYW5pdGl6ZXIgPyB0aGlzLm9wdGlvbnMuc2FuaXRpemVyKGFbMF0pIDogcyhhWzBdKSA6IGFbMF07ZWxzZSBpZiAoYSA9IHRoaXMucnVsZXMubGluay5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCB0aGlzLmluTGluayA9ICEwLCBvID0gYVsyXSwgdGhpcy5vcHRpb25zLnBlZGFudGljID8gKHQgPSAvXihbXiciXSpbXlxzXSlccysoWyciXSkoLiopXDIvLmV4ZWMobyksIHQgPyAobyA9IHRbMV0sIGkgPSB0WzNdKSA6IGkgPSAiIikgOiBpID0gYVszXSA/IGFbM10uc2xpY2UoMSwgLTEpIDogIiIsIG8gPSBvLnRyaW0oKS5yZXBsYWNlKC9ePChbXHNcU10qKT4kLywgIiQxIiksIGwgKz0gdGhpcy5vdXRwdXRMaW5rKGEsIHsKICAgICAgICAgICAgICAgIGhyZWY6IHIuZXNjYXBlcyhvKSwKICAgICAgICAgICAgICAgIHRpdGxlOiByLmVzY2FwZXMoaSkKICAgICAgICAgICAgICB9KSwgdGhpcy5pbkxpbmsgPSAhMTtlbHNlIGlmICgoYSA9IHRoaXMucnVsZXMucmVmbGluay5leGVjKGUpKSB8fCAoYSA9IHRoaXMucnVsZXMubm9saW5rLmV4ZWMoZSkpKSB7CiAgICAgICAgICAgICAgICBpZiAoZSA9IGUuc3Vic3RyaW5nKGFbMF0ubGVuZ3RoKSwgdCA9IChhWzJdIHx8IGFbMV0pLnJlcGxhY2UoL1xzKy9nLCAiICIpLCAhKHQgPSB0aGlzLmxpbmtzW3QudG9Mb3dlckNhc2UoKV0pIHx8ICF0LmhyZWYpIHsKICAgICAgICAgICAgICAgICAgbCArPSBhWzBdLmNoYXJBdCgwKSwgZSA9IGFbMF0uc3Vic3RyaW5nKDEpICsgZTsKICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy5pbkxpbmsgPSAhMCwgbCArPSB0aGlzLm91dHB1dExpbmsoYSwgdCksIHRoaXMuaW5MaW5rID0gITE7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5zdHJvbmcuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKGFbMF0ubGVuZ3RoKSwgbCArPSB0aGlzLnJlbmRlcmVyLnN0cm9uZyh0aGlzLm91dHB1dChhWzRdIHx8IGFbM10gfHwgYVsyXSB8fCBhWzFdKSk7ZWxzZSBpZiAoYSA9IHRoaXMucnVsZXMuZW0uZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKGFbMF0ubGVuZ3RoKSwgbCArPSB0aGlzLnJlbmRlcmVyLmVtKHRoaXMub3V0cHV0KGFbNl0gfHwgYVs1XSB8fCBhWzRdIHx8IGFbM10gfHwgYVsyXSB8fCBhWzFdKSk7ZWxzZSBpZiAoYSA9IHRoaXMucnVsZXMuY29kZS5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMucmVuZGVyZXIuY29kZXNwYW4ocyhhWzJdLnRyaW0oKSwgITApKTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5ici5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMucmVuZGVyZXIuYnIoKTtlbHNlIGlmIChhID0gdGhpcy5ydWxlcy5kZWwuZXhlYyhlKSkgZSA9IGUuc3Vic3RyaW5nKGFbMF0ubGVuZ3RoKSwgbCArPSB0aGlzLnJlbmRlcmVyLmRlbCh0aGlzLm91dHB1dChhWzFdKSk7ZWxzZSBpZiAoYSA9IHRoaXMucnVsZXMudGV4dC5leGVjKGUpKSBlID0gZS5zdWJzdHJpbmcoYVswXS5sZW5ndGgpLCBsICs9IHRoaXMucmVuZGVyZXIudGV4dChzKHRoaXMuc21hcnR5cGFudHMoYVswXSkpKTtlbHNlIGlmIChlKSB0aHJvdyBuZXcgRXJyb3IoIkluZmluaXRlIGxvb3Agb24gYnl0ZTogIiArIGUuY2hhckNvZGVBdCgwKSk7CiAgICAgICAgICAgIH0gZWxzZSBhWzBdID0gdGhpcy5ydWxlcy5fYmFja3BlZGFsLmV4ZWMoYVswXSlbMF0sIGUgPSBlLnN1YnN0cmluZyhhWzBdLmxlbmd0aCksICJAIiA9PT0gYVsyXSA/IChuID0gcyhhWzBdKSwgbyA9ICJtYWlsdG86IiArIG4pIDogKG4gPSBzKGFbMF0pLCBvID0gInd3dy4iID09PSBhWzFdID8gImh0dHA6Ly8iICsgbiA6IG4pLCBsICs9IHRoaXMucmVuZGVyZXIubGluayhvLCBudWxsLCBuKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbDsKICAgICAgICB9LCByLmVzY2FwZXMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIGUgPyBlLnJlcGxhY2Uoci5ydWxlcy5fZXNjYXBlcywgIiQxIikgOiBlOwogICAgICAgIH0sIHIucHJvdG90eXBlLm91dHB1dExpbmsgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgdmFyIG4gPSB0LmhyZWYsCiAgICAgICAgICAgICAgciA9IHQudGl0bGUgPyBzKHQudGl0bGUpIDogbnVsbDsKICAgICAgICAgIHJldHVybiAiISIgIT09IGVbMF0uY2hhckF0KDApID8gdGhpcy5yZW5kZXJlci5saW5rKG4sIHIsIHRoaXMub3V0cHV0KGVbMV0pKSA6IHRoaXMucmVuZGVyZXIuaW1hZ2UobiwgciwgcyhlWzFdKSk7CiAgICAgICAgfSwgci5wcm90b3R5cGUuc21hcnR5cGFudHMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5zbWFydHlwYW50cyA/IGUucmVwbGFjZSgvLS0tL2csICLigJQiKS5yZXBsYWNlKC8tLS9nLCAi4oCTIikucmVwbGFjZSgvKF58Wy1cdTIwMTQvKFxbeyJcc10pJy9nLCAiJDHigJgiKS5yZXBsYWNlKC8nL2csICLigJkiKS5yZXBsYWNlKC8oXnxbLVx1MjAxNC8oXFt7XHUyMDE4XHNdKSIvZywgIiQx4oCcIikucmVwbGFjZSgvIi9nLCAi4oCdIikucmVwbGFjZSgvXC57M30vZywgIuKApiIpIDogZTsKICAgICAgICB9LCByLnByb3RvdHlwZS5tYW5nbGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMubWFuZ2xlKSByZXR1cm4gZTsKCiAgICAgICAgICBmb3IgKHZhciB0LCBuID0gIiIsIHIgPSBlLmxlbmd0aCwgbyA9IDA7IG8gPCByOyBvKyspIHsKICAgICAgICAgICAgdCA9IGUuY2hhckNvZGVBdChvKSwgTWF0aC5yYW5kb20oKSA+IC41ICYmICh0ID0gIngiICsgdC50b1N0cmluZygxNikpLCBuICs9ICImIyIgKyB0ICsgIjsiOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmNvZGUgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5oaWdobGlnaHQpIHsKICAgICAgICAgICAgdmFyIHIgPSB0aGlzLm9wdGlvbnMuaGlnaGxpZ2h0KGUsIHQpOwogICAgICAgICAgICBudWxsICE9IHIgJiYgciAhPT0gZSAmJiAobiA9ICEwLCBlID0gcik7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHQgPyAnPHByZT48Y29kZSBjbGFzcz0iJyArIHRoaXMub3B0aW9ucy5sYW5nUHJlZml4ICsgcyh0LCAhMCkgKyAnIj4nICsgKG4gPyBlIDogcyhlLCAhMCkpICsgIjwvY29kZT48L3ByZT5cbiIgOiAiPHByZT48Y29kZT4iICsgKG4gPyBlIDogcyhlLCAhMCkpICsgIjwvY29kZT48L3ByZT4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmJsb2NrcXVvdGUgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICI8YmxvY2txdW90ZT5cbiIgKyBlICsgIjwvYmxvY2txdW90ZT5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuaHRtbCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9LCBvLnByb3RvdHlwZS5oZWFkaW5nID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaGVhZGVySWRzID8gIjxoIiArIHQgKyAnIGlkPSInICsgdGhpcy5vcHRpb25zLmhlYWRlclByZWZpeCArIG4udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXlx3XSsvZywgIi0iKSArICciPicgKyBlICsgIjwvaCIgKyB0ICsgIj5cbiIgOiAiPGgiICsgdCArICI+IiArIGUgKyAiPC9oIiArIHQgKyAiPlxuIjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5ociA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMueGh0bWwgPyAiPGhyLz5cbiIgOiAiPGhyPlxuIjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5saXN0ID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgICAgIHZhciByID0gdCA/ICJvbCIgOiAidWwiOwogICAgICAgICAgcmV0dXJuICI8IiArIHIgKyAodCAmJiAxICE9PSBuID8gJyBzdGFydD0iJyArIG4gKyAnIicgOiAiIikgKyAiPlxuIiArIGUgKyAiPC8iICsgciArICI+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmxpc3RpdGVtID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiAiPGxpPiIgKyBlICsgIjwvbGk+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmNoZWNrYm94ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiAiPGlucHV0ICIgKyAoZSA/ICdjaGVja2VkPSIiICcgOiAiIikgKyAnZGlzYWJsZWQ9IiIgdHlwZT0iY2hlY2tib3giJyArICh0aGlzLm9wdGlvbnMueGh0bWwgPyAiIC8iIDogIiIpICsgIj4gIjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5wYXJhZ3JhcGggPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICI8cD4iICsgZSArICI8L3A+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLnRhYmxlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIHJldHVybiB0ICYmICh0ID0gIjx0Ym9keT4iICsgdCArICI8L3Rib2R5PiIpLCAiPHRhYmxlPlxuPHRoZWFkPlxuIiArIGUgKyAiPC90aGVhZD5cbiIgKyB0ICsgIjwvdGFibGU+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLnRhYmxlcm93ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiAiPHRyPlxuIiArIGUgKyAiPC90cj5cbiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUudGFibGVjZWxsID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIHZhciBuID0gdC5oZWFkZXIgPyAidGgiIDogInRkIjsKICAgICAgICAgIHJldHVybiAodC5hbGlnbiA/ICI8IiArIG4gKyAnIGFsaWduPSInICsgdC5hbGlnbiArICciPicgOiAiPCIgKyBuICsgIj4iKSArIGUgKyAiPC8iICsgbiArICI+XG4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLnN0cm9uZyA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIjxzdHJvbmc+IiArIGUgKyAiPC9zdHJvbmc+IjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5lbSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIjxlbT4iICsgZSArICI8L2VtPiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUuY29kZXNwYW4gPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICI8Y29kZT4iICsgZSArICI8L2NvZGU+IjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5iciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMueGh0bWwgPyAiPGJyLz4iIDogIjxicj4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmRlbCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gIjxkZWw+IiArIGUgKyAiPC9kZWw+IjsKICAgICAgICB9LCBvLnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgICAgIGlmICh0aGlzLm9wdGlvbnMuc2FuaXRpemUpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICB2YXIgciA9IGRlY29kZVVSSUNvbXBvbmVudChsKGUpKS5yZXBsYWNlKC9bXlx3Ol0vZywgIiIpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICByZXR1cm4gbjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKDAgPT09IHIuaW5kZXhPZigiamF2YXNjcmlwdDoiKSB8fCAwID09PSByLmluZGV4T2YoInZic2NyaXB0OiIpIHx8IDAgPT09IHIuaW5kZXhPZigiZGF0YToiKSkgcmV0dXJuIG47CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5vcHRpb25zLmJhc2VVcmwgJiYgIXkudGVzdChlKSAmJiAoZSA9IHUodGhpcy5vcHRpb25zLmJhc2VVcmwsIGUpKTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBlID0gZW5jb2RlVVJJKGUpLnJlcGxhY2UoLyUyNS9nLCAiJSIpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZXR1cm4gbjsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgbyA9ICc8YSBocmVmPSInICsgcyhlKSArICciJzsKICAgICAgICAgIHJldHVybiB0ICYmIChvICs9ICcgdGl0bGU9IicgKyB0ICsgJyInKSwgbyArPSAiPiIgKyBuICsgIjwvYT4iOwogICAgICAgIH0sIG8ucHJvdG90eXBlLmltYWdlID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgICAgIHRoaXMub3B0aW9ucy5iYXNlVXJsICYmICF5LnRlc3QoZSkgJiYgKGUgPSB1KHRoaXMub3B0aW9ucy5iYXNlVXJsLCBlKSk7CiAgICAgICAgICB2YXIgciA9ICc8aW1nIHNyYz0iJyArIGUgKyAnIiBhbHQ9IicgKyBuICsgJyInOwogICAgICAgICAgcmV0dXJuIHQgJiYgKHIgKz0gJyB0aXRsZT0iJyArIHQgKyAnIicpLCByICs9IHRoaXMub3B0aW9ucy54aHRtbCA/ICIvPiIgOiAiPiI7CiAgICAgICAgfSwgby5wcm90b3R5cGUudGV4dCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9LCBpLnByb3RvdHlwZS5zdHJvbmcgPSBpLnByb3RvdHlwZS5lbSA9IGkucHJvdG90eXBlLmNvZGVzcGFuID0gaS5wcm90b3R5cGUuZGVsID0gaS5wcm90b3R5cGUudGV4dCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9LCBpLnByb3RvdHlwZS5saW5rID0gaS5wcm90b3R5cGUuaW1hZ2UgPSBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgICAgICAgcmV0dXJuICIiICsgbjsKICAgICAgICB9LCBpLnByb3RvdHlwZS5iciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICB9LCBhLnBhcnNlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgIHJldHVybiBuZXcgYSh0KS5wYXJzZShlKTsKICAgICAgICB9LCBhLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICB0aGlzLmlubGluZSA9IG5ldyByKGUubGlua3MsIHRoaXMub3B0aW9ucyksIHRoaXMuaW5saW5lVGV4dCA9IG5ldyByKGUubGlua3MsIHAoe30sIHRoaXMub3B0aW9ucywgewogICAgICAgICAgICByZW5kZXJlcjogbmV3IGkoKQogICAgICAgICAgfSkpLCB0aGlzLnRva2VucyA9IGUucmV2ZXJzZSgpOwoKICAgICAgICAgIGZvciAodmFyIHQgPSAiIjsgdGhpcy5uZXh0KCk7KSB7CiAgICAgICAgICAgIHQgKz0gdGhpcy50b2soKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gdDsKICAgICAgICB9LCBhLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMudG9rZW4gPSB0aGlzLnRva2Vucy5wb3AoKTsKICAgICAgICB9LCBhLnByb3RvdHlwZS5wZWVrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMudG9rZW5zW3RoaXMudG9rZW5zLmxlbmd0aCAtIDFdIHx8IDA7CiAgICAgICAgfSwgYS5wcm90b3R5cGUucGFyc2VUZXh0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgZm9yICh2YXIgZSA9IHRoaXMudG9rZW4udGV4dDsgInRleHQiID09PSB0aGlzLnBlZWsoKS50eXBlOykgewogICAgICAgICAgICBlICs9ICJcbiIgKyB0aGlzLm5leHQoKS50ZXh0OwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0aGlzLmlubGluZS5vdXRwdXQoZSk7CiAgICAgICAgfSwgYS5wcm90b3R5cGUudG9rID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgc3dpdGNoICh0aGlzLnRva2VuLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAic3BhY2UiOgogICAgICAgICAgICAgIHJldHVybiAiIjsKCiAgICAgICAgICAgIGNhc2UgImhyIjoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5ocigpOwoKICAgICAgICAgICAgY2FzZSAiaGVhZGluZyI6CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIuaGVhZGluZyh0aGlzLmlubGluZS5vdXRwdXQodGhpcy50b2tlbi50ZXh0KSwgdGhpcy50b2tlbi5kZXB0aCwgbCh0aGlzLmlubGluZVRleHQub3V0cHV0KHRoaXMudG9rZW4udGV4dCkpKTsKCiAgICAgICAgICAgIGNhc2UgImNvZGUiOgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLmNvZGUodGhpcy50b2tlbi50ZXh0LCB0aGlzLnRva2VuLmxhbmcsIHRoaXMudG9rZW4uZXNjYXBlZCk7CgogICAgICAgICAgICBjYXNlICJ0YWJsZSI6CiAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICAgIHQsCiAgICAgICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgICAgIG8gPSAiIiwKICAgICAgICAgICAgICAgICAgaSA9ICIiOwoKICAgICAgICAgICAgICBmb3IgKG4gPSAiIiwgZSA9IDA7IGUgPCB0aGlzLnRva2VuLmhlYWRlci5sZW5ndGg7IGUrKykgewogICAgICAgICAgICAgICAgbiArPSB0aGlzLnJlbmRlcmVyLnRhYmxlY2VsbCh0aGlzLmlubGluZS5vdXRwdXQodGhpcy50b2tlbi5oZWFkZXJbZV0pLCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcjogITAsCiAgICAgICAgICAgICAgICAgIGFsaWduOiB0aGlzLnRva2VuLmFsaWduW2VdCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvciAobyArPSB0aGlzLnJlbmRlcmVyLnRhYmxlcm93KG4pLCBlID0gMDsgZSA8IHRoaXMudG9rZW4uY2VsbHMubGVuZ3RoOyBlKyspIHsKICAgICAgICAgICAgICAgIGZvciAodCA9IHRoaXMudG9rZW4uY2VsbHNbZV0sIG4gPSAiIiwgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7CiAgICAgICAgICAgICAgICAgIG4gKz0gdGhpcy5yZW5kZXJlci50YWJsZWNlbGwodGhpcy5pbmxpbmUub3V0cHV0KHRbcl0pLCB7CiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiAhMSwKICAgICAgICAgICAgICAgICAgICBhbGlnbjogdGhpcy50b2tlbi5hbGlnbltyXQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpICs9IHRoaXMucmVuZGVyZXIudGFibGVyb3cobik7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci50YWJsZShvLCBpKTsKCiAgICAgICAgICAgIGNhc2UgImJsb2NrcXVvdGVfc3RhcnQiOgogICAgICAgICAgICAgIGZvciAoaSA9ICIiOyAiYmxvY2txdW90ZV9lbmQiICE9PSB0aGlzLm5leHQoKS50eXBlOykgewogICAgICAgICAgICAgICAgaSArPSB0aGlzLnRvaygpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIuYmxvY2txdW90ZShpKTsKCiAgICAgICAgICAgIGNhc2UgImxpc3Rfc3RhcnQiOgogICAgICAgICAgICAgIGkgPSAiIjsKCiAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IHRoaXMudG9rZW4ub3JkZXJlZCwgcyA9IHRoaXMudG9rZW4uc3RhcnQ7ICJsaXN0X2VuZCIgIT09IHRoaXMubmV4dCgpLnR5cGU7KSB7CiAgICAgICAgICAgICAgICBpICs9IHRoaXMudG9rKCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5saXN0KGksIGEsIHMpOwoKICAgICAgICAgICAgY2FzZSAibGlzdF9pdGVtX3N0YXJ0IjoKICAgICAgICAgICAgICBmb3IgKGkgPSAiIiwgdGhpcy50b2tlbi50YXNrICYmIChpICs9IHRoaXMucmVuZGVyZXIuY2hlY2tib3godGhpcy50b2tlbi5jaGVja2VkKSk7ICJsaXN0X2l0ZW1fZW5kIiAhPT0gdGhpcy5uZXh0KCkudHlwZTspIHsKICAgICAgICAgICAgICAgIGkgKz0gInRleHQiID09PSB0aGlzLnRva2VuLnR5cGUgPyB0aGlzLnBhcnNlVGV4dCgpIDogdGhpcy50b2soKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLmxpc3RpdGVtKGkpOwoKICAgICAgICAgICAgY2FzZSAibG9vc2VfaXRlbV9zdGFydCI6CiAgICAgICAgICAgICAgZm9yIChpID0gIiI7ICJsaXN0X2l0ZW1fZW5kIiAhPT0gdGhpcy5uZXh0KCkudHlwZTspIHsKICAgICAgICAgICAgICAgIGkgKz0gdGhpcy50b2soKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcmVyLmxpc3RpdGVtKGkpOwoKICAgICAgICAgICAgY2FzZSAiaHRtbCI6CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIuaHRtbCh0aGlzLnRva2VuLnRleHQpOwoKICAgICAgICAgICAgY2FzZSAicGFyYWdyYXBoIjoKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlci5wYXJhZ3JhcGgodGhpcy5pbmxpbmUub3V0cHV0KHRoaXMudG9rZW4udGV4dCkpOwoKICAgICAgICAgICAgY2FzZSAidGV4dCI6CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyZXIucGFyYWdyYXBoKHRoaXMucGFyc2VUZXh0KCkpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgdmFyIG0gPSB7fSwKICAgICAgICAgICAgeSA9IC9eJHxeW2Etel1bYS16MC05Ky4tXSo6fF5bPyNdL2k7CiAgICAgICAgZC5leGVjID0gZCwgaC5vcHRpb25zID0gaC5zZXRPcHRpb25zID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJldHVybiBwKGguZGVmYXVsdHMsIGUpLCBoOwogICAgICAgIH0sIGguZ2V0RGVmYXVsdHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBiYXNlVXJsOiBudWxsLAogICAgICAgICAgICBicmVha3M6ICExLAogICAgICAgICAgICBnZm06ICEwLAogICAgICAgICAgICBoZWFkZXJJZHM6ICEwLAogICAgICAgICAgICBoZWFkZXJQcmVmaXg6ICIiLAogICAgICAgICAgICBoaWdobGlnaHQ6IG51bGwsCiAgICAgICAgICAgIGxhbmdQcmVmaXg6ICJsYW5ndWFnZS0iLAogICAgICAgICAgICBtYW5nbGU6ICEwLAogICAgICAgICAgICBwZWRhbnRpYzogITEsCiAgICAgICAgICAgIHJlbmRlcmVyOiBuZXcgbygpLAogICAgICAgICAgICBzYW5pdGl6ZTogITEsCiAgICAgICAgICAgIHNhbml0aXplcjogbnVsbCwKICAgICAgICAgICAgc2lsZW50OiAhMSwKICAgICAgICAgICAgc21hcnRMaXN0czogITEsCiAgICAgICAgICAgIHNtYXJ0eXBhbnRzOiAhMSwKICAgICAgICAgICAgdGFibGVzOiAhMCwKICAgICAgICAgICAgeGh0bWw6ICExCiAgICAgICAgICB9OwogICAgICAgIH0sIGguZGVmYXVsdHMgPSBoLmdldERlZmF1bHRzKCksIGguUGFyc2VyID0gYSwgaC5wYXJzZXIgPSBhLnBhcnNlLCBoLlJlbmRlcmVyID0gbywgaC5UZXh0UmVuZGVyZXIgPSBpLCBoLkxleGVyID0gbiwgaC5sZXhlciA9IG4ubGV4LCBoLklubGluZUxleGVyID0gciwgaC5pbmxpbmVMZXhlciA9IHIub3V0cHV0LCBoLnBhcnNlID0gaCwgZS5leHBvcnRzID0gaDsKICAgICAgfSh0aGlzIHx8ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93KTsKICAgIH0pLmNhbGwodCwgbigxNCkpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIHZhciB0ID0ge307CiAgICAgIHJldHVybiB1KGUsIGZ1bmN0aW9uIChlLCBuKSB7CiAgICAgICAgdShlLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgdFtlXSA9IG47CiAgICAgICAgfSk7CiAgICAgIH0pLCB0OwogICAgfQoKICAgIGZ1bmN0aW9uIG8oZSwgdCkgewogICAgICB2YXIgbiA9IHIoZS5wbHVyYWxUeXBlVG9MYW5ndWFnZXMpOwogICAgICByZXR1cm4gblt0XSB8fCBuW2cuY2FsbCh0LCAvLS8sIDEpWzBdXSB8fCBuLmVuOwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSwgdCwgbikgewogICAgICByZXR1cm4gZS5wbHVyYWxUeXBlc1tvKGUsIHQpXShuKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhKGUpIHsKICAgICAgcmV0dXJuIGUucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xdXFxdL2csICJcXCQmIik7CiAgICB9CgogICAgZnVuY3Rpb24gcyhlKSB7CiAgICAgIHZhciB0ID0gZSAmJiBlLnByZWZpeCB8fCAiJXsiLAogICAgICAgICAgbiA9IGUgJiYgZS5zdWZmaXggfHwgIn0iOwogICAgICBpZiAodCA9PT0gbSB8fCBuID09PSBtKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcignIicgKyBtICsgJyIgdG9rZW4gaXMgcmVzZXJ2ZWQgZm9yIHBsdXJhbGl6YXRpb24nKTsKICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYSh0KSArICIoLio/KSIgKyBhKG4pLCAiZyIpOwogICAgfQoKICAgIGZ1bmN0aW9uIGwoZSwgdCwgbiwgciwgbykgewogICAgICBpZiAoInN0cmluZyIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoIlBvbHlnbG90LnRyYW5zZm9ybVBocmFzZSBleHBlY3RzIGFyZ3VtZW50ICMxIHRvIGJlIHN0cmluZyIpOwogICAgICBpZiAobnVsbCA9PSB0KSByZXR1cm4gZTsKICAgICAgdmFyIGEgPSBlLAogICAgICAgICAgcyA9IHIgfHwgdywKICAgICAgICAgIGwgPSBvIHx8IGIsCiAgICAgICAgICBjID0gIm51bWJlciIgPT0gdHlwZW9mIHQgPyB7CiAgICAgICAgc21hcnRfY291bnQ6IHQKICAgICAgfSA6IHQ7CgogICAgICBpZiAobnVsbCAhPSBjLnNtYXJ0X2NvdW50ICYmIGEpIHsKICAgICAgICB2YXIgdSA9IGcuY2FsbChhLCBtKTsKICAgICAgICBhID0gZih1W2kobCwgbiB8fCAiZW4iLCBjLnNtYXJ0X2NvdW50KV0gfHwgdVswXSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhID0gdi5jYWxsKGEsIHMsIGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICAgcmV0dXJuIHAoYywgdCkgJiYgbnVsbCAhPSBjW3RdID8gY1t0XSA6IGU7CiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGMoZSkgewogICAgICB2YXIgdCA9IGUgfHwge307CiAgICAgIHRoaXMucGhyYXNlcyA9IHt9LCB0aGlzLmV4dGVuZCh0LnBocmFzZXMgfHwge30pLCB0aGlzLmN1cnJlbnRMb2NhbGUgPSB0LmxvY2FsZSB8fCAiZW4iOwogICAgICB2YXIgbiA9IHQuYWxsb3dNaXNzaW5nID8gbCA6IG51bGw7CiAgICAgIHRoaXMub25NaXNzaW5nS2V5ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdC5vbk1pc3NpbmdLZXkgPyB0Lm9uTWlzc2luZ0tleSA6IG4sIHRoaXMud2FybiA9IHQud2FybiB8fCBoLCB0aGlzLnRva2VuUmVnZXggPSBzKHQuaW50ZXJwb2xhdGlvbiksIHRoaXMucGx1cmFsUnVsZXMgPSB0LnBsdXJhbFJ1bGVzIHx8IGI7CiAgICB9CgogICAgdmFyIHUgPSBuKDMxKSwKICAgICAgICBkID0gbig1MCksCiAgICAgICAgcCA9IG4oMzQpLAogICAgICAgIGYgPSBuKDQzKSwKICAgICAgICBoID0gZnVuY3Rpb24gaChlKSB7CiAgICAgIGQoITEsIGUpOwogICAgfSwKICAgICAgICB2ID0gU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlLAogICAgICAgIGcgPSBTdHJpbmcucHJvdG90eXBlLnNwbGl0LAogICAgICAgIG0gPSAifHx8fCIsCiAgICAgICAgeSA9IGZ1bmN0aW9uIHkoZSkgewogICAgICB2YXIgdCA9IGUgJSAxMDAsCiAgICAgICAgICBuID0gdCAlIDEwOwogICAgICByZXR1cm4gMTEgIT09IHQgJiYgMSA9PT0gbiA/IDAgOiAyIDw9IG4gJiYgbiA8PSA0ICYmICEodCA+PSAxMiAmJiB0IDw9IDE0KSA/IDEgOiAyOwogICAgfSwKICAgICAgICBiID0gewogICAgICBwbHVyYWxUeXBlczogewogICAgICAgIGFyYWJpYzogZnVuY3Rpb24gYXJhYmljKGUpIHsKICAgICAgICAgIGlmIChlIDwgMykgcmV0dXJuIGU7CiAgICAgICAgICB2YXIgdCA9IGUgJSAxMDA7CiAgICAgICAgICByZXR1cm4gdCA+PSAzICYmIHQgPD0gMTAgPyAzIDogdCA+PSAxMSA/IDQgOiA1OwogICAgICAgIH0sCiAgICAgICAgYm9zbmlhbl9zZXJiaWFuOiB5LAogICAgICAgIGNoaW5lc2U6IGZ1bmN0aW9uIGNoaW5lc2UoKSB7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9LAogICAgICAgIGNyb2F0aWFuOiB5LAogICAgICAgIGZyZW5jaDogZnVuY3Rpb24gZnJlbmNoKGUpIHsKICAgICAgICAgIHJldHVybiBlID4gMSA/IDEgOiAwOwogICAgICAgIH0sCiAgICAgICAgZ2VybWFuOiBmdW5jdGlvbiBnZXJtYW4oZSkgewogICAgICAgICAgcmV0dXJuIDEgIT09IGUgPyAxIDogMDsKICAgICAgICB9LAogICAgICAgIHJ1c3NpYW46IHksCiAgICAgICAgbGl0aHVhbmlhbjogZnVuY3Rpb24gbGl0aHVhbmlhbihlKSB7CiAgICAgICAgICByZXR1cm4gZSAlIDEwID09IDEgJiYgZSAlIDEwMCAhPSAxMSA/IDAgOiBlICUgMTAgPj0gMiAmJiBlICUgMTAgPD0gOSAmJiAoZSAlIDEwMCA8IDExIHx8IGUgJSAxMDAgPiAxOSkgPyAxIDogMjsKICAgICAgICB9LAogICAgICAgIGN6ZWNoOiBmdW5jdGlvbiBjemVjaChlKSB7CiAgICAgICAgICByZXR1cm4gMSA9PT0gZSA/IDAgOiBlID49IDIgJiYgZSA8PSA0ID8gMSA6IDI7CiAgICAgICAgfSwKICAgICAgICBwb2xpc2g6IGZ1bmN0aW9uIHBvbGlzaChlKSB7CiAgICAgICAgICBpZiAoMSA9PT0gZSkgcmV0dXJuIDA7CiAgICAgICAgICB2YXIgdCA9IGUgJSAxMDsKICAgICAgICAgIHJldHVybiAyIDw9IHQgJiYgdCA8PSA0ICYmIChlICUgMTAwIDwgMTAgfHwgZSAlIDEwMCA+PSAyMCkgPyAxIDogMjsKICAgICAgICB9LAogICAgICAgIGljZWxhbmRpYzogZnVuY3Rpb24gaWNlbGFuZGljKGUpIHsKICAgICAgICAgIHJldHVybiBlICUgMTAgIT0gMSB8fCBlICUgMTAwID09IDExID8gMSA6IDA7CiAgICAgICAgfSwKICAgICAgICBzbG92ZW5pYW46IGZ1bmN0aW9uIHNsb3ZlbmlhbihlKSB7CiAgICAgICAgICB2YXIgdCA9IGUgJSAxMDA7CiAgICAgICAgICByZXR1cm4gMSA9PT0gdCA/IDAgOiAyID09PSB0ID8gMSA6IDMgPT09IHQgfHwgNCA9PT0gdCA/IDIgOiAzOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGx1cmFsVHlwZVRvTGFuZ3VhZ2VzOiB7CiAgICAgICAgYXJhYmljOiBbImFyIl0sCiAgICAgICAgYm9zbmlhbl9zZXJiaWFuOiBbImJzLUxhdG4tQkEiLCAiYnMtQ3lybC1CQSIsICJzcmwtUlMiLCAic3ItUlMiXSwKICAgICAgICBjaGluZXNlOiBbImlkIiwgImlkLUlEIiwgImphIiwgImtvIiwgImtvLUtSIiwgImxvIiwgIm1zIiwgInRoIiwgInRoLVRIIiwgInpoIl0sCiAgICAgICAgY3JvYXRpYW46IFsiaHIiLCAiaHItSFIiXSwKICAgICAgICBnZXJtYW46IFsiZmEiLCAiZGEiLCAiZGUiLCAiZW4iLCAiZXMiLCAiZmkiLCAiZWwiLCAiaGUiLCAiaGktSU4iLCAiaHUiLCAiaHUtSFUiLCAiaXQiLCAibmwiLCAibm8iLCAicHQiLCAic3YiLCAidHIiXSwKICAgICAgICBmcmVuY2g6IFsiZnIiLCAidGwiLCAicHQtYnIiXSwKICAgICAgICBydXNzaWFuOiBbInJ1IiwgInJ1LVJVIl0sCiAgICAgICAgbGl0aHVhbmlhbjogWyJsdCJdLAogICAgICAgIGN6ZWNoOiBbImNzIiwgImNzLUNaIiwgInNrIl0sCiAgICAgICAgcG9saXNoOiBbInBsIl0sCiAgICAgICAgaWNlbGFuZGljOiBbImlzIl0sCiAgICAgICAgc2xvdmVuaWFuOiBbInNsLVNMIl0KICAgICAgfQogICAgfSwKICAgICAgICB3ID0gLyVceyguKj8pXH0vZzsKCiAgICBjLnByb3RvdHlwZS5sb2NhbGUgPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gZSAmJiAodGhpcy5jdXJyZW50TG9jYWxlID0gZSksIHRoaXMuY3VycmVudExvY2FsZTsKICAgIH0sIGMucHJvdG90eXBlLmV4dGVuZCA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHUoZSwgZnVuY3Rpb24gKGUsIG4pIHsKICAgICAgICB2YXIgciA9IHQgPyB0ICsgIi4iICsgbiA6IG47CiAgICAgICAgIm9iamVjdCIgPT0gX3R5cGVvZihlKSA/IHRoaXMuZXh0ZW5kKGUsIHIpIDogdGhpcy5waHJhc2VzW3JdID0gZTsKICAgICAgfSwgdGhpcyk7CiAgICB9LCBjLnByb3RvdHlwZS51bnNldCA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgICJzdHJpbmciID09IHR5cGVvZiBlID8gZGVsZXRlIHRoaXMucGhyYXNlc1tlXSA6IHUoZSwgZnVuY3Rpb24gKGUsIG4pIHsKICAgICAgICB2YXIgciA9IHQgPyB0ICsgIi4iICsgbiA6IG47CiAgICAgICAgIm9iamVjdCIgPT0gX3R5cGVvZihlKSA/IHRoaXMudW5zZXQoZSwgcikgOiBkZWxldGUgdGhpcy5waHJhc2VzW3JdOwogICAgICB9LCB0aGlzKTsKICAgIH0sIGMucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnBocmFzZXMgPSB7fTsKICAgIH0sIGMucHJvdG90eXBlLnJlcGxhY2UgPSBmdW5jdGlvbiAoZSkgewogICAgICB0aGlzLmNsZWFyKCksIHRoaXMuZXh0ZW5kKGUpOwogICAgfSwgYy5wcm90b3R5cGUudCA9IGZ1bmN0aW9uIChlLCB0KSB7CiAgICAgIHZhciBuLAogICAgICAgICAgciwKICAgICAgICAgIG8gPSBudWxsID09IHQgPyB7fSA6IHQ7CiAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgdGhpcy5waHJhc2VzW2VdKSBuID0gdGhpcy5waHJhc2VzW2VdO2Vsc2UgaWYgKCJzdHJpbmciID09IHR5cGVvZiBvLl8pIG4gPSBvLl87ZWxzZSBpZiAodGhpcy5vbk1pc3NpbmdLZXkpIHsKICAgICAgICB2YXIgaSA9IHRoaXMub25NaXNzaW5nS2V5OwogICAgICAgIHIgPSBpKGUsIG8sIHRoaXMuY3VycmVudExvY2FsZSwgdGhpcy50b2tlblJlZ2V4LCB0aGlzLnBsdXJhbFJ1bGVzKTsKICAgICAgfSBlbHNlIHRoaXMud2FybignTWlzc2luZyB0cmFuc2xhdGlvbiBmb3Iga2V5OiAiJyArIGUgKyAnIicpLCByID0gZTsKICAgICAgcmV0dXJuICJzdHJpbmciID09IHR5cGVvZiBuICYmIChyID0gbChuLCBvLCB0aGlzLmN1cnJlbnRMb2NhbGUsIHRoaXMudG9rZW5SZWdleCwgdGhpcy5wbHVyYWxSdWxlcykpLCByOwogICAgfSwgYy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgcmV0dXJuIHAodGhpcy5waHJhc2VzLCBlKTsKICAgIH0sIGMudHJhbnNmb3JtUGhyYXNlID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICAgcmV0dXJuIGwoZSwgdCwgbik7CiAgICB9LCBlLmV4cG9ydHMgPSBjOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIGlmIChudWxsID09PSBlIHx8IHZvaWQgMCA9PT0gZSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LmFzc2lnbiBjYW5ub3QgYmUgY2FsbGVkIHdpdGggbnVsbCBvciB1bmRlZmluZWQiKTsKICAgICAgcmV0dXJuIE9iamVjdChlKTsKICAgIH0KICAgIC8qCiAgICBvYmplY3QtYXNzaWduCiAgICAoYykgU2luZHJlIFNvcmh1cwogICAgQGxpY2Vuc2UgTUlUCiAgICAqLwoKCiAgICB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMsCiAgICAgICAgaSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksCiAgICAgICAgYSA9IE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGU7CiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKCFPYmplY3QuYXNzaWduKSByZXR1cm4gITE7CiAgICAgICAgdmFyIGUgPSBuZXcgU3RyaW5nKCJhYmMiKTsKICAgICAgICBpZiAoZVs1XSA9ICJkZSIsICI1IiA9PT0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZSlbMF0pIHJldHVybiAhMTsKCiAgICAgICAgZm9yICh2YXIgdCA9IHt9LCBuID0gMDsgbiA8IDEwOyBuKyspIHsKICAgICAgICAgIHRbIl8iICsgU3RyaW5nLmZyb21DaGFyQ29kZShuKV0gPSBuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCIwMTIzNDU2Nzg5IiAhPT0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModCkubWFwKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gdFtlXTsKICAgICAgICB9KS5qb2luKCIiKSkgcmV0dXJuICExOwogICAgICAgIHZhciByID0ge307CiAgICAgICAgcmV0dXJuICJhYmNkZWZnaGlqa2xtbm9wcXJzdCIuc3BsaXQoIiIpLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHJbZV0gPSBlOwogICAgICAgIH0pLCAiYWJjZGVmZ2hpamtsbW5vcHFyc3QiID09PSBPYmplY3Qua2V5cyhPYmplY3QuYXNzaWduKHt9LCByKSkuam9pbigiIik7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZXR1cm4gITE7CiAgICAgIH0KICAgIH0oKSA/IE9iamVjdC5hc3NpZ24gOiBmdW5jdGlvbiAoZSwgdCkgewogICAgICBmb3IgKHZhciBuLCBzLCBsID0gcihlKSwgYyA9IDE7IGMgPCBhcmd1bWVudHMubGVuZ3RoOyBjKyspIHsKICAgICAgICBuID0gT2JqZWN0KGFyZ3VtZW50c1tjXSk7CgogICAgICAgIGZvciAodmFyIHUgaW4gbikgewogICAgICAgICAgaS5jYWxsKG4sIHUpICYmIChsW3VdID0gblt1XSk7CiAgICAgICAgfQoKICAgICAgICBpZiAobykgewogICAgICAgICAgcyA9IG8obik7CgogICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBzLmxlbmd0aDsgZCsrKSB7CiAgICAgICAgICAgIGEuY2FsbChuLCBzW2RdKSAmJiAobFtzW2RdXSA9IG5bc1tkXV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGw7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHI7CgogICAgaWYgKCFPYmplY3Qua2V5cykgewogICAgICB2YXIgbyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksCiAgICAgICAgICBpID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZywKICAgICAgICAgIGEgPSBuKDEwKSwKICAgICAgICAgIHMgPSBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLAogICAgICAgICAgbCA9ICFzLmNhbGwoewogICAgICAgIHRvU3RyaW5nOiBudWxsCiAgICAgIH0sICJ0b1N0cmluZyIpLAogICAgICAgICAgYyA9IHMuY2FsbChmdW5jdGlvbiAoKSB7fSwgInByb3RvdHlwZSIpLAogICAgICAgICAgdSA9IFsidG9TdHJpbmciLCAidG9Mb2NhbGVTdHJpbmciLCAidmFsdWVPZiIsICJoYXNPd25Qcm9wZXJ0eSIsICJpc1Byb3RvdHlwZU9mIiwgInByb3BlcnR5SXNFbnVtZXJhYmxlIiwgImNvbnN0cnVjdG9yIl0sCiAgICAgICAgICBkID0gZnVuY3Rpb24gZChlKSB7CiAgICAgICAgdmFyIHQgPSBlLmNvbnN0cnVjdG9yOwogICAgICAgIHJldHVybiB0ICYmIHQucHJvdG90eXBlID09PSBlOwogICAgICB9LAogICAgICAgICAgcCA9IHsKICAgICAgICAkYXBwbGljYXRpb25DYWNoZTogITAsCiAgICAgICAgJGNvbnNvbGU6ICEwLAogICAgICAgICRleHRlcm5hbDogITAsCiAgICAgICAgJGZyYW1lOiAhMCwKICAgICAgICAkZnJhbWVFbGVtZW50OiAhMCwKICAgICAgICAkZnJhbWVzOiAhMCwKICAgICAgICAkaW5uZXJIZWlnaHQ6ICEwLAogICAgICAgICRpbm5lcldpZHRoOiAhMCwKICAgICAgICAkb3V0ZXJIZWlnaHQ6ICEwLAogICAgICAgICRvdXRlcldpZHRoOiAhMCwKICAgICAgICAkcGFnZVhPZmZzZXQ6ICEwLAogICAgICAgICRwYWdlWU9mZnNldDogITAsCiAgICAgICAgJHBhcmVudDogITAsCiAgICAgICAgJHNjcm9sbExlZnQ6ICEwLAogICAgICAgICRzY3JvbGxUb3A6ICEwLAogICAgICAgICRzY3JvbGxYOiAhMCwKICAgICAgICAkc2Nyb2xsWTogITAsCiAgICAgICAgJHNlbGY6ICEwLAogICAgICAgICR3ZWJraXRJbmRleGVkREI6ICEwLAogICAgICAgICR3ZWJraXRTdG9yYWdlSW5mbzogITAsCiAgICAgICAgJHdpbmRvdzogITAKICAgICAgfSwKICAgICAgICAgIGYgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCJ1bmRlZmluZWQiID09IHR5cGVvZiB3aW5kb3cpIHJldHVybiAhMTsKCiAgICAgICAgZm9yICh2YXIgZSBpbiB3aW5kb3cpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICghcFsiJCIgKyBlXSAmJiBvLmNhbGwod2luZG93LCBlKSAmJiBudWxsICE9PSB3aW5kb3dbZV0gJiYgIm9iamVjdCIgPT0gX3R5cGVvZih3aW5kb3dbZV0pKSB0cnkgewogICAgICAgICAgICAgIGQod2luZG93W2VdKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZXR1cm4gITA7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gITE7CiAgICAgIH0oKSwKICAgICAgICAgIGggPSBmdW5jdGlvbiBoKGUpIHsKICAgICAgICBpZiAoInVuZGVmaW5lZCIgPT0gdHlwZW9mIHdpbmRvdyB8fCAhZikgcmV0dXJuIGQoZSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gZChlKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICByZXR1cm4gITE7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgciA9IGZ1bmN0aW9uIHIoZSkgewogICAgICAgIHZhciB0ID0gbnVsbCAhPT0gZSAmJiAib2JqZWN0IiA9PSBfdHlwZW9mKGUpLAogICAgICAgICAgICBuID0gIltvYmplY3QgRnVuY3Rpb25dIiA9PT0gaS5jYWxsKGUpLAogICAgICAgICAgICByID0gYShlKSwKICAgICAgICAgICAgcyA9IHQgJiYgIltvYmplY3QgU3RyaW5nXSIgPT09IGkuY2FsbChlKSwKICAgICAgICAgICAgZCA9IFtdOwoKICAgICAgICBpZiAoIXQgJiYgIW4gJiYgIXIpIHRocm93IG5ldyBUeXBlRXJyb3IoIk9iamVjdC5rZXlzIGNhbGxlZCBvbiBhIG5vbi1vYmplY3QiKTsKICAgICAgICB2YXIgcCA9IGMgJiYgbjsKICAgICAgICBpZiAocyAmJiBlLmxlbmd0aCA+IDAgJiYgIW8uY2FsbChlLCAwKSkgZm9yICh2YXIgZiA9IDA7IGYgPCBlLmxlbmd0aDsgKytmKSB7CiAgICAgICAgICBkLnB1c2goU3RyaW5nKGYpKTsKICAgICAgICB9CiAgICAgICAgaWYgKHIgJiYgZS5sZW5ndGggPiAwKSBmb3IgKHZhciB2ID0gMDsgdiA8IGUubGVuZ3RoOyArK3YpIHsKICAgICAgICAgIGQucHVzaChTdHJpbmcodikpOwogICAgICAgIH0gZWxzZSBmb3IgKHZhciBnIGluIGUpIHsKICAgICAgICAgIHAgJiYgInByb3RvdHlwZSIgPT09IGcgfHwgIW8uY2FsbChlLCBnKSB8fCBkLnB1c2goU3RyaW5nKGcpKTsKICAgICAgICB9CiAgICAgICAgaWYgKGwpIGZvciAodmFyIG0gPSBoKGUpLCB5ID0gMDsgeSA8IHUubGVuZ3RoOyArK3kpIHsKICAgICAgICAgIG0gJiYgImNvbnN0cnVjdG9yIiA9PT0gdVt5XSB8fCAhby5jYWxsKGUsIHVbeV0pIHx8IGQucHVzaCh1W3ldKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGQ7CiAgICAgIH07CiAgICB9CgogICAgZS5leHBvcnRzID0gcjsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIHZhciByID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLAogICAgICAgIG8gPSBuKDEwKSwKICAgICAgICBpID0gT2JqZWN0LmtleXMsCiAgICAgICAgYSA9IGkgPyBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gaShlKTsKICAgIH0gOiBuKDM5KSwKICAgICAgICBzID0gT2JqZWN0LmtleXM7CiAgICBhLnNoaW0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChPYmplY3Qua2V5cykgewogICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZSA9IE9iamVjdC5rZXlzKGFyZ3VtZW50cyk7CiAgICAgICAgICByZXR1cm4gZSAmJiBlLmxlbmd0aCA9PT0gYXJndW1lbnRzLmxlbmd0aDsKICAgICAgICB9KSgxLCAyKSB8fCAoT2JqZWN0LmtleXMgPSBmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuIHMobyhlKSA/IHIuY2FsbChlKSA6IGUpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgT2JqZWN0LmtleXMgPSBhOwoKICAgICAgcmV0dXJuIE9iamVjdC5rZXlzIHx8IGE7CiAgICB9LCBlLmV4cG9ydHMgPSBhOwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBmdW5jdGlvbiBuKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoInNldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQiKTsKICAgIH0KCiAgICBmdW5jdGlvbiByKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoImNsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCIpOwogICAgfQoKICAgIGZ1bmN0aW9uIG8oZSkgewogICAgICBpZiAodSA9PT0gc2V0VGltZW91dCkgcmV0dXJuIHNldFRpbWVvdXQoZSwgMCk7CiAgICAgIGlmICgodSA9PT0gbiB8fCAhdSkgJiYgc2V0VGltZW91dCkgcmV0dXJuIHUgPSBzZXRUaW1lb3V0LCBzZXRUaW1lb3V0KGUsIDApOwoKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gdShlLCAwKTsKICAgICAgfSBjYXRjaCAodCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gdS5jYWxsKG51bGwsIGUsIDApOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiB1LmNhbGwodGhpcywgZSwgMCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaShlKSB7CiAgICAgIGlmIChkID09PSBjbGVhclRpbWVvdXQpIHJldHVybiBjbGVhclRpbWVvdXQoZSk7CiAgICAgIGlmICgoZCA9PT0gciB8fCAhZCkgJiYgY2xlYXJUaW1lb3V0KSByZXR1cm4gZCA9IGNsZWFyVGltZW91dCwgY2xlYXJUaW1lb3V0KGUpOwoKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gZChlKTsKICAgICAgfSBjYXRjaCAodCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gZC5jYWxsKG51bGwsIGUpOwogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgIHJldHVybiBkLmNhbGwodGhpcywgZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gYSgpIHsKICAgICAgdiAmJiBmICYmICh2ID0gITEsIGYubGVuZ3RoID8gaCA9IGYuY29uY2F0KGgpIDogZyA9IC0xLCBoLmxlbmd0aCAmJiBzKCkpOwogICAgfQoKICAgIGZ1bmN0aW9uIHMoKSB7CiAgICAgIGlmICghdikgewogICAgICAgIHZhciBlID0gbyhhKTsKICAgICAgICB2ID0gITA7CgogICAgICAgIGZvciAodmFyIHQgPSBoLmxlbmd0aDsgdDspIHsKICAgICAgICAgIGZvciAoZiA9IGgsIGggPSBbXTsgKytnIDwgdDspIHsKICAgICAgICAgICAgZiAmJiBmW2ddLnJ1bigpOwogICAgICAgICAgfQoKICAgICAgICAgIGcgPSAtMSwgdCA9IGgubGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgZiA9IG51bGwsIHYgPSAhMSwgaShlKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGwoZSwgdCkgewogICAgICB0aGlzLmZ1biA9IGUsIHRoaXMuYXJyYXkgPSB0OwogICAgfQoKICAgIGZ1bmN0aW9uIGMoKSB7fQoKICAgIHZhciB1LAogICAgICAgIGQsCiAgICAgICAgcCA9IGUuZXhwb3J0cyA9IHt9OwogICAgIWZ1bmN0aW9uICgpIHsKICAgICAgdHJ5IHsKICAgICAgICB1ID0gImZ1bmN0aW9uIiA9PSB0eXBlb2Ygc2V0VGltZW91dCA/IHNldFRpbWVvdXQgOiBuOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdSA9IG47CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgZCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIGNsZWFyVGltZW91dCA/IGNsZWFyVGltZW91dCA6IHI7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBkID0gcjsKICAgICAgfQogICAgfSgpOwogICAgdmFyIGYsCiAgICAgICAgaCA9IFtdLAogICAgICAgIHYgPSAhMSwKICAgICAgICBnID0gLTE7CiAgICBwLm5leHRUaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpOwogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIGZvciAodmFyIG4gPSAxOyBuIDwgYXJndW1lbnRzLmxlbmd0aDsgbisrKSB7CiAgICAgICAgdFtuIC0gMV0gPSBhcmd1bWVudHNbbl07CiAgICAgIH0KICAgICAgaC5wdXNoKG5ldyBsKGUsIHQpKSwgMSAhPT0gaC5sZW5ndGggfHwgdiB8fCBvKHMpOwogICAgfSwgbC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTsKICAgIH0sIHAudGl0bGUgPSAiYnJvd3NlciIsIHAuYnJvd3NlciA9ICEwLCBwLmVudiA9IHt9LCBwLmFyZ3YgPSBbXSwgcC52ZXJzaW9uID0gIiIsIHAudmVyc2lvbnMgPSB7fSwgcC5vbiA9IGMsIHAuYWRkTGlzdGVuZXIgPSBjLCBwLm9uY2UgPSBjLCBwLm9mZiA9IGMsIHAucmVtb3ZlTGlzdGVuZXIgPSBjLCBwLnJlbW92ZUFsbExpc3RlbmVycyA9IGMsIHAuZW1pdCA9IGMsIHAucHJlcGVuZExpc3RlbmVyID0gYywgcC5wcmVwZW5kT25jZUxpc3RlbmVyID0gYywgcC5saXN0ZW5lcnMgPSBmdW5jdGlvbiAoZSkgewogICAgICByZXR1cm4gW107CiAgICB9LCBwLmJpbmRpbmcgPSBmdW5jdGlvbiAoZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoInByb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkIik7CiAgICB9LCBwLmN3ZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICIvIjsKICAgIH0sIHAuY2hkaXIgPSBmdW5jdGlvbiAoZSkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoInByb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCIpOwogICAgfSwgcC51bWFzayA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIDA7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgZnVuY3Rpb24gcihlKSB7CiAgICAgIHJldHVybiBlID0gSlNPTi5zdHJpbmdpZnkoZSksICEhL15ce1tcc1xTXSpcfSQvLnRlc3QoZSk7CiAgICB9CgogICAgZnVuY3Rpb24gbyhlKSB7CiAgICAgIHJldHVybiB2b2lkIDAgPT09IGUgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSA/IGUgKyAiIiA6IEpTT04uc3RyaW5naWZ5KGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSkgewogICAgICBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGUpIHRyeSB7CiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZSk7CiAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICByZXR1cm4gZTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGEoZSkgewogICAgICByZXR1cm4gIltvYmplY3QgRnVuY3Rpb25dIiA9PT0ge30udG9TdHJpbmcuY2FsbChlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzKGUpIHsKICAgICAgcmV0dXJuICJbb2JqZWN0IEFycmF5XSIgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBsKCkgewogICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgbCkpIHJldHVybiBuZXcgbCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICB2YXIgbiA9IGFyZ3VtZW50cywKICAgICAgICAgIG8gPSBudWxsOwogICAgICBpZiAoZCB8fCAoZCA9IGwoKSksIDAgPT09IG4ubGVuZ3RoKSByZXR1cm4gZC5nZXQoKTsKCiAgICAgIGlmICgxID09PSBuLmxlbmd0aCkgewogICAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgZSkgcmV0dXJuIGQuZ2V0KGUpOwogICAgICAgIGlmIChyKGUpKSByZXR1cm4gZC5zZXQoZSk7CiAgICAgIH0KCiAgICAgIGlmICgyID09PSBuLmxlbmd0aCAmJiAic3RyaW5nIiA9PSB0eXBlb2YgZSkgewogICAgICAgIGlmICghdCkgcmV0dXJuIGQucmVtb3ZlKGUpOwogICAgICAgIGlmICh0ICYmICJzdHJpbmciID09IHR5cGVvZiB0KSByZXR1cm4gZC5zZXQoZSwgdCk7CiAgICAgICAgdCAmJiBhKHQpICYmIChvID0gbnVsbCwgbyA9IHQoZSwgZC5nZXQoZSkpLCBjLnNldChlLCBvKSk7CiAgICAgIH0KCiAgICAgIGlmICgyID09PSBuLmxlbmd0aCAmJiBzKGUpICYmIGEodCkpIGZvciAodmFyIGkgPSAwLCB1ID0gZS5sZW5ndGg7IGkgPCB1OyBpKyspIHsKICAgICAgICBvID0gdChlW2ldLCBkLmdldChlW2ldKSksIGMuc2V0KGVbaV0sIG8pOwogICAgICB9CiAgICAgIHJldHVybiBjOwogICAgfQoKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCAiX19lc01vZHVsZSIsIHsKICAgICAgdmFsdWU6ICEwCiAgICB9KTsKICAgIC8qIQogICAgKiBzdG9yZWpzIHYxLjAuMjQKICAgICogTG9jYWwgc3RvcmFnZSBsb2NhbHN0b3JhZ2UgcGFja2FnZSBwcm92aWRlcyBhIHNpbXBsZSBBUEkKICAgICogCiAgICAqIENvcHlyaWdodCAoYykgMjAxOCBrZW5ueSB3YW5nIDx3b3dvaG9vQHFxLmNvbT4KICAgICogaHR0cHM6Ly9naXRodWIuY29tL2pheXdjamxvdmUvc3RvcmUuanMKICAgICogCiAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4KICAgICovCgogICAgdmFyIHUgPSB3aW5kb3cubG9jYWxTdG9yYWdlOwogICAgdSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0ID0gIl9Jc19JbmNvZ25pdCI7CgogICAgICB0cnkgewogICAgICAgIGUuc2V0SXRlbSh0LCAieWVzIik7CiAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICBpZiAoIlF1b3RhRXhjZWVkZWRFcnJvciIgPT09IHQubmFtZSkgewogICAgICAgICAgdmFyIG4gPSBmdW5jdGlvbiBuKCkge307CgogICAgICAgICAgZS5fX3Byb3RvX18gPSB7CiAgICAgICAgICAgIHNldEl0ZW06IG4sCiAgICAgICAgICAgIGdldEl0ZW06IG4sCiAgICAgICAgICAgIHJlbW92ZUl0ZW06IG4sCiAgICAgICAgICAgIGNsZWFyOiBuCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAieWVzIiA9PT0gZS5nZXRJdGVtKHQpICYmIGUucmVtb3ZlSXRlbSh0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIGU7CiAgICB9KHUpLCBsLnByb3RvdHlwZSA9IHsKICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZSwgdCkgewogICAgICAgIGlmIChlICYmICFyKGUpKSB1LnNldEl0ZW0oZSwgbyh0KSk7ZWxzZSBpZiAocihlKSkgZm9yICh2YXIgbiBpbiBlKSB7CiAgICAgICAgICB0aGlzLnNldChuLCBlW25dKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KGUpIHsKICAgICAgICBpZiAoIWUpIHsKICAgICAgICAgIHZhciB0ID0ge307CiAgICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKGZ1bmN0aW9uIChlLCBuKSB7CiAgICAgICAgICAgIHJldHVybiB0W2VdID0gbjsKICAgICAgICAgIH0pLCB0OwogICAgICAgIH0KCiAgICAgICAgaWYgKCI/IiA9PT0gZS5jaGFyQXQoMCkpIHJldHVybiB0aGlzLmhhcyhlLnN1YnN0cigxKSk7CiAgICAgICAgdmFyIG4gPSBhcmd1bWVudHM7CgogICAgICAgIGlmIChuLmxlbmd0aCA+IDEpIHsKICAgICAgICAgIGZvciAodmFyIHIgPSB7fSwgbyA9IDAsIGEgPSBuLmxlbmd0aDsgbyA8IGE7IG8rKykgewogICAgICAgICAgICB2YXIgcyA9IGkodS5nZXRJdGVtKG5bb10pKTsKICAgICAgICAgICAgcyAmJiAocltuW29dXSA9IHMpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiByOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGkodS5nZXRJdGVtKGUpKTsKICAgICAgfSwKICAgICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkgewogICAgICAgIHJldHVybiB1LmNsZWFyKCksIHRoaXM7CiAgICAgIH0sCiAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKGUpIHsKICAgICAgICB2YXIgdCA9IHRoaXMuZ2V0KGUpOwogICAgICAgIHJldHVybiB1LnJlbW92ZUl0ZW0oZSksIHQ7CiAgICAgIH0sCiAgICAgIGhhczogZnVuY3Rpb24gaGFzKGUpIHsKICAgICAgICByZXR1cm4ge30uaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmdldCgpLCBlKTsKICAgICAgfSwKICAgICAga2V5czogZnVuY3Rpb24ga2V5cygpIHsKICAgICAgICB2YXIgZSA9IFtdOwogICAgICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24gKHQpIHsKICAgICAgICAgIGUucHVzaCh0KTsKICAgICAgICB9KSwgZTsKICAgICAgfSwKICAgICAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChlKSB7CiAgICAgICAgZm9yICh2YXIgdCA9IDAsIG4gPSB1Lmxlbmd0aDsgdCA8IG47IHQrKykgewogICAgICAgICAgdmFyIHIgPSB1LmtleSh0KTsKICAgICAgICAgIGUociwgdGhpcy5nZXQocikpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCiAgICAgIHNlYXJjaDogZnVuY3Rpb24gc2VhcmNoKGUpIHsKICAgICAgICBmb3IgKHZhciB0ID0gdGhpcy5rZXlzKCksIG4gPSB7fSwgciA9IDAsIG8gPSB0Lmxlbmd0aDsgciA8IG87IHIrKykgewogICAgICAgICAgdFtyXS5pbmRleE9mKGUpID4gLTEgJiYgKG5bdFtyXV0gPSB0aGlzLmdldCh0W3JdKSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbjsKICAgICAgfQogICAgfTsKICAgIHZhciBkID0gbnVsbDsKCiAgICBmb3IgKHZhciBwIGluIGwucHJvdG90eXBlKSB7CiAgICAgIGNbcF0gPSBsLnByb3RvdHlwZVtwXTsKICAgIH0KCiAgICB0WyJkZWZhdWx0Il0gPSBjOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDEyKSwKICAgICAgICBvID0gbig5KSwKICAgICAgICBpID0gbigxMSksCiAgICAgICAgYSA9IG4oMTMpLAogICAgICAgIHMgPSBuKDQ5KSwKICAgICAgICBsID0gcihhKCkpOwogICAgbyhsLCB7CiAgICAgIGdldFBvbHlmaWxsOiBhLAogICAgICBpbXBsZW1lbnRhdGlvbjogaSwKICAgICAgc2hpbTogcwogICAgfSksIGUuZXhwb3J0cyA9IGw7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oMSksCiAgICAgICAgbyA9IHIoIiVTdHJpbmclIiksCiAgICAgICAgaSA9IHIoIiVUeXBlRXJyb3IlIik7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKCJzeW1ib2wiID09IF90eXBlb2YoZSkpIHRocm93IG5ldyBpKCJDYW5ub3QgY29udmVydCBhIFN5bWJvbCB2YWx1ZSB0byBhIHN0cmluZyIpOwogICAgICByZXR1cm4gbyhlKTsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oMSksCiAgICAgICAgbyA9IHIoIiVUeXBlRXJyb3IlIik7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgaWYgKG51bGwgPT0gZSkgdGhyb3cgbmV3IG8odCB8fCAiQ2Fubm90IGNhbGwgbWV0aG9kIG9uICIgKyBlKTsKICAgICAgcmV0dXJuIGU7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICAidXNlIHN0cmljdCI7CgogICAgdmFyIHIgPSBuKDEpLAogICAgICAgIG8gPSBuKDEyKSwKICAgICAgICBpID0gbyhyKCJTdHJpbmcucHJvdG90eXBlLmluZGV4T2YiKSk7CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgdmFyIG4gPSByKGUsICEhdCk7CiAgICAgIHJldHVybiAiZnVuY3Rpb24iID09IHR5cGVvZiBuICYmIGkoZSwgIi5wcm90b3R5cGUuIikgPyBvKG4pIDogbjsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICAoZnVuY3Rpb24gKHQpIHsKICAgICAgdmFyIHIgPSB0LlN5bWJvbCwKICAgICAgICAgIG8gPSBuKDQ4KTsKCiAgICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2YgciAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihyKCJmb28iKSkgJiYgInN5bWJvbCIgPT0gX3R5cGVvZihTeW1ib2woImJhciIpKSAmJiBvKCk7CiAgICAgIH07CiAgICB9KS5jYWxsKHQsIG4oMTQpKTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIFN5bWJvbCB8fCAiZnVuY3Rpb24iICE9IHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSByZXR1cm4gITE7CiAgICAgIGlmICgic3ltYm9sIiA9PSBfdHlwZW9mKFN5bWJvbC5pdGVyYXRvcikpIHJldHVybiAhMDsKICAgICAgdmFyIGUgPSB7fSwKICAgICAgICAgIHQgPSBTeW1ib2woInRlc3QiKSwKICAgICAgICAgIG4gPSBPYmplY3QodCk7CiAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgdCkgcmV0dXJuICExOwogICAgICBpZiAoIltvYmplY3QgU3ltYm9sXSIgIT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KSkgcmV0dXJuICExOwogICAgICBpZiAoIltvYmplY3QgU3ltYm9sXSIgIT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChuKSkgcmV0dXJuICExOwogICAgICBlW3RdID0gNDI7CgogICAgICBmb3IgKHQgaW4gZSkgewogICAgICAgIHJldHVybiAhMTsKICAgICAgfQoKICAgICAgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIE9iamVjdC5rZXlzICYmIDAgIT09IE9iamVjdC5rZXlzKGUpLmxlbmd0aCkgcmV0dXJuICExOwogICAgICBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgJiYgMCAhPT0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZSkubGVuZ3RoKSByZXR1cm4gITE7CiAgICAgIHZhciByID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsKICAgICAgaWYgKDEgIT09IHIubGVuZ3RoIHx8IHJbMF0gIT09IHQpIHJldHVybiAhMTsKICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSwgdCkpIHJldHVybiAhMTsKCiAgICAgIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKSB7CiAgICAgICAgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHQpOwogICAgICAgIGlmICg0MiAhPT0gby52YWx1ZSB8fCAhMCAhPT0gby5lbnVtZXJhYmxlKSByZXR1cm4gITE7CiAgICAgIH0KCiAgICAgIHJldHVybiAhMDsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgICJ1c2Ugc3RyaWN0IjsKCiAgICB2YXIgciA9IG4oOSksCiAgICAgICAgbyA9IG4oMTMpOwoKICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGUgPSBvKCk7CiAgICAgIHJldHVybiByKFN0cmluZy5wcm90b3R5cGUsIHsKICAgICAgICB0cmltOiBlCiAgICAgIH0sIHsKICAgICAgICB0cmltOiBmdW5jdGlvbiB0cmltKCkgewogICAgICAgICAgcmV0dXJuIFN0cmluZy5wcm90b3R5cGUudHJpbSAhPT0gZTsKICAgICAgICB9CiAgICAgIH0pLCBlOwogICAgfTsKICB9LCBmdW5jdGlvbiAoZSwgdCwgbikgewogICAgInVzZSBzdHJpY3QiOwoKICAgIChmdW5jdGlvbiAodCkgewogICAgICB2YXIgbiA9ICJwcm9kdWN0aW9uIiAhPT0gdC5lbnYuTk9ERV9FTlYsCiAgICAgICAgICByID0gZnVuY3Rpb24gcigpIHt9OwoKICAgICAgaWYgKG4pIHsKICAgICAgICB2YXIgbyA9IGZ1bmN0aW9uIG8oZSwgdCkgewogICAgICAgICAgdmFyIG4gPSBhcmd1bWVudHMubGVuZ3RoOwogICAgICAgICAgdCA9IG5ldyBBcnJheShuID4gMSA/IG4gLSAxIDogMCk7CgogICAgICAgICAgZm9yICh2YXIgciA9IDE7IHIgPCBuOyByKyspIHsKICAgICAgICAgICAgdFtyIC0gMV0gPSBhcmd1bWVudHNbcl07CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIG8gPSAwLAogICAgICAgICAgICAgIGkgPSAiV2FybmluZzogIiArIGUucmVwbGFjZSgvJXMvZywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdFtvKytdOwogICAgICAgICAgfSk7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGkpOwogICAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgICB9OwoKICAgICAgICByID0gZnVuY3Rpb24gcihlLCB0LCBuKSB7CiAgICAgICAgICB2YXIgciA9IGFyZ3VtZW50cy5sZW5ndGg7CiAgICAgICAgICBuID0gbmV3IEFycmF5KHIgPiAyID8gciAtIDIgOiAwKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMjsgaSA8IHI7IGkrKykgewogICAgICAgICAgICBuW2kgLSAyXSA9IGFyZ3VtZW50c1tpXTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodm9pZCAwID09PSB0KSB0aHJvdyBuZXcgRXJyb3IoImB3YXJuaW5nKGNvbmRpdGlvbiwgZm9ybWF0LCAuLi5hcmdzKWAgcmVxdWlyZXMgYSB3YXJuaW5nIG1lc3NhZ2UgYXJndW1lbnQiKTsKICAgICAgICAgIGUgfHwgby5hcHBseShudWxsLCBbdF0uY29uY2F0KG4pKTsKICAgICAgICB9OwogICAgICB9CgogICAgICBlLmV4cG9ydHMgPSByOwogICAgfSkuY2FsbCh0LCBuKDQxKSk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSwgdCkgewogICAgICByZXR1cm4gbmV3IGEodCkucHJvY2VzcyhlKTsKICAgIH0KCiAgICB2YXIgbyA9IG4oMTUpLAogICAgICAgIGkgPSBuKDE2KSwKICAgICAgICBhID0gbig1Mik7CiAgICB0ID0gZS5leHBvcnRzID0gciwgdC5maWx0ZXJYU1MgPSByLCB0LkZpbHRlclhTUyA9IGE7CgogICAgZm9yICh2YXIgcyBpbiBvKSB7CiAgICAgIHRbc10gPSBvW3NdOwogICAgfQoKICAgIGZvciAodmFyIHMgaW4gaSkgewogICAgICB0W3NdID0gaVtzXTsKICAgIH0KCiAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ICYmICh3aW5kb3cuZmlsdGVyWFNTID0gZS5leHBvcnRzKSwgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYgJiYgInVuZGVmaW5lZCIgIT0gdHlwZW9mIERlZGljYXRlZFdvcmtlckdsb2JhbFNjb3BlICYmIHNlbGYgaW5zdGFuY2VvZiBEZWRpY2F0ZWRXb3JrZXJHbG9iYWxTY29wZTsKICAgIH0oKSAmJiAoc2VsZi5maWx0ZXJYU1MgPSBlLmV4cG9ydHMpOwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gZSB8fCBudWxsID09PSBlOwogICAgfQoKICAgIGZ1bmN0aW9uIG8oZSkgewogICAgICB2YXIgdCA9IHAuc3BhY2VJbmRleChlKTsKICAgICAgaWYgKC0xID09PSB0KSByZXR1cm4gewogICAgICAgIGh0bWw6ICIiLAogICAgICAgIGNsb3Npbmc6ICIvIiA9PT0gZVtlLmxlbmd0aCAtIDJdCiAgICAgIH07CiAgICAgIGUgPSBwLnRyaW0oZS5zbGljZSh0ICsgMSwgLTEpKTsKICAgICAgdmFyIG4gPSAiLyIgPT09IGVbZS5sZW5ndGggLSAxXTsKICAgICAgcmV0dXJuIG4gJiYgKGUgPSBwLnRyaW0oZS5zbGljZSgwLCAtMSkpKSwgewogICAgICAgIGh0bWw6IGUsCiAgICAgICAgY2xvc2luZzogbgogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIGkoZSkgewogICAgICB2YXIgdCA9IHt9OwoKICAgICAgZm9yICh2YXIgbiBpbiBlKSB7CiAgICAgICAgdFtuXSA9IGVbbl07CiAgICAgIH0KCiAgICAgIHJldHVybiB0OwogICAgfQoKICAgIGZ1bmN0aW9uIGEoZSkgewogICAgICBlID0gaShlIHx8IHt9KSwgZS5zdHJpcElnbm9yZVRhZyAmJiAoZS5vbklnbm9yZVRhZywgZS5vbklnbm9yZVRhZyA9IGwub25JZ25vcmVUYWdTdHJpcEFsbCksIGUud2hpdGVMaXN0ID0gZS53aGl0ZUxpc3QgfHwgbC53aGl0ZUxpc3QsIGUub25UYWcgPSBlLm9uVGFnIHx8IGwub25UYWcsIGUub25UYWdBdHRyID0gZS5vblRhZ0F0dHIgfHwgbC5vblRhZ0F0dHIsIGUub25JZ25vcmVUYWcgPSBlLm9uSWdub3JlVGFnIHx8IGwub25JZ25vcmVUYWcsIGUub25JZ25vcmVUYWdBdHRyID0gZS5vbklnbm9yZVRhZ0F0dHIgfHwgbC5vbklnbm9yZVRhZ0F0dHIsIGUuc2FmZUF0dHJWYWx1ZSA9IGUuc2FmZUF0dHJWYWx1ZSB8fCBsLnNhZmVBdHRyVmFsdWUsIGUuZXNjYXBlSHRtbCA9IGUuZXNjYXBlSHRtbCB8fCBsLmVzY2FwZUh0bWwsIHRoaXMub3B0aW9ucyA9IGUsICExID09PSBlLmNzcyA/IHRoaXMuY3NzRmlsdGVyID0gITEgOiAoZS5jc3MgPSBlLmNzcyB8fCB7fSwgdGhpcy5jc3NGaWx0ZXIgPSBuZXcgcyhlLmNzcykpOwogICAgfQoKICAgIHZhciBzID0gbigzKS5GaWx0ZXJDU1MsCiAgICAgICAgbCA9IG4oMTUpLAogICAgICAgIGMgPSBuKDE2KSwKICAgICAgICB1ID0gYy5wYXJzZVRhZywKICAgICAgICBkID0gYy5wYXJzZUF0dHIsCiAgICAgICAgcCA9IG4oNSk7CiAgICBhLnByb3RvdHlwZS5wcm9jZXNzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgaWYgKGUgPSBlIHx8ICIiLCAhKGUgPSBlLnRvU3RyaW5nKCkpKSByZXR1cm4gIiI7CiAgICAgIHZhciB0ID0gdGhpcywKICAgICAgICAgIG4gPSB0Lm9wdGlvbnMsCiAgICAgICAgICBpID0gbi53aGl0ZUxpc3QsCiAgICAgICAgICBhID0gbi5vblRhZywKICAgICAgICAgIHMgPSBuLm9uSWdub3JlVGFnLAogICAgICAgICAgYyA9IG4ub25UYWdBdHRyLAogICAgICAgICAgZiA9IG4ub25JZ25vcmVUYWdBdHRyLAogICAgICAgICAgaCA9IG4uc2FmZUF0dHJWYWx1ZSwKICAgICAgICAgIHYgPSBuLmVzY2FwZUh0bWwsCiAgICAgICAgICBnID0gdC5jc3NGaWx0ZXI7CiAgICAgIG4uc3RyaXBCbGFua0NoYXIgJiYgKGUgPSBsLnN0cmlwQmxhbmtDaGFyKGUpKSwgbi5hbGxvd0NvbW1lbnRUYWcgfHwgKGUgPSBsLnN0cmlwQ29tbWVudFRhZyhlKSk7CiAgICAgIHZhciBtID0gITE7CgogICAgICBpZiAobi5zdHJpcElnbm9yZVRhZ0JvZHkpIHsKICAgICAgICB2YXIgbSA9IGwuU3RyaXBUYWdCb2R5KG4uc3RyaXBJZ25vcmVUYWdCb2R5LCBzKTsKICAgICAgICBzID0gbS5vbklnbm9yZVRhZzsKICAgICAgfQoKICAgICAgdmFyIHkgPSB1KGUsIGZ1bmN0aW9uIChlLCB0LCBuLCBsLCB1KSB7CiAgICAgICAgdmFyIG0gPSB7CiAgICAgICAgICBzb3VyY2VQb3NpdGlvbjogZSwKICAgICAgICAgIHBvc2l0aW9uOiB0LAogICAgICAgICAgaXNDbG9zaW5nOiB1LAogICAgICAgICAgaXNXaGl0ZTogaS5oYXNPd25Qcm9wZXJ0eShuKQogICAgICAgIH0sCiAgICAgICAgICAgIHkgPSBhKG4sIGwsIG0pOwogICAgICAgIGlmICghcih5KSkgcmV0dXJuIHk7CgogICAgICAgIGlmIChtLmlzV2hpdGUpIHsKICAgICAgICAgIGlmIChtLmlzQ2xvc2luZykgcmV0dXJuICI8LyIgKyBuICsgIj4iOwogICAgICAgICAgdmFyIGIgPSBvKGwpLAogICAgICAgICAgICAgIHcgPSBpW25dLAogICAgICAgICAgICAgIHggPSBkKGIuaHRtbCwgZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgICAgICAgdmFyIG8gPSAtMSAhPT0gcC5pbmRleE9mKHcsIGUpLAogICAgICAgICAgICAgICAgaSA9IGMobiwgZSwgdCwgbyk7CiAgICAgICAgICAgIGlmICghcihpKSkgcmV0dXJuIGk7CiAgICAgICAgICAgIGlmIChvKSByZXR1cm4gdCA9IGgobiwgZSwgdCwgZyksIHQgPyBlICsgJz0iJyArIHQgKyAnIicgOiBlOwogICAgICAgICAgICB2YXIgaSA9IGYobiwgZSwgdCwgbyk7CiAgICAgICAgICAgIHJldHVybiByKGkpID8gdm9pZCAwIDogaTsKICAgICAgICAgIH0pLAogICAgICAgICAgICAgIGwgPSAiPCIgKyBuOwogICAgICAgICAgcmV0dXJuIHggJiYgKGwgKz0gIiAiICsgeCksIGIuY2xvc2luZyAmJiAobCArPSAiIC8iKSwgbCArPSAiPiI7CiAgICAgICAgfQoKICAgICAgICB2YXIgeSA9IHMobiwgbCwgbSk7CiAgICAgICAgcmV0dXJuIHIoeSkgPyB2KGwpIDogeTsKICAgICAgfSwgdik7CiAgICAgIHJldHVybiBtICYmICh5ID0gbS5yZW1vdmUoeSkpLCB5OwogICAgfSwgZS5leHBvcnRzID0gYTsKICB9LCBmdW5jdGlvbiAoZSwgdCkgewogICAgZS5leHBvcnRzID0gewogICAgICBzbWlsZTogImUzLzIwMThuZXdfd2VpeGlvYTAyX29yZy5wbmciLAogICAgICBsb3ZlbHk6ICIwOS8yMDE4bmV3X2tlYWlfb3JnLnBuZyIsCiAgICAgIGhhcHB5OiAiMWUvMjAxOG5ld190YWlrYWl4aW5fb3JnLnBuZyIsCiAgICAgIGNsYXA6ICI2ZS8yMDE4bmV3X2d1emhhbmdfdGh1bWIucG5nIiwKICAgICAgd2hlZTogIjMzLzIwMThuZXdfeGl4aV90aHVtYi5wbmciLAogICAgICBoYWhhOiAiOGYvMjAxOG5ld19oYWhhX3RodW1iLnBuZyIsCiAgICAgICJsYXVnaCBhbmQgY3J5IjogIjRhLzIwMThuZXdfeGlhb2t1X3RodW1iLnBuZyIsCiAgICAgIHdpbms6ICI0My8yMDE4bmV3X2ppeWFuX29yZy5wbmciLAogICAgICBncmVkZHk6ICJmYS8yMDE4bmV3X2NoYW56dWlfb3JnLnBuZyIsCiAgICAgIGF3a3dhcmQ6ICJhMy8yMDE4bmV3X2hlaXhpYW5fdGh1bWIucG5nIiwKICAgICAgc3dlYXQ6ICIyOC8yMDE4bmV3X2hhbl9vcmcucG5nIiwKICAgICAgInBpY2sgbm9zZSI6ICI5YS8yMDE4bmV3X3dhYmlfdGh1bWIucG5nIiwKICAgICAgaHVtOiAiN2MvMjAxOG5ld19oZW5nX3RodW1iLnBuZyIsCiAgICAgIGFuZ3J5OiAiZjYvMjAxOG5ld19udV90aHVtYi5wbmciLAogICAgICBncmlldmFuY2U6ICJhNS8yMDE4bmV3X3dlaXF1X3RodW1iLnBuZyIsCiAgICAgIHBvb3I6ICI5Ni8yMDE4bmV3X2tlbGlhbl9vcmcucG5nIiwKICAgICAgZGlzYXBwb2ludDogImFhLzIwMThuZXdfc2hpd2FuZ190aHVtYi5wbmciLAogICAgICBzYWQ6ICJlZS8yMDE4bmV3X2JlaXNoYW5nX29yZy5wbmciLAogICAgICB0ZWFyOiAiNmUvMjAxOG5ld19sZWltdV9vcmcucG5nIiwKICAgICAgIm5vIHdheSI6ICI4My8yMDE4bmV3X2t1eGlhb19vcmcucG5nIiwKICAgICAgc2h5OiAiYzEvMjAxOG5ld19oYWl4aXVfb3JnLnBuZyIsCiAgICAgIGRpcnQ6ICIxMC8yMDE4bmV3X3d1X3RodW1iLnBuZyIsCiAgICAgICJsb3ZlIHlvdSI6ICJmNi8yMDE4bmV3X2Fpbmlfb3JnLnBuZyIsCiAgICAgIGtpc3M6ICIyYy8yMDE4bmV3X3FpbnFpbl90aHVtYi5wbmciLAogICAgICBhbW9yb3VzbmVzczogIjlkLzIwMThuZXdfaHVheGluX29yZy5wbmciLAogICAgICBsb25naW5nOiAiYzkvMjAxOG5ld19jaG9uZ2ppbmdfb3JnLnBuZyIsCiAgICAgIGRlc2lyZTogIjNlLzIwMThuZXdfdGlhbnBpbmdfdGh1bWIucG5nIiwKICAgICAgImJhZCBsYXVnaCI6ICI0ZC8yMDE4bmV3X2h1YWl4aWFvX29yZy5wbmciLAogICAgICBibGFja25lc3M6ICI5ZS8yMDE4bmV3X3lpbnhpYW5fb3JnLnBuZyIsCiAgICAgICJsYXVnaCB3aXRob3V0IHdvcmQiOiAiMmQvMjAxOG5ld194aWFvZXJidXl1X29yZy5wbmciLAogICAgICB0aXR0ZXI6ICI3MS8yMDE4bmV3X3RvdXhpYW9fb3JnLnBuZyIsCiAgICAgIGNvb2w6ICJjNC8yMDE4bmV3X2t1X29yZy5wbmciLAogICAgICAibm90IGVhc3kiOiAiYWEvMjAxOG5ld19iaW5nYnVqaWFuZGFuX3RodW1iLnBuZyIsCiAgICAgIHRoaW5rOiAiMzAvMjAxOG5ld19zaWthb19vcmcucG5nIiwKICAgICAgcXVlc3Rpb246ICJiOC8yMDE4bmV3X25pbmd3ZW5fb3JnLnBuZyIsCiAgICAgICJubyBpZGVhIjogIjJhLzIwMThuZXdfd2VuaGFvX3RodW1iLnBuZyIsCiAgICAgIGRpenp5OiAiMDcvMjAxOG5ld195dW5fdGh1bWIucG5nIiwKICAgICAgYm9tYjogImEyLzIwMThuZXdfc2h1YWlfdGh1bWIucG5nIiwKICAgICAgYm9uZTogImExLzIwMThuZXdfa3Vsb3VfdGh1bWIucG5nIiwKICAgICAgImJlIHF1aWV0IjogImIwLzIwMThuZXdfeHVfb3JnLnBuZyIsCiAgICAgICJzaHV0IHVwIjogIjYyLzIwMThuZXdfYml6dWlfb3JnLnBuZyIsCiAgICAgIHN0dXBpZDogImRkLzIwMThuZXdfc2hheWFuX29yZy5wbmciLAogICAgICAic3VycHJpc2UgIjogIjQ5LzIwMThuZXdfY2hpamluZ19vcmcucG5nIiwKICAgICAgdm9taXQ6ICIwOC8yMDE4bmV3X3R1X29yZy5wbmciLAogICAgICBjb2xkOiAiNDAvMjAxOG5ld19rb3V6aGFvX3RodW1iLnBuZyIsCiAgICAgIHNpY2s6ICIzYi8yMDE4bmV3X3NoZW5nYmluZ190aHVtYi5wbmciLAogICAgICBieWU6ICJmZC8yMDE4bmV3X2JhaWJhaV90aHVtYi5wbmciLAogICAgICAibG9vayBkb3duIG9uIjogImRhLzIwMThuZXdfYmlzaGlfb3JnLnBuZyIsCiAgICAgICJ3aGl0ZSBleWUiOiAiZWYvMjAxOG5ld19sYW5kZWxpbmlfb3JnLnBuZyIsCiAgICAgICJsZWZ0IGh1bSI6ICI0My8yMDE4bmV3X3p1b2hlbmdoZW5nX3RodW1iLnBuZyIsCiAgICAgICJyaWdodCBodW0iOiAiYzEvMjAxOG5ld195b3VoZW5naGVuZ190aHVtYi5wbmciLAogICAgICBjcmF6eTogIjE3LzIwMThuZXdfemh1YWt1YW5nX29yZy5wbmciLAogICAgICAic2NvbGQgIjogIjg3LzIwMThuZXdfemhvdW1hX3RodW1iLnBuZyIsCiAgICAgICJoaXQgb24gZmFjZSI6ICJjYi8yMDE4bmV3X2RhbGlhbl9vcmcucG5nIiwKICAgICAgd293OiAiYWUvMjAxOG5ld19kaW5nX29yZy5wbmciLAogICAgICBmYW46ICI4Ni8yMDE4bmV3X2h1ZmVuMDJfb3JnLnBuZyIsCiAgICAgIG1vbmV5OiAiYTIvMjAxOG5ld19xaWFuX3RodW1iLnBuZyIsCiAgICAgIHlhd246ICI1NS8yMDE4bmV3X2RhaGFxaWFuX29yZy5wbmciLAogICAgICBzbGVlcHk6ICIzYy8yMDE4bmV3X2t1bl90aHVtYi5wbmciLAogICAgICBzbGVlcDogImUyLzIwMThuZXdfc2h1aWppYW9fdGh1bWIucG5nIiwKICAgICAgIndhdGVybWVsb24gIjogIjAxLzIwMThuZXdfY2hpZ3VhX3RodW1iLnBuZyIsCiAgICAgIGRvZ2U6ICJhMS8yMDE4bmV3X2RvZ2UwMl9vcmcucG5nIiwKICAgICAgZG9nOiAiMjIvMjAxOG5ld19lcmhhX29yZy5wbmciLAogICAgICBjYXQ6ICI3Yi8yMDE4bmV3X21pYW9taWFvX3RodW1iLnBuZyIsCiAgICAgIHRodW1iOiAiZTYvMjAxOG5ld196YW5fb3JnLnBuZyIsCiAgICAgIGdvb2Q6ICI4YS8yMDE4bmV3X2dvb2Rfb3JnLnBuZyIsCiAgICAgIG9rOiAiNDUvMjAxOG5ld19va19vcmcucG5nIiwKICAgICAgeWVhaDogIjI5LzIwMThuZXdfeWVfdGh1bWIucG5nIiwKICAgICAgInNoYWNrIGhhbmQiOiAiZTkvMjAxOG5ld193b3Nob3VfdGh1bWIucG5nIiwKICAgICAgYm93OiAiZTcvMjAxOG5ld196dW95aV9vcmcucG5nIiwKICAgICAgY29tZTogIjQyLzIwMThuZXdfZ3VvbGFpX3RodW1iLnBuZyIsCiAgICAgIHB1bmNoOiAiODYvMjAxOG5ld19xdWFudG91X3RodW1iLnBuZyIKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGUuZXhwb3J0cyA9IHsKICAgICAgbmljazogIk5pY2tOYW1lIiwKICAgICAgbWFpbDogIkUtTWFpbCIsCiAgICAgIGxpbms6ICJXZWJzaXRlKGh0dHA6Ly8pIiwKICAgICAgbmlja0ZhaWw6ICJOaWNrTmFtZSBjYW5ub3QgYmUgbGVzcyB0aGFuIDMgYnl0ZXMuIiwKICAgICAgbWFpbEZhaWw6ICJQbGVhc2UgY29uZmlybSB5b3VyIGVtYWlsIGFkZHJlc3MuIiwKICAgICAgc29mYTogIk5vIGNvbW1lbnQgeWV0LiIsCiAgICAgIHN1Ym1pdDogIlN1Ym1pdCIsCiAgICAgIHJlcGx5OiAiUmVwbHkiLAogICAgICBjYW5jZWxSZXBseTogIkNhbmNlbCByZXBseSIsCiAgICAgIGNvbW1lbnRzOiAiQ29tbWVudHMiLAogICAgICBjYW5jZWw6ICJDYW5jZWwiLAogICAgICBjb25maXJtOiAiQ29uZmlybSIsCiAgICAgICJjb250aW51ZSI6ICJDb250aW51ZSIsCiAgICAgIG1vcmU6ICJMb2FkIE1vcmUuLi4iLAogICAgICBwcmV2aWV3OiAiUHJldmlldyIsCiAgICAgIGVtb2ppOiAiRW1vamkiLAogICAgICBleHBhbmQ6ICJTZWUgbW9yZS4uLi4iLAogICAgICBzZWNvbmRzOiAic2Vjb25kcyBhZ28iLAogICAgICBtaW51dGVzOiAibWludXRlcyBhZ28iLAogICAgICBob3VyczogImhvdXJzIGFnbyIsCiAgICAgIGRheXM6ICJkYXlzIGFnbyIsCiAgICAgIG5vdzogImp1c3Qgbm93IiwKICAgICAgdXBsb2FkaW5nOiAiVXBsb2FkaW5nIC4uLiIsCiAgICAgIHVwbG9hZERvbmU6ICJVcGxvYWQgY29tcGxldGVkISIsCiAgICAgIGJ1c3k6ICJTdWJtaXQgaXMgYnVzeSwgcGxlYXNlIHdhaXQuLi4iLAogICAgICAiY29kZS05OCI6ICJWYWxpbmUgaW5pdGlhbGl6YXRpb24gZmFpbGVkLCBwbGVhc2UgY2hlY2sgeW91ciB2ZXJzaW9uIG9mIGF2LW1pbi5qcy4iLAogICAgICAiY29kZS05OSI6ICJWYWxpbmUgaW5pdGlhbGl6YXRpb24gZmFpbGVkLCBQbGVhc2UgY2hlY2sgdGhlIGBlbGAgZWxlbWVudCBpbiB0aGUgaW5pdCBtZXRob2QuIiwKICAgICAgImNvZGUtMTAwIjogIlZhbGluZSBpbml0aWFsaXphdGlvbiBmYWlsZWQsIFBsZWFzZSBjaGVjayB5b3VyIGFwcElkIGFuZCBhcHBLZXkuIiwKICAgICAgImNvZGUtMTQwIjogIlRoZSB0b3RhbCBudW1iZXIgb2YgQVBJIGNhbGxzIHRvZGF5IGhhcyBleGNlZWRlZCB0aGUgZGV2ZWxvcG1lbnQgdmVyc2lvbiBsaW1pdC4iLAogICAgICAiY29kZS00MDEiOiAiVW5hdXRob3JpemVkIG9wZXJhdGlvbiwgUGxlYXNlIGNoZWNrIHlvdXIgYXBwSWQgYW5kIGFwcEtleS4iLAogICAgICAiY29kZS00MDMiOiAiQWNjZXNzIGRlbmllZCBieSBBUEkgZG9tYWluIHdoaXRlIGxpc3QsIFBsZWFzZSBjaGVjayB5b3VyIHNlY3VyaXR5IGRvbWFpbi4iCiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBlLmV4cG9ydHMgPSB7CiAgICAgIG5pY2s6ICLjg4vjg4Pjgq/jg43jg7zjg6AiLAogICAgICBtYWlsOiAi44Oh44O844Or44Ki44OJ44Os44K5IiwKICAgICAgbGluazogIuOCteOCpOODiChodHRwOi8vKSIsCiAgICAgIG5pY2tGYWlsOiAiM+ODkOOCpOODiOS7peS4iuOBruODi+ODg+OCr+ODjeODvOODoOOCkuOBlOWFpeWKm+OBj+OBoOOBleOBhC4iLAogICAgICBtYWlsRmFpbDogIuODoeODvOODq+OCouODieODrOOCueOCkuOBlOeiuuiqjeOBj+OBoOOBleOBhC4iLAogICAgICBzb2ZhOiAi44Kz44Oh44Oz44OI44GX44G+44GX44KH44GGfiIsCiAgICAgIHN1Ym1pdDogIuaPkOWHuuOBmeOCiyIsCiAgICAgIHJlcGx5OiAi6L+U5L+h44GZ44KLIiwKICAgICAgY2FuY2VsUmVwbHk6ICLjgq3jg6Pjg7Pjgrvjg6siLAogICAgICBjb21tZW50czogIuOCs+ODoeODs+ODiCIsCiAgICAgIGNhbmNlbDogIuOCreODo+ODs+OCu+ODqyIsCiAgICAgIGNvbmZpcm06ICLnorroqo3jgZnjgosiLAogICAgICAiY29udGludWUiOiAi57un57utIiwKICAgICAgbW9yZTogIuOBleOCieOBq+iqreOBv+i+vOOCgC4uLiIsCiAgICAgIHByZXZpZXc6ICLjg5fjg6zjg5Pjg6Xjg7wiLAogICAgICBlbW9qaTogIue1teaWh+WtlyIsCiAgICAgIGV4cGFuZDogIuOCguOBo+OBqOimi+OCiyIsCiAgICAgIHNlY29uZHM6ICLnp5LliY0iLAogICAgICBtaW51dGVzOiAi5YiG5YmNIiwKICAgICAgaG91cnM6ICLmmYLplpPliY0iLAogICAgICBkYXlzOiAi5pel5YmNIiwKICAgICAgbm93OiAi44Gf44Gj44Gg5LuKIiwKICAgICAgdXBsb2FkaW5nOiAi44Ki44OD44OX44Ot44O844OJ5LitLi4uIiwKICAgICAgdXBsb2FkRG9uZTogIuOCouODg+ODl+ODreODvOODieOBjOWujOS6huOBl+OBvuOBl+OBnyEiLAogICAgICBidXN5OiAiMjAg56eS6ZaT6ZqU44Gn5o+Q5Ye644GX44Gm44GP44Gg44GV44GEICAgIC4uLiIsCiAgICAgICJjb2RlLTk4IjogIuODreODvOODieOCqOODqeODvOOBp+OBmeOAgmF2LW1pbi5qcyDjga7jg5Djg7zjgrjjg6fjg7PjgpLnorroqo3jgZfjgabjgY/jgaDjgZXjgYQuIiwKICAgICAgImNvZGUtOTkiOiAi44Ot44O844OJ44Ko44Op44O844Gn44GZ44CCaW5pdOOBq+OBguOCi2BlbGDjgqjjg6zjg6Hjg7Pjg4jjgpLnorroqo3jgY/jgaDjgZXjgYQuIiwKICAgICAgImNvZGUtMTAwIjogIuODreODvOODieOCqOODqeODvOOBp+OBmeOAgkFwcElk44GoQXBwS2V544KS56K66KqN44GP44Gg44GV44GELiIsCiAgICAgICJjb2RlLTE0MCI6ICLku4rml6Xjga5BUEnjgrPjg7zjg6vjga7nt4/mlbDjgYzplovnmbrjg5Djg7zjgrjjg6fjg7Pjga7kuIrpmZDjgpLotoXjgYjjgZ8uIiwKICAgICAgImNvZGUtNDAxIjogIuaoqemZkOOBjOWItumZkOOBleOCjOOBpuOBhOOBvuOBmeOAgkFwcElk44GoQXBwS2V544KS56K66KqN44GP44Gg44GV44GELiIsCiAgICAgICJjb2RlLTQwMyI6ICLjgqLjgq/jgrvjgrnjgYxBUEnjgarjganjgavliLbpmZDjgZXjgozjgb7jgZfjgZ/jgIHjg4njg6HjgqTjg7PlkI3jga7jgrvjgq3jg6Xjg6rjg4bjgqPoqK3lrprjgpLnorroqo3jgY/jgaDjgZXjgYQiCiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBlLmV4cG9ydHMgPSB7CiAgICAgIG5pY2s6ICLmmLXnp7AiLAogICAgICBtYWlsOiAi6YKu566xIiwKICAgICAgbGluazogIue9keWdgChodHRwOi8vKSIsCiAgICAgIG5pY2tGYWlsOiAi5pi156ew5LiN6IO95bCR5LqOM+S4quWtl+espiIsCiAgICAgIG1haWxGYWlsOiAi6K+35aGr5YaZ5q2j56Gu55qE6YKu5Lu25Zyw5Z2AIiwKICAgICAgc29mYTogIuadpeWPkeivhOiuuuWQp34iLAogICAgICBzdWJtaXQ6ICLmj5DkuqQiLAogICAgICByZXBseTogIuWbnuWkjSIsCiAgICAgIGNhbmNlbFJlcGx5OiAi5Y+W5raI5Zue5aSNIiwKICAgICAgY29tbWVudHM6ICLor4TorroiLAogICAgICBjYW5jZWw6ICLlj5bmtogiLAogICAgICBjb25maXJtOiAi56Gu6K6kIiwKICAgICAgImNvbnRpbnVlIjogIue7p+e7rSIsCiAgICAgIG1vcmU6ICLliqDovb3mm7TlpJouLi4iLAogICAgICBwcmV2aWV3OiAi6aKE6KeIIiwKICAgICAgZW1vamk6ICLooajmg4UiLAogICAgICBleHBhbmQ6ICLmn6XnnIvmm7TlpJouLi4iLAogICAgICBzZWNvbmRzOiAi56eS5YmNIiwKICAgICAgbWludXRlczogIuWIhumSn+WJjSIsCiAgICAgIGhvdXJzOiAi5bCP5pe25YmNIiwKICAgICAgZGF5czogIuWkqeWJjSIsCiAgICAgIG5vdzogIuWImuWImiIsCiAgICAgIHVwbG9hZGluZzogIuato+WcqOS8oOi+ky4uLiIsCiAgICAgIHVwbG9hZERvbmU6ICLkvKDovpPlrozmiJAhIiwKICAgICAgYnVzeTogIuaTjeS9nOmikee5ge+8jOivt+eojeWAmeWGjeivlS4uLiIsCiAgICAgICJjb2RlLTk4IjogIlZhbGluZSDliJ3lp4vljJblpLHotKXvvIzor7fmo4Dmn6UgYXYtbWluLmpzIOeJiOacrCIsCiAgICAgICJjb2RlLTk5IjogIlZhbGluZSDliJ3lp4vljJblpLHotKXvvIzor7fmo4Dmn6Vpbml05Lit55qEYGVsYOWFg+e0oC4iLAogICAgICAiY29kZS0xMDAiOiAiVmFsaW5lIOWIneWni+WMluWksei0pe+8jOivt+ajgOafpeS9oOeahEFwcElk5ZKMQXBwS2V5LiIsCiAgICAgICJjb2RlLTE0MCI6ICLku4rml6UgQVBJIOiwg+eUqOaAu+asoeaVsOW3sui2hei/h+W8gOWPkeeJiOmZkOWIti4iLAogICAgICAiY29kZS00MDEiOiAi5pyq57uP5o6I5p2D55qE5pON5L2c77yM6K+35qOA5p+l5L2g55qEQXBwSWTlkoxBcHBLZXkuIiwKICAgICAgImNvZGUtNDAzIjogIuiuv+mXruiiq0FQSeWfn+WQjeeZveWQjeWNleaLkue7ne+8jOivt+ajgOafpeS9oOeahOWuieWFqOWfn+WQjeiuvue9ri4iCiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBlLmV4cG9ydHMgPSB7CiAgICAgIG5pY2s6ICLmmrHnqLEiLAogICAgICBtYWlsOiAi6YO1566xIiwKICAgICAgbGluazogIue2suWdgChodHRwOi8vKSIsCiAgICAgIG5pY2tGYWlsOiAi5pi156ix5LiN6IO95bCR5pa8M+WAi+Wtl+espiIsCiAgICAgIG1haWxGYWlsOiAi6KuL5aGr5a+r5q2j56K655qE6YO15Lu25Zyw5Z2AIiwKICAgICAgc29mYTogIuS+hueZvOipleirluWQp34iLAogICAgICBzdWJtaXQ6ICLmj5DkuqQiLAogICAgICByZXBseTogIuWbnuimhiIsCiAgICAgIGNhbmNlbFJlcGx5OiAi5Y+W5raI5Zue6KaGIiwKICAgICAgY29tbWVudHM6ICLoqZXoq5YiLAogICAgICBjYW5jZWw6ICLlj5bmtogiLAogICAgICBjb25maXJtOiAi56K66KqNIiwKICAgICAgImNvbnRpbnVlIjogIue5vOe6jCIsCiAgICAgIG1vcmU6ICLliqDovInmm7TlpJouLi4iLAogICAgICBwcmV2aWV3OiAi6aCQ6Ka9IiwKICAgICAgZW1vamk6ICLooajmg4UiLAogICAgICBleHBhbmQ6ICLmn6XnnIvmm7TlpJouLi4iLAogICAgICBzZWNvbmRzOiAi56eS5YmNIiwKICAgICAgbWludXRlczogIuWIhumQmOWJjSIsCiAgICAgIGhvdXJzOiAi5bCP5pmC5YmNIiwKICAgICAgZGF5czogIuWkqeWJjSIsCiAgICAgIG5vdzogIuWJm+WJmyIsCiAgICAgIHVwbG9hZGluZzogIuato+WcqOS4iuWCsy4uLiIsCiAgICAgIHVwbG9hZERvbmU6ICLkuIrlgrPlrozmiJAhIiwKICAgICAgYnVzeTogIuaTjeS9nOmgu+e5ge+8jOiri+eojeWAmeWGjeippi4uLiIsCiAgICAgICJjb2RlLTk4IjogIlZhbGluZSDliJ3lp4vljJblpLHmlZfvvIzoq4vmqqLmn6UgYXYtbWluLmpzIOeJiOacrCIsCiAgICAgICJjb2RlLTk5IjogIlZhbGluZSDliJ3lp4vljJblpLHmlZfvvIzoq4vmqqLmn6Vpbml05Lit55qEYGVsYOWFg+e0oC4iLAogICAgICAiY29kZS0xMDAiOiAiVmFsaW5lIOWIneWni+WMluWkseaVl++8jOiri+aqouafpeS9oOeahEFwcElk5ZKMQXBwS2V5LiIsCiAgICAgICJjb2RlLTE0MCI6ICLku4rml6UgQVBJIOiqv+eUqOe4veasoeaVuOW3sui2hemBjumWi+eZvOeJiOmZkOWIti4iLAogICAgICAiY29kZS00MDEiOiAi5pyq57aT5o6I5qyK55qE5pON5L2c77yM6KuL5qqi5p+l5L2g55qEQXBwSWTlkoxBcHBLZXkuIiwKICAgICAgImNvZGUtNDAzIjogIuioquWVj+iiq0FQSeWfn+WQjeeZveWQjeWWruaLkue1le+8jOiri+aqouafpeS9oOeahOWuieWFqOWfn+WQjeioree9ri4iCiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICB2YXIgciA9IG4oNTkpOwogICAgInN0cmluZyIgPT0gdHlwZW9mIHIgJiYgKHIgPSBbW2UuaSwgciwgIiJdXSk7CiAgICB2YXIgbyA9IHt9OwogICAgby50cmFuc2Zvcm0gPSB2b2lkIDA7CiAgICBuKDYxKShyLCBvKTsKICAgIHIubG9jYWxzICYmIChlLmV4cG9ydHMgPSByLmxvY2Fscyk7CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIHQgPSBlLmV4cG9ydHMgPSBuKDYwKSghMSksIHQucHVzaChbZS5pLCAnLnZbZGF0YS1jbGFzcz12XXtmb250LXNpemU6MTZweDt0ZXh0LWFsaWduOmxlZnR9LnZbZGF0YS1jbGFzcz12XSAqey13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94O2JveC1zaXppbmc6Ym9yZGVyLWJveDtsaW5lLWhlaWdodDoxLjc1fS52W2RhdGEtY2xhc3M9dl0gLnN0YXR1cy1iYXIsLnZbZGF0YS1jbGFzcz12XSAudmVkaXRvciwudltkYXRhLWNsYXNzPXZdIC52aW5wdXQsLnZbZGF0YS1jbGFzcz12XSBwLC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGV7Y29sb3I6IzU1NX0udltkYXRhLWNsYXNzPXZdIC52c3lzLC52W2RhdGEtY2xhc3M9dl0gLnZ0aW1le2NvbG9yOiNiM2IzYjN9LnZbZGF0YS1jbGFzcz12XSAudGV4dC1yaWdodHt0ZXh0LWFsaWduOnJpZ2h0fS52W2RhdGEtY2xhc3M9dl0gLnRleHQtY2VudGVye3RleHQtYWxpZ246Y2VudGVyfS52W2RhdGEtY2xhc3M9dl0gaW1ne21heC13aWR0aDoxMDAlO2JvcmRlcjpub25lfS52W2RhdGEtY2xhc3M9dl0gaHJ7bWFyZ2luOi44MjVlbSAwO2JvcmRlci1jb2xvcjojZjZmNmY2O2JvcmRlci1zdHlsZTpkYXNoZWR9LnZbZGF0YS1jbGFzcz12XS5oaWRlLWF2YXRhciAudmltZ3tkaXNwbGF5Om5vbmV9LnZbZGF0YS1jbGFzcz12XSBhe3Bvc2l0aW9uOnJlbGF0aXZlO2N1cnNvcjpwb2ludGVyO2NvbG9yOiMxYWJjOWM7dGV4dC1kZWNvcmF0aW9uOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2t9LnZbZGF0YS1jbGFzcz12XSBhOmhvdmVye2NvbG9yOiNkNzE5MWF9LnZbZGF0YS1jbGFzcz12XSBjb2RlLC52W2RhdGEtY2xhc3M9dl0gcHJle2JhY2tncm91bmQtY29sb3I6I2Y4ZjhmODtwYWRkaW5nOi4yZW0gLjRlbTtib3JkZXItcmFkaXVzOjNweDtmb250LXNpemU6ODUlO21hcmdpbjowfS52W2RhdGEtY2xhc3M9dl0gcHJle3BhZGRpbmc6MTBweDtvdmVyZmxvdzphdXRvO2xpbmUtaGVpZ2h0OjEuNDV9LnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZXtwYWRkaW5nOjA7YmFja2dyb3VuZDp0cmFuc3BhcmVudDt3aGl0ZS1zcGFjZTpwcmUtd3JhcDt3b3JkLWJyZWFrOmtlZXAtYWxsfS52W2RhdGEtY2xhc3M9dl0gYmxvY2txdW90ZXtjb2xvcjojNjY2O21hcmdpbjouNWVtIDA7cGFkZGluZzowIDAgMCAxZW07Ym9yZGVyLWxlZnQ6OHB4IHNvbGlkIGhzbGEoMCwwJSw5MyUsLjUpfS52W2RhdGEtY2xhc3M9dl0gLnZpbnB1dHtib3JkZXI6bm9uZTtyZXNpemU6bm9uZTtvdXRsaW5lOm5vbmU7cGFkZGluZzoxMHB4IDVweDttYXgtd2lkdGg6MTAwJTtmb250LXNpemU6Ljc3NWVtfS52W2RhdGEtY2xhc3M9dl0gaW5wdXRbdHlwZT1jaGVja2JveF0sLnZbZGF0YS1jbGFzcz12XSBpbnB1dFt0eXBlPXJhZGlvXXtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7bWFyZ2luLXRvcDotMnB4fS52W2RhdGEtY2xhc3M9dl0gLnZpY29ue2N1cnNvcjpwb2ludGVyO2Rpc3BsYXk6aW5saW5lLWJsb2NrO292ZXJmbG93OmhpZGRlbjtmaWxsOiM1NTU7dmVydGljYWwtYWxpZ246bWlkZGxlfS52W2RhdGEtY2xhc3M9dl0gLnZpY29uKy52aWNvbnttYXJnaW4tbGVmdDoxMHB4fS52W2RhdGEtY2xhc3M9dl0gLnZpY29uLmFjdGl2ZWR7ZmlsbDojNjZiMWZmfS52W2RhdGEtY2xhc3M9dl0gLnZyb3d7Zm9udC1zaXplOjA7cGFkZGluZzoxMHB4IDB9LnZbZGF0YS1jbGFzcz12XSAudnJvdyAudmNvbHtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7Zm9udC1zaXplOjE0cHh9LnZbZGF0YS1jbGFzcz12XSAudnJvdyAudmNvbC52Y29sLTIwe3dpZHRoOjIwJX0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29sLnZjb2wtMzB7d2lkdGg6MzAlfS52W2RhdGEtY2xhc3M9dl0gLnZyb3cgLnZjb2wudmNvbC00MHt3aWR0aDo0MCV9LnZbZGF0YS1jbGFzcz12XSAudnJvdyAudmNvbC52Y29sLTUwe3dpZHRoOjUwJX0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29sLnZjb2wtNjB7d2lkdGg6NjAlfS52W2RhdGEtY2xhc3M9dl0gLnZyb3cgLnZjb2wudmNvbC03MHt3aWR0aDo3MCV9LnZbZGF0YS1jbGFzcz12XSAudnJvdyAudmNvbC52Y29sLTgwe3dpZHRoOjgwJX0udltkYXRhLWNsYXNzPXZdIC52cm93IC52Y29sLnZjdHJse2ZvbnQtc2l6ZToxMnB4fS52W2RhdGEtY2xhc3M9dl0gLmVtb2ppLC52W2RhdGEtY2xhc3M9dl0gLnZlbW9qaXttYXgtd2lkdGg6MjVweDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7bWFyZ2luOjAgMXB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwe2JvcmRlcjoxcHggc29saWQgI2YwZjBmMDtib3JkZXItcmFkaXVzOjRweDttYXJnaW4tYm90dG9tOjEwcHg7b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmc6MTBweH0udltkYXRhLWNsYXNzPXZdIC52d3JhcCBpbnB1dHtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50fS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52ZWRpdHtwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nLXRvcDoxMHB4fS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC5jYW5jZWwtcmVwbHktYnRue3Bvc2l0aW9uOmFic29sdXRlO3JpZ2h0OjVweDt0b3A6NXB4O2N1cnNvcjpwb2ludGVyfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52ZW1vamlze2Rpc3BsYXk6bm9uZTtmb250LXNpemU6MThweDttYXgtaGVpZ2h0OjE0NXB4O292ZXJmbG93OmF1dG87cGFkZGluZy1ib3R0b206MTBweDstd2Via2l0LWJveC1zaGFkb3c6MCAwIDFweCAjZjBmMGYwO2JveC1zaGFkb3c6MCAwIDFweCAjZjBmMGYwfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52ZW1vamlzIGl7Zm9udC1zdHlsZTpub3JtYWw7cGFkZGluZy10b3A6N3B4O3dpZHRoOjM2cHg7Y3Vyc29yOnBvaW50ZXI7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTppbmxpbmUtYmxvY2s7dmVydGljYWwtYWxpZ246bWlkZGxlfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52cHJldmlld3twYWRkaW5nOjdweDstd2Via2l0LWJveC1zaGFkb3c6MCAwIDFweCAjZjBmMGYwO2JveC1zaGFkb3c6MCAwIDFweCAjZjBmMGYwfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52aGVhZGVyIC52aW5wdXR7d2lkdGg6MzMuMzMlO2JvcmRlci1ib3R0b206MXB4IGRhc2hlZCAjZGVkZWRlfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52aGVhZGVyLml0ZW0yIC52aW5wdXR7d2lkdGg6NTAlfS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52aGVhZGVyLml0ZW0xIC52aW5wdXR7d2lkdGg6MTAwJX0udltkYXRhLWNsYXNzPXZdIC52d3JhcCAudmhlYWRlciAudmlucHV0OmZvY3Vze2JvcmRlci1ib3R0b20tY29sb3I6I2ViNTA1NX1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjUyMHB4KXsudltkYXRhLWNsYXNzPXZdIC52d3JhcCAudmhlYWRlci5pdGVtMiAudmlucHV0LC52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwIC52aGVhZGVyIC52aW5wdXR7d2lkdGg6MTAwJX19LnZbZGF0YS1jbGFzcz12XSAudnBvd2Vye2NvbG9yOiM5OTk7Zm9udC1zaXplOi43NWVtO3BhZGRpbmc6LjVlbSAwfS52W2RhdGEtY2xhc3M9dl0gLnZwb3dlciBhe2ZvbnQtc2l6ZTouNzVlbX0udltkYXRhLWNsYXNzPXZdIC52Y291bnR7cGFkZGluZzo1cHg7Zm9udC13ZWlnaHQ6NjAwO2ZvbnQtc2l6ZToxLjI1ZW19LnZbZGF0YS1jbGFzcz12XSBvbCwudltkYXRhLWNsYXNzPXZdIHVse3BhZGRpbmc6MDttYXJnaW4tbGVmdDoxLjI1ZW19LnZbZGF0YS1jbGFzcz12XSAudHh0LWNlbnRlcnt0ZXh0LWFsaWduOmNlbnRlcn0udltkYXRhLWNsYXNzPXZdIC50eHQtcmlnaHR7dGV4dC1hbGlnbjpyaWdodH0udltkYXRhLWNsYXNzPXZdIC5wZDV7cGFkZGluZzo1cHh9LnZbZGF0YS1jbGFzcz12XSAucGQxMHtwYWRkaW5nOjEwcHh9LnZbZGF0YS1jbGFzcz12XSAudmVkaXRvcnt3aWR0aDoxMDAlO21pbi1oZWlnaHQ6OC43NWVtO2ZvbnQtc2l6ZTouODc1ZW07YmFja2dyb3VuZDp0cmFuc3BhcmVudDtyZXNpemU6dmVydGljYWw7LXdlYmtpdC10cmFuc2l0aW9uOmFsbCAuMjVzIGVhc2U7dHJhbnNpdGlvbjphbGwgLjI1cyBlYXNlfS52W2RhdGEtY2xhc3M9dl0gLnZidG57LXdlYmtpdC10cmFuc2l0aW9uLWR1cmF0aW9uOi40czt0cmFuc2l0aW9uLWR1cmF0aW9uOi40czt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjojNTU1O2JvcmRlcjoxcHggc29saWQgI2VkZWRlZDtib3JkZXItcmFkaXVzOi4zZW07ZGlzcGxheTppbmxpbmUtYmxvY2s7YmFja2dyb3VuZDp0cmFuc3BhcmVudDttYXJnaW4tYm90dG9tOjA7Zm9udC13ZWlnaHQ6NDAwO3ZlcnRpY2FsLWFsaWduOm1pZGRsZTstbXMtdG91Y2gtYWN0aW9uOm1hbmlwdWxhdGlvbjt0b3VjaC1hY3Rpb246bWFuaXB1bGF0aW9uO2N1cnNvcjpwb2ludGVyO3doaXRlLXNwYWNlOm5vd3JhcDtwYWRkaW5nOi41ZW0gMS4yNWVtO2ZvbnQtc2l6ZTouODc1ZW07bGluZS1oZWlnaHQ6MS40Mjg1NzE0Mzstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7b3V0bGluZTpub25lfS52W2RhdGEtY2xhc3M9dl0gLnZidG4rLnZidG57bWFyZ2luLWxlZnQ6MS4yNWVtfS52W2RhdGEtY2xhc3M9dl0gLnZidG46YWN0aXZlLC52W2RhdGEtY2xhc3M9dl0gLnZidG46aG92ZXJ7Y29sb3I6IzMwOTBlNDtib3JkZXItY29sb3I6IzMwOTBlNH0udltkYXRhLWNsYXNzPXZdIC52YnRuOmRpc2FibGVke2JvcmRlci1jb2xvcjojZTFlMWUxO2NvbG9yOiNlMWUxZTE7YmFja2dyb3VuZC1jb2xvcjojZmRmYWZhO2N1cnNvcjpub3QtYWxsb3dlZH0udltkYXRhLWNsYXNzPXZdIC52ZW1wdHl7cGFkZGluZzoxLjI1ZW07dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6IzU1NTtvdmVyZmxvdzphdXRvfS52W2RhdGEtY2xhc3M9dl0gLnZzeXN7ZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzouMmVtIC41ZW07Zm9udC1zaXplOi43NWVtO2JvcmRlci1yYWRpdXM6LjJlbTttYXJnaW4tcmlnaHQ6LjNlbX1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjUyMHB4KXsudltkYXRhLWNsYXNzPXZdIC52c3lze2Rpc3BsYXk6bm9uZX19LnZbZGF0YS1jbGFzcz12XSAudmNhcmRze3dpZHRoOjEwMCV9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZHtwYWRkaW5nLXRvcDoxLjI1ZW07cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpibG9ja30udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkOmFmdGVye2NvbnRlbnQ6IiI7Y2xlYXI6Ym90aDtkaXNwbGF5OmJsb2NrfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZpbWd7d2lkdGg6My4xMjVlbTtoZWlnaHQ6My4xMjVlbTtmbG9hdDpsZWZ0O2JvcmRlci1yYWRpdXM6NTAlO21hcmdpbi1yaWdodDouNzUyNWVtO2JvcmRlcjoxcHggc29saWQgI2Y1ZjVmNTtwYWRkaW5nOi4xMjVlbX1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjcyMHB4KXsudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aW1ne3dpZHRoOjIuNWVtO2hlaWdodDoyLjVlbX19LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmhlYWR7bGluZS1oZWlnaHQ6MS41O21hcmdpbi10b3A6MH0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aGVhZCAudm5pY2t7cG9zaXRpb246cmVsYXRpdmU7Zm9udC1zaXplOi44NzVlbTtmb250LXdlaWdodDo1MDA7bWFyZ2luLXJpZ2h0Oi44NzVlbTtjdXJzb3I6cG9pbnRlcjt0ZXh0LWRlY29yYXRpb246bm9uZTtkaXNwbGF5OmlubGluZS1ibG9ja30udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aGVhZCAudm5pY2s6aG92ZXJ7Y29sb3I6I2Q3MTkxYX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aHtvdmVyZmxvdzpoaWRkZW47cGFkZGluZy1ib3R0b206LjVlbTtib3JkZXItYm90dG9tOjFweCBkYXNoZWQgI2Y1ZjVmNX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52aCAudnRpbWV7Zm9udC1zaXplOi43NWVtO21hcmdpbi1yaWdodDouODc1ZW19LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmggLnZtZXRhe2xpbmUtaGVpZ2h0OjE7cG9zaXRpb246cmVsYXRpdmV9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmggLnZtZXRhIC52YXR7Zm9udC1zaXplOi44MTI1ZW07Y29sb3I6I2VmMmYxMTtjdXJzb3I6cG9pbnRlcjtmbG9hdDpyaWdodH0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkOmxhc3QtY2hpbGQgLnZoe2JvcmRlci1ib3R0b206bm9uZX0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudHt3b3JkLXdyYXA6YnJlYWstd29yZDt3b3JkLWJyZWFrOmJyZWFrLWFsbDtmb250LXNpemU6Ljg3NWVtO2xpbmUtaGVpZ2h0OjI7cG9zaXRpb246cmVsYXRpdmU7bWFyZ2luLWJvdHRvbTouNzVlbTtwYWRkaW5nLXRvcDouNjI1ZW19LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5ke2N1cnNvcjpwb2ludGVyO21heC1oZWlnaHQ6OGVtO292ZXJmbG93OmhpZGRlbn0udltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YmVmb3Jle2Rpc3BsYXk6YmxvY2s7Y29udGVudDoiIjtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2xlZnQ6MDt0b3A6MDtib3R0b206My4xNWVtO2JhY2tncm91bmQ6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sZnJvbShoc2xhKDAsMCUsMTAwJSwwKSksdG8oaHNsYSgwLDAlLDEwMCUsLjkpKSk7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLGhzbGEoMCwwJSwxMDAlLDApLGhzbGEoMCwwJSwxMDAlLC45KSk7ei1pbmRleDo5OTl9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmFmdGVye2Rpc3BsYXk6YmxvY2s7Y29udGVudDphdHRyKGRhdGEtZXhwYW5kKTt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjojODI4NTg2O3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7aGVpZ2h0OjMuMTVlbTtsaW5lLWhlaWdodDozLjE1ZW07bGVmdDowO2JvdHRvbTowO3otaW5kZXg6OTk5O2JhY2tncm91bmQ6aHNsYSgwLDAlLDEwMCUsLjkpfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZxdW90ZXtwYWRkaW5nLWxlZnQ6MWVtO2JvcmRlci1sZWZ0OjFweCBkYXNoZWQgaHNsYSgwLDAlLDkzJSwuNSl9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudnF1b3RlIC52aW1ne3dpZHRoOjIuMjI1ZW07aGVpZ2h0OjIuMjI1ZW19LnZbZGF0YS1jbGFzcz12XSAudnBhZ2UgLnZtb3Jle21hcmdpbjoxZW0gMH0udltkYXRhLWNsYXNzPXZdIC5jbGVhcntjb250ZW50OiIiO2Rpc3BsYXk6YmxvY2s7Y2xlYXI6Ym90aH1ALXdlYmtpdC1rZXlmcmFtZXMgc3BpbnswJXstd2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMGRlZyk7dHJhbnNmb3JtOnJvdGF0ZSgwZGVnKX10b3std2Via2l0LXRyYW5zZm9ybTpyb3RhdGUoMXR1cm4pO3RyYW5zZm9ybTpyb3RhdGUoMXR1cm4pfX1Aa2V5ZnJhbWVzIHNwaW57MCV7LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDBkZWcpO3RyYW5zZm9ybTpyb3RhdGUoMGRlZyl9dG97LXdlYmtpdC10cmFuc2Zvcm06cm90YXRlKDF0dXJuKTt0cmFuc2Zvcm06cm90YXRlKDF0dXJuKX19QC13ZWJraXQta2V5ZnJhbWVzIHB1bHNlezUwJXtiYWNrZ3JvdW5kOiNkY2RjZGN9fUBrZXlmcmFtZXMgcHVsc2V7NTAle2JhY2tncm91bmQ6I2RjZGNkY319LnZbZGF0YS1jbGFzcz12XSAudnNwaW5uZXJ7d2lkdGg6MjJweDtoZWlnaHQ6MjJweDtkaXNwbGF5OmlubGluZS1ibG9jaztib3JkZXI6NnB4IGRvdWJsZSAjYTBhMGEwO2JvcmRlci10b3AtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLWJvdHRvbS1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjUwJTstd2Via2l0LWFuaW1hdGlvbjpzcGluIDFzIGluZmluaXRlIGxpbmVhcjthbmltYXRpb246c3BpbiAxcyBpbmZpbml0ZSBsaW5lYXI7cG9zaXRpb246cmVsYXRpdmU7dmVydGljYWwtYWxpZ246bWlkZGxlO21hcmdpbjowIDVweH0uZGFyayAudltkYXRhLWNsYXNzPXZdIC5zdGF0dXMtYmFyLC5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZlZGl0b3IsLmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudmlucHV0LC5kYXJrIC52W2RhdGEtY2xhc3M9dl0gcCwuZGFyayAudltkYXRhLWNsYXNzPXZdIHByZSBjb2RlLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC5zdGF0dXMtYmFyLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC52ZWRpdG9yLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC52aW5wdXQsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gcCwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZSwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAuc3RhdHVzLWJhciwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAudmVkaXRvciwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAudmlucHV0LC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIHAsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGUsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAuc3RhdHVzLWJhcixbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52ZWRpdG9yLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZpbnB1dCxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIHAsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSBwcmUgY29kZXtjb2xvcjojYjJiMmI1fS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZzeXMsLmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudnRpbWUsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZzeXMsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZ0aW1lLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52c3lzLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52dGltZSxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52c3lzLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZ0aW1le2NvbG9yOiM5MjkyOTh9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSBjb2RlLC5kYXJrIC52W2RhdGEtY2xhc3M9dl0gcHJlLC5kYXJrIC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGUsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gY29kZSwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSBwcmUsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGUsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gY29kZSwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSBwcmUsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGUsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSBjb2RlLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gcHJlLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gcHJlIGNvZGV7Y29sb3I6IzkyOTI5ODtiYWNrZ3JvdW5kLWNvbG9yOiMxNTE0MTR9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudndyYXAsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52d3JhcCxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52d3JhcHtib3JkZXItY29sb3I6I2IyYjJiNX0uZGFyayAudltkYXRhLWNsYXNzPXZdIC52aWNvbiwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudmljb24sLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZpY29uLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZpY29ue2ZpbGw6I2IyYjJiNX0uZGFyayAudltkYXRhLWNsYXNzPXZdIC52aWNvbi5hY3RpdmVkLC5uaWdodCAudltkYXRhLWNsYXNzPXZdIC52aWNvbi5hY3RpdmVkLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52aWNvbi5hY3RpdmVkLFtkYXRhLXRoZW1lPWRhcmtdIC52W2RhdGEtY2xhc3M9dl0gLnZpY29uLmFjdGl2ZWR7ZmlsbDojNjZiMWZmfS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZidG4sLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZidG4sLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZidG4sW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudmJ0bntjb2xvcjojYjJiMmI1O2JvcmRlci1jb2xvcjojYjJiMmI1fS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZidG46aG92ZXIsLm5pZ2h0IC52W2RhdGEtY2xhc3M9dl0gLnZidG46aG92ZXIsLnRoZW1lX19kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZidG46aG92ZXIsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudmJ0bjpob3Zlcntjb2xvcjojNjZiMWZmO2JvcmRlci1jb2xvcjojNjZiMWZmfS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gYTpob3ZlciwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSBhOmhvdmVyLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIGE6aG92ZXIsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSBhOmhvdmVye2NvbG9yOiNkNzE5MWF9LmRhcmsgLnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmJlZm9yZSwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmJlZm9yZSwudGhlbWVfX2RhcmsgLnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmJlZm9yZSxbZGF0YS10aGVtZT1kYXJrXSAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YmVmb3Jle2JhY2tncm91bmQ6LXdlYmtpdC1ncmFkaWVudChsaW5lYXIsbGVmdCB0b3AsbGVmdCBib3R0b20sZnJvbShyZ2JhKDAsMCwwLC4zKSksdG8ocmdiYSgwLDAsMCwuNykpKTtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxODBkZWcscmdiYSgwLDAsMCwuMykscmdiYSgwLDAsMCwuNykpfS5kYXJrIC52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZjb250ZW50LmV4cGFuZDphZnRlciwubmlnaHQgLnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmFmdGVyLC50aGVtZV9fZGFyayAudltkYXRhLWNsYXNzPXZdIC52Y2FyZHMgLnZjYXJkIC52Y29udGVudC5leHBhbmQ6YWZ0ZXIsW2RhdGEtdGhlbWU9ZGFya10gLnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmFmdGVye2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuNyl9QG1lZGlhIChwcmVmZXJzLWNvbG9yLXNjaGVtZTpkYXJrKXsudltkYXRhLWNsYXNzPXZdIC5zdGF0dXMtYmFyLC52W2RhdGEtY2xhc3M9dl0gLnZlZGl0b3IsLnZbZGF0YS1jbGFzcz12XSAudmlucHV0LC52W2RhdGEtY2xhc3M9dl0gcCwudltkYXRhLWNsYXNzPXZdIHByZSBjb2Rle2NvbG9yOiNiMmIyYjV9LnZbZGF0YS1jbGFzcz12XSAudnN5cywudltkYXRhLWNsYXNzPXZdIC52dGltZXtjb2xvcjojOTI5Mjk4fS52W2RhdGEtY2xhc3M9dl0gY29kZSwudltkYXRhLWNsYXNzPXZdIHByZSwudltkYXRhLWNsYXNzPXZdIHByZSBjb2Rle2NvbG9yOiM5MjkyOTg7YmFja2dyb3VuZC1jb2xvcjojMTUxNDE0fS52W2RhdGEtY2xhc3M9dl0gLnZ3cmFwe2JvcmRlci1jb2xvcjojYjJiMmI1fS52W2RhdGEtY2xhc3M9dl0gLnZpY29ue2ZpbGw6I2IyYjJiNX0udltkYXRhLWNsYXNzPXZdIC52aWNvbi5hY3RpdmVke2ZpbGw6IzY2YjFmZn0udltkYXRhLWNsYXNzPXZdIC52YnRue2NvbG9yOiNiMmIyYjU7Ym9yZGVyLWNvbG9yOiNiMmIyYjV9LnZbZGF0YS1jbGFzcz12XSAudmJ0bjpob3Zlcntjb2xvcjojNjZiMWZmO2JvcmRlci1jb2xvcjojNjZiMWZmfS52W2RhdGEtY2xhc3M9dl0gYTpob3Zlcntjb2xvcjojZDcxOTFhfS52W2RhdGEtY2xhc3M9dl0gLnZjYXJkcyAudmNhcmQgLnZjb250ZW50LmV4cGFuZDpiZWZvcmV7YmFja2dyb3VuZDotd2Via2l0LWdyYWRpZW50KGxpbmVhcixsZWZ0IHRvcCxsZWZ0IGJvdHRvbSxmcm9tKHJnYmEoMCwwLDAsLjMpKSx0byhyZ2JhKDAsMCwwLC43KSkpO2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDE4MGRlZyxyZ2JhKDAsMCwwLC4zKSxyZ2JhKDAsMCwwLC43KSl9LnZbZGF0YS1jbGFzcz12XSAudmNhcmRzIC52Y2FyZCAudmNvbnRlbnQuZXhwYW5kOmFmdGVye2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuNyl9fScsICIiXSk7CiAgfSwgZnVuY3Rpb24gKGUsIHQpIHsKICAgIGZ1bmN0aW9uIG4oZSwgdCkgewogICAgICB2YXIgbiA9IGVbMV0gfHwgIiIsCiAgICAgICAgICBvID0gZVszXTsKICAgICAgaWYgKCFvKSByZXR1cm4gbjsKCiAgICAgIGlmICh0ICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIGJ0b2EpIHsKICAgICAgICB2YXIgaSA9IHIobyk7CiAgICAgICAgcmV0dXJuIFtuXS5jb25jYXQoby5zb3VyY2VzLm1hcChmdW5jdGlvbiAoZSkgewogICAgICAgICAgcmV0dXJuICIvKiMgc291cmNlVVJMPSIgKyBvLnNvdXJjZVJvb3QgKyBlICsgIiAqLyI7CiAgICAgICAgfSkpLmNvbmNhdChbaV0pLmpvaW4oIlxuIik7CiAgICAgIH0KCiAgICAgIHJldHVybiBbbl0uam9pbigiXG4iKTsKICAgIH0KCiAgICBmdW5jdGlvbiByKGUpIHsKICAgICAgcmV0dXJuICIvKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsIiArIGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGUpKSkpICsgIiAqLyI7CiAgICB9CgogICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSBbXTsKICAgICAgcmV0dXJuIHQudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICB2YXIgciA9IG4odCwgZSk7CiAgICAgICAgICByZXR1cm4gdFsyXSA/ICJAbWVkaWEgIiArIHRbMl0gKyAieyIgKyByICsgIn0iIDogcjsKICAgICAgICB9KS5qb2luKCIiKTsKICAgICAgfSwgdC5pID0gZnVuY3Rpb24gKGUsIG4pIHsKICAgICAgICAic3RyaW5nIiA9PSB0eXBlb2YgZSAmJiAoZSA9IFtbbnVsbCwgZSwgIiJdXSk7CgogICAgICAgIGZvciAodmFyIHIgPSB7fSwgbyA9IDA7IG8gPCB0aGlzLmxlbmd0aDsgbysrKSB7CiAgICAgICAgICB2YXIgaSA9IHRoaXNbb11bMF07CiAgICAgICAgICAibnVtYmVyIiA9PSB0eXBlb2YgaSAmJiAocltpXSA9ICEwKTsKICAgICAgICB9CgogICAgICAgIGZvciAobyA9IDA7IG8gPCBlLmxlbmd0aDsgbysrKSB7CiAgICAgICAgICB2YXIgYSA9IGVbb107CiAgICAgICAgICAibnVtYmVyIiA9PSB0eXBlb2YgYVswXSAmJiByW2FbMF1dIHx8IChuICYmICFhWzJdID8gYVsyXSA9IG4gOiBuICYmIChhWzJdID0gIigiICsgYVsyXSArICIpIGFuZCAoIiArIG4gKyAiKSIpLCB0LnB1c2goYSkpOwogICAgICAgIH0KICAgICAgfSwgdDsKICAgIH07CiAgfSwgZnVuY3Rpb24gKGUsIHQsIG4pIHsKICAgIGZ1bmN0aW9uIHIoZSwgdCkgewogICAgICBmb3IgKHZhciBuID0gMDsgbiA8IGUubGVuZ3RoOyBuKyspIHsKICAgICAgICB2YXIgciA9IGVbbl0sCiAgICAgICAgICAgIG8gPSBoW3IuaWRdOwoKICAgICAgICBpZiAobykgewogICAgICAgICAgby5yZWZzKys7CgogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvLnBhcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIG8ucGFydHNbaV0oci5wYXJ0c1tpXSk7CiAgICAgICAgICB9CgogICAgICAgICAgZm9yICg7IGkgPCByLnBhcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIG8ucGFydHMucHVzaCh1KHIucGFydHNbaV0sIHQpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yICh2YXIgYSA9IFtdLCBpID0gMDsgaSA8IHIucGFydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYS5wdXNoKHUoci5wYXJ0c1tpXSwgdCkpOwogICAgICAgICAgfQoKICAgICAgICAgIGhbci5pZF0gPSB7CiAgICAgICAgICAgIGlkOiByLmlkLAogICAgICAgICAgICByZWZzOiAxLAogICAgICAgICAgICBwYXJ0czogYQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBvKGUsIHQpIHsKICAgICAgZm9yICh2YXIgbiA9IFtdLCByID0ge30sIG8gPSAwOyBvIDwgZS5sZW5ndGg7IG8rKykgewogICAgICAgIHZhciBpID0gZVtvXSwKICAgICAgICAgICAgYSA9IHQuYmFzZSA/IGlbMF0gKyB0LmJhc2UgOiBpWzBdLAogICAgICAgICAgICBzID0gaVsxXSwKICAgICAgICAgICAgbCA9IGlbMl0sCiAgICAgICAgICAgIGMgPSBpWzNdLAogICAgICAgICAgICB1ID0gewogICAgICAgICAgY3NzOiBzLAogICAgICAgICAgbWVkaWE6IGwsCiAgICAgICAgICBzb3VyY2VNYXA6IGMKICAgICAgICB9OwogICAgICAgIHJbYV0gPyByW2FdLnBhcnRzLnB1c2godSkgOiBuLnB1c2goclthXSA9IHsKICAgICAgICAgIGlkOiBhLAogICAgICAgICAgcGFydHM6IFt1XQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gbjsKICAgIH0KCiAgICBmdW5jdGlvbiBpKGUsIHQpIHsKICAgICAgdmFyIG4gPSBnKGUuaW5zZXJ0SW50byk7CiAgICAgIGlmICghbikgdGhyb3cgbmV3IEVycm9yKCJDb3VsZG4ndCBmaW5kIGEgc3R5bGUgdGFyZ2V0LiBUaGlzIHByb2JhYmx5IG1lYW5zIHRoYXQgdGhlIHZhbHVlIGZvciB0aGUgJ2luc2VydEludG8nIHBhcmFtZXRlciBpcyBpbnZhbGlkLiIpOwogICAgICB2YXIgciA9IGJbYi5sZW5ndGggLSAxXTsKICAgICAgaWYgKCJ0b3AiID09PSBlLmluc2VydEF0KSByID8gci5uZXh0U2libGluZyA/IG4uaW5zZXJ0QmVmb3JlKHQsIHIubmV4dFNpYmxpbmcpIDogbi5hcHBlbmRDaGlsZCh0KSA6IG4uaW5zZXJ0QmVmb3JlKHQsIG4uZmlyc3RDaGlsZCksIGIucHVzaCh0KTtlbHNlIHsKICAgICAgICBpZiAoImJvdHRvbSIgIT09IGUuaW5zZXJ0QXQpIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCB2YWx1ZSBmb3IgcGFyYW1ldGVyICdpbnNlcnRBdCcuIE11c3QgYmUgJ3RvcCcgb3IgJ2JvdHRvbScuIik7CiAgICAgICAgbi5hcHBlbmRDaGlsZCh0KTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGEoZSkgewogICAgICBpZiAobnVsbCA9PT0gZS5wYXJlbnROb2RlKSByZXR1cm4gITE7CiAgICAgIGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlKTsKICAgICAgdmFyIHQgPSBiLmluZGV4T2YoZSk7CiAgICAgIHQgPj0gMCAmJiBiLnNwbGljZSh0LCAxKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzKGUpIHsKICAgICAgdmFyIHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICByZXR1cm4gZS5hdHRycy50eXBlID0gInRleHQvY3NzIiwgYyh0LCBlLmF0dHJzKSwgaShlLCB0KSwgdDsKICAgIH0KCiAgICBmdW5jdGlvbiBsKGUpIHsKICAgICAgdmFyIHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsaW5rIik7CiAgICAgIHJldHVybiBlLmF0dHJzLnR5cGUgPSAidGV4dC9jc3MiLCBlLmF0dHJzLnJlbCA9ICJzdHlsZXNoZWV0IiwgYyh0LCBlLmF0dHJzKSwgaShlLCB0KSwgdDsKICAgIH0KCiAgICBmdW5jdGlvbiBjKGUsIHQpIHsKICAgICAgT2JqZWN0LmtleXModCkuZm9yRWFjaChmdW5jdGlvbiAobikgewogICAgICAgIGUuc2V0QXR0cmlidXRlKG4sIHRbbl0pOwogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiB1KGUsIHQpIHsKICAgICAgdmFyIG4sIHIsIG8sIGk7CgogICAgICBpZiAodC50cmFuc2Zvcm0gJiYgZS5jc3MpIHsKICAgICAgICBpZiAoIShpID0gdC50cmFuc2Zvcm0oZS5jc3MpKSkgcmV0dXJuIGZ1bmN0aW9uICgpIHt9OwogICAgICAgIGUuY3NzID0gaTsKICAgICAgfQoKICAgICAgaWYgKHQuc2luZ2xldG9uKSB7CiAgICAgICAgdmFyIGMgPSB5Kys7CiAgICAgICAgbiA9IG0gfHwgKG0gPSBzKHQpKSwgciA9IGQuYmluZChudWxsLCBuLCBjLCAhMSksIG8gPSBkLmJpbmQobnVsbCwgbiwgYywgITApOwogICAgICB9IGVsc2UgZS5zb3VyY2VNYXAgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgVVJMICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIFVSTC5jcmVhdGVPYmplY3RVUkwgJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiBCbG9iICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIGJ0b2EgPyAobiA9IGwodCksIHIgPSBmLmJpbmQobnVsbCwgbiwgdCksIG8gPSBmdW5jdGlvbiBvKCkgewogICAgICAgIGEobiksIG4uaHJlZiAmJiBVUkwucmV2b2tlT2JqZWN0VVJMKG4uaHJlZik7CiAgICAgIH0pIDogKG4gPSBzKHQpLCByID0gcC5iaW5kKG51bGwsIG4pLCBvID0gZnVuY3Rpb24gbygpIHsKICAgICAgICBhKG4pOwogICAgICB9KTsKCiAgICAgIHJldHVybiByKGUpLCBmdW5jdGlvbiAodCkgewogICAgICAgIGlmICh0KSB7CiAgICAgICAgICBpZiAodC5jc3MgPT09IGUuY3NzICYmIHQubWVkaWEgPT09IGUubWVkaWEgJiYgdC5zb3VyY2VNYXAgPT09IGUuc291cmNlTWFwKSByZXR1cm47CiAgICAgICAgICByKGUgPSB0KTsKICAgICAgICB9IGVsc2UgbygpOwogICAgICB9OwogICAgfQoKICAgIGZ1bmN0aW9uIGQoZSwgdCwgbiwgcikgewogICAgICB2YXIgbyA9IG4gPyAiIiA6IHIuY3NzOwogICAgICBpZiAoZS5zdHlsZVNoZWV0KSBlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHgodCwgbyk7ZWxzZSB7CiAgICAgICAgdmFyIGkgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShvKSwKICAgICAgICAgICAgYSA9IGUuY2hpbGROb2RlczsKICAgICAgICBhW3RdICYmIGUucmVtb3ZlQ2hpbGQoYVt0XSksIGEubGVuZ3RoID8gZS5pbnNlcnRCZWZvcmUoaSwgYVt0XSkgOiBlLmFwcGVuZENoaWxkKGkpOwogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcChlLCB0KSB7CiAgICAgIHZhciBuID0gdC5jc3MsCiAgICAgICAgICByID0gdC5tZWRpYTsKICAgICAgaWYgKHIgJiYgZS5zZXRBdHRyaWJ1dGUoIm1lZGlhIiwgciksIGUuc3R5bGVTaGVldCkgZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBuO2Vsc2UgewogICAgICAgIGZvciAoOyBlLmZpcnN0Q2hpbGQ7KSB7CiAgICAgICAgICBlLnJlbW92ZUNoaWxkKGUuZmlyc3RDaGlsZCk7CiAgICAgICAgfQoKICAgICAgICBlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKG4pKTsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGYoZSwgdCwgbikgewogICAgICB2YXIgciA9IG4uY3NzLAogICAgICAgICAgbyA9IG4uc291cmNlTWFwLAogICAgICAgICAgaSA9IHZvaWQgMCA9PT0gdC5jb252ZXJ0VG9BYnNvbHV0ZVVybHMgJiYgbzsKICAgICAgKHQuY29udmVydFRvQWJzb2x1dGVVcmxzIHx8IGkpICYmIChyID0gdyhyKSksIG8gJiYgKHIgKz0gIlxuLyojIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkobykpKSkgKyAiICovIik7CiAgICAgIHZhciBhID0gbmV3IEJsb2IoW3JdLCB7CiAgICAgICAgdHlwZTogInRleHQvY3NzIgogICAgICB9KSwKICAgICAgICAgIHMgPSBlLmhyZWY7CiAgICAgIGUuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYSksIHMgJiYgVVJMLnJldm9rZU9iamVjdFVSTChzKTsKICAgIH0KCiAgICB2YXIgaCA9IHt9LAogICAgICAgIHYgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdDsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0ICYmICh0ID0gZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSwgdDsKICAgICAgfTsKICAgIH0oZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gd2luZG93ICYmIGRvY3VtZW50ICYmIGRvY3VtZW50LmFsbCAmJiAhd2luZG93LmF0b2I7CiAgICB9KSwKICAgICAgICBnID0gZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHQgPSB7fTsKICAgICAgcmV0dXJuIGZ1bmN0aW9uIChuKSB7CiAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gdFtuXSAmJiAodFtuXSA9IGUuY2FsbCh0aGlzLCBuKSksIHRbbl07CiAgICAgIH07CiAgICB9KGZ1bmN0aW9uIChlKSB7CiAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGUpOwogICAgfSksCiAgICAgICAgbSA9IG51bGwsCiAgICAgICAgeSA9IDAsCiAgICAgICAgYiA9IFtdLAogICAgICAgIHcgPSBuKDYyKTsKCiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICBpZiAoInVuZGVmaW5lZCIgIT0gdHlwZW9mIERFQlVHICYmIERFQlVHICYmICJvYmplY3QiICE9ICh0eXBlb2YgZG9jdW1lbnQgPT09ICJ1bmRlZmluZWQiID8gInVuZGVmaW5lZCIgOiBfdHlwZW9mKGRvY3VtZW50KSkpIHRocm93IG5ldyBFcnJvcigiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50Iik7CiAgICAgIHQgPSB0IHx8IHt9LCB0LmF0dHJzID0gIm9iamVjdCIgPT0gX3R5cGVvZih0LmF0dHJzKSA/IHQuYXR0cnMgOiB7fSwgdC5zaW5nbGV0b24gfHwgKHQuc2luZ2xldG9uID0gdigpKSwgdC5pbnNlcnRJbnRvIHx8ICh0Lmluc2VydEludG8gPSAiaGVhZCIpLCB0Lmluc2VydEF0IHx8ICh0Lmluc2VydEF0ID0gImJvdHRvbSIpOwogICAgICB2YXIgbiA9IG8oZSwgdCk7CiAgICAgIHJldHVybiByKG4sIHQpLCBmdW5jdGlvbiAoZSkgewogICAgICAgIGZvciAodmFyIGkgPSBbXSwgYSA9IDA7IGEgPCBuLmxlbmd0aDsgYSsrKSB7CiAgICAgICAgICB2YXIgcyA9IG5bYV0sCiAgICAgICAgICAgICAgbCA9IGhbcy5pZF07CiAgICAgICAgICBsLnJlZnMtLSwgaS5wdXNoKGwpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGUpIHsKICAgICAgICAgIHIobyhlLCB0KSwgdCk7CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBhID0gMDsgYSA8IGkubGVuZ3RoOyBhKyspIHsKICAgICAgICAgIHZhciBsID0gaVthXTsKCiAgICAgICAgICBpZiAoMCA9PT0gbC5yZWZzKSB7CiAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgbC5wYXJ0cy5sZW5ndGg7IGMrKykgewogICAgICAgICAgICAgIGwucGFydHNbY10oKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGVsZXRlIGhbbC5pZF07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgfTsKCiAgICB2YXIgeCA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGUgPSBbXTsKICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0LCBuKSB7CiAgICAgICAgcmV0dXJuIGVbdF0gPSBuLCBlLmZpbHRlcihCb29sZWFuKS5qb2luKCJcbiIpOwogICAgICB9OwogICAgfSgpOwogIH0sIGZ1bmN0aW9uIChlLCB0KSB7CiAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdCA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93LmxvY2F0aW9uOwogICAgICBpZiAoIXQpIHRocm93IG5ldyBFcnJvcigiZml4VXJscyByZXF1aXJlcyB3aW5kb3cubG9jYXRpb24iKTsKICAgICAgaWYgKCFlIHx8ICJzdHJpbmciICE9IHR5cGVvZiBlKSByZXR1cm4gZTsKICAgICAgdmFyIG4gPSB0LnByb3RvY29sICsgIi8vIiArIHQuaG9zdCwKICAgICAgICAgIHIgPSBuICsgdC5wYXRobmFtZS5yZXBsYWNlKC9cL1teXC9dKiQvLCAiLyIpOwogICAgICByZXR1cm4gZS5yZXBsYWNlKC91cmxccypcKCgoPzpbXikoXXxcKCg/OlteKShdK3xcKFteKShdKlwpKSpcKSkqKVwpL2dpLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgIHZhciBvID0gdC50cmltKCkucmVwbGFjZSgvXiIoLiopIiQvLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgfSkucmVwbGFjZSgvXicoLiopJyQvLCBmdW5jdGlvbiAoZSwgdCkgewogICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKC9eKCN8ZGF0YTp8aHR0cDpcL1wvfGh0dHBzOlwvXC98ZmlsZTpcL1wvXC8pL2kudGVzdChvKSkgcmV0dXJuIGU7CiAgICAgICAgdmFyIGk7CiAgICAgICAgcmV0dXJuIGkgPSAwID09PSBvLmluZGV4T2YoIi8vIikgPyBvIDogMCA9PT0gby5pbmRleE9mKCIvIikgPyBuICsgbyA6IHIgKyBvLnJlcGxhY2UoL15cLlwvLywgIiIpLCAidXJsKCIgKyBKU09OLnN0cmluZ2lmeShpKSArICIpIjsKICAgICAgfSk7CiAgICB9OwogIH0sIGZ1bmN0aW9uIChlLCB0LCBuKSB7CiAgICBuKDU4KSwgZS5leHBvcnRzID0gbigxOCk7CiAgfV0pOwp9KTs="},null]}